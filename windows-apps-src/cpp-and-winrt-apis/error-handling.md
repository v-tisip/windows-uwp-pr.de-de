---
author: stevewhims
description: In diesem Thema werden Strategien zur Behandlung von Fehlern bei der Programmierung mit C++/WinRT erörtert.
title: Fehlerbehandlung bei C++/WinRT
ms.author: stwhi
ms.date: 05/21/2018
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: windows 10, uwp, standard, c++, cpp, winrt, projizierung, fehler, behandlung, ausnahme
ms.localizationpriority: medium
ms.openlocfilehash: 9a4cf60fea70722e66eb44d52542be248e9ad01c
ms.sourcegitcommit: 5c9a47b135c5f587214675e39c1ac058c0380f4c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/04/2018
ms.locfileid: "4358082"
---
# <a name="error-handling-with-cwinrt"></a><span data-ttu-id="6952d-104">Fehlerbehandlung bei C++/WinRT</span><span class="sxs-lookup"><span data-stu-id="6952d-104">Error handling with C++/WinRT</span></span>

<span data-ttu-id="6952d-105">In diesem Thema werden Strategien zur Behandlung von Fehlern bei der Programmierung mit erörtert [C++ / WinRT](/windows/uwp/cpp-and-winrt-apis/intro-to-using-cpp-with-winrt).</span><span class="sxs-lookup"><span data-stu-id="6952d-105">This topic discusses strategies for handling errors when programming with [C++/WinRT](/windows/uwp/cpp-and-winrt-apis/intro-to-using-cpp-with-winrt).</span></span> <span data-ttu-id="6952d-106">Weitere allgemeine Informationen sowie Hintergrundinformationen finden Sie unter [Fehler- und Ausnahmebehandlung (modernes C++)](/cpp/cpp/errors-and-exception-handling-modern-cpp).</span><span class="sxs-lookup"><span data-stu-id="6952d-106">For more general info, and background, see [Errors and Exception Handling (Modern C++)](/cpp/cpp/errors-and-exception-handling-modern-cpp).</span></span>

## <a name="avoid-catching-and-throwing-exceptions"></a><span data-ttu-id="6952d-107">Vermeiden des Abfangens und Auslösens von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="6952d-107">Avoid catching and throwing exceptions</span></span>
<span data-ttu-id="6952d-108">Es wird empfohlen, weiterhin [ausnahmesicheren Code](/cpp/cpp/how-to-design-for-exception-safety) zu schreiben, aber auch nach Möglichkeit zu vermeiden, dass Ausnahmen abgefangen und ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="6952d-108">We recommend that you continue to write [exception-safe code](/cpp/cpp/how-to-design-for-exception-safety), but that you prefer to avoid catching and throwing exceptions whenever possible.</span></span> <span data-ttu-id="6952d-109">Wenn kein Handler für eine Ausnahme vorhanden ist, generiert Windows automatisch einen Fehlerbericht (einschließlich eines Minidumps des Absturzes). Dieser hilft Ihnen dabei, zu ermitteln, wo das Problem liegt.</span><span class="sxs-lookup"><span data-stu-id="6952d-109">If there's no handler for an exception, then Windows automatically generates an error report (including a minidump of the crash), which will help you track down where the problem is.</span></span>

<span data-ttu-id="6952d-110">Lösen Sie keine Ausnahme aus, die erwartungsgemäß abgefangen wird.</span><span class="sxs-lookup"><span data-stu-id="6952d-110">Don't throw an exception that you expect to catch.</span></span> <span data-ttu-id="6952d-111">Und verwenden Sie keine Ausnahmen für erwartete Fehler.</span><span class="sxs-lookup"><span data-stu-id="6952d-111">And don't use exceptions for expected failures.</span></span> <span data-ttu-id="6952d-112">Lösen Sie eine Ausnahme *nur dann aus, wenn ein unerwarteter Laufzeitfehler auftritt*, und behandeln Sie alles andere mit Fehler-/Ergebniscodes– direkt und in der Nähe der Fehlerquelle.</span><span class="sxs-lookup"><span data-stu-id="6952d-112">Throw an exception *only when an unexpected runtime error occurs*, and handle everything else with error/result codes&mdash;directly, and close to the source of the failure.</span></span> <span data-ttu-id="6952d-113">So wissen Sie, wenn eine Ausnahme *ausgelöst wird*, dass die Ursache entweder ein Fehler im Code oder ein außergewöhnlicher Fehlerstatus im System ist.</span><span class="sxs-lookup"><span data-stu-id="6952d-113">That way, when an exception *is* thrown, you know that the cause is either a bug in your code, or an exceptional error state in the system.</span></span>

<span data-ttu-id="6952d-114">Betrachten Sie das Szenario beim Zugreifen auf die Windows-Registrierung.</span><span class="sxs-lookup"><span data-stu-id="6952d-114">Consider the scenario of accessing the Windows Registry.</span></span> <span data-ttu-id="6952d-115">Wenn Ihre App einen Wert aus der Registrierung nicht lesen kann, ist dies zu erwarten und Sie sollten dies ordnungsgemäß handhaben.</span><span class="sxs-lookup"><span data-stu-id="6952d-115">If your app fails to read a value from the Registry, then that's to be expected, and you should handle it gracefully.</span></span> <span data-ttu-id="6952d-116">Lösen Sie keine Ausnahme aus. Geben Sie stattdessen einen `bool`- oder `enum`-Wert zurück, der darauf hinweist, dass der Wert nicht gelesen wurde, und ggf. auch den Grund dafür angibt.</span><span class="sxs-lookup"><span data-stu-id="6952d-116">Don't throw an exception; rather return a `bool` or `enum` value indicating that, and perhaps why, the value wasn't read.</span></span> <span data-ttu-id="6952d-117">Kann ein Wert nicht in die Registrierung *geschrieben* werden, weist dies wahrscheinlich darauf hin, dass ein größeres Problem vorliegt, als Sie sinnvoll in Ihrer Anwendung behandeln könnten.</span><span class="sxs-lookup"><span data-stu-id="6952d-117">Failing to *write* a value to the Registry, on the other hand, is likely to indicate that there's a bigger problem than you can handle sensibly in your application.</span></span> <span data-ttu-id="6952d-118">In solch einem Fall sollte Ihre Anwendung nicht fortgesetzt werden. Folglich ist eine Ausnahme, die zu einem Fehlerbericht führt, die schnellste Möglichkeit zu verhindern, dass Ihre Anwendung Schäden verursacht.</span><span class="sxs-lookup"><span data-stu-id="6952d-118">In a case like that, you don't want your application to continue, so an exception that results in an error report is the fastest way to keep your application from causing any harm.</span></span>

<span data-ttu-id="6952d-119">Stellen Sie sich als weiteres Beispiel vor, dass ein Miniaturbild von einem Aufruf an [**StorageFile.GetThumbnailAsync**](/uwp/api/windows.storage.storagefile.getthumbnailasync#Windows_Storage_StorageFile_GetThumbnailAsync_Windows_Storage_FileProperties_ThumbnailMode_) abgerufen und an [\*\*BitmapSource.SetSourceAsync \*\*](/uwp/api/windows.ui.xaml.media.imaging.bitmapsource.setsourceasync#Windows_UI_Xaml_Media_Imaging_BitmapSource_SetSourceAsync_Windows_Storage_Streams_IRandomAccessStream_) übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="6952d-119">For another example, consider retrieving a thumbnail image from a call to [**StorageFile.GetThumbnailAsync**](/uwp/api/windows.storage.storagefile.getthumbnailasync#Windows_Storage_StorageFile_GetThumbnailAsync_Windows_Storage_FileProperties_ThumbnailMode_), and then passing that thumbnail to [**BitmapSource.SetSourceAsync**](/uwp/api/windows.ui.xaml.media.imaging.bitmapsource.setsourceasync#Windows_UI_Xaml_Media_Imaging_BitmapSource_SetSourceAsync_Windows_Storage_Streams_IRandomAccessStream_).</span></span> <span data-ttu-id="6952d-120">Wenn diese Abfolge von Aufrufen bewirkt, dass `nullptr` an **SetSourceAsync** übergeben wird (die Bilddatei kann nicht gelesen werden; z.B. könnte die Dateierweiterung darauf hinweisen, dass sie Bilddaten enthält, was tatsächlich aber nicht der Fall ist), dann lösen Sie eine Ausnahme für einen ungültigen Zeiger aus.</span><span class="sxs-lookup"><span data-stu-id="6952d-120">If that sequence of calls causes you to pass `nullptr` to **SetSourceAsync** (the image file can't be read; perhaps its file extension makes it look like it contains image data, but it actually doesn't), then you'll cause an invalid pointer exception to be thrown.</span></span> <span data-ttu-id="6952d-121">Wenn Sie einen solchen Fall in Ihrem Code entdecken, sollten Sie, anstatt den Fall als Ausnahme abzufangen und zu handhaben, stattdessen prüfen, ob `nullptr` von \*\*GetThumbnailAsync \*\* zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="6952d-121">If you discover a case like that in your code, rather than catching and handling the case as an exception, instead check for `nullptr` returned from **GetThumbnailAsync**.</span></span>

<span data-ttu-id="6952d-122">Das Auslösen von Ausnahmen ist für gewöhnlich langsamer als die Verwendung von Fehlercodes.</span><span class="sxs-lookup"><span data-stu-id="6952d-122">Throwing exceptions tends to be slower than using error codes.</span></span> <span data-ttu-id="6952d-123">Wenn Sie eine Ausnahme nur bei schwerwiegenden Fehlern auslösen, geht dies, wenn alles gut läuft, nie zu Lasten der Leistung.</span><span class="sxs-lookup"><span data-stu-id="6952d-123">If you only throw an exception when a fatal error occurs, then if all goes well you'll never pay the performance price.</span></span>

<span data-ttu-id="6952d-124">Die Leistung wird eher beeinträchtigt durch den Laufzeit-Overhead, der entsteht, wenn sichergestellt werden muss, dass die richtigen Destruktoren im unwahrscheinlichen Falle aufgerufen werden, dass eine Ausnahme ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="6952d-124">But a more likely performance hit involves the runtime overhead of ensuring that the appropriate destructors are called in the unlikely event that an exception is thrown.</span></span> <span data-ttu-id="6952d-125">Die Leistungseinbußen, die mit dieser Sicherstellung einhergehen, treten unabhängig davon ein, ob tatsächlich eine Ausnahme ausgelöst wird oder nicht.</span><span class="sxs-lookup"><span data-stu-id="6952d-125">The cost of this assurance comes whether an exception is actually thrown or not.</span></span> <span data-ttu-id="6952d-126">Daher sollten Sie dafür sorgen, dass der Compiler weiß, welche Funktionen potenziell Ausnahmen auslösen können.</span><span class="sxs-lookup"><span data-stu-id="6952d-126">So, you should ensure that the compiler has a good idea of what functions can potentially throw exceptions.</span></span> <span data-ttu-id="6952d-127">Wenn der Compiler nachweisen kann, dass keine Ausnahmen von bestimmten Funktionen kommen (`noexcept`-Spezifikation), kann er den Code, den er generiert, optimieren.</span><span class="sxs-lookup"><span data-stu-id="6952d-127">If the compiler can prove that there won't be any exceptions from certain functions (the `noexcept` specification), then it can optimize the code it generates.</span></span>

## <a name="catching-exceptions"></a><span data-ttu-id="6952d-128">Abfangen von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="6952d-128">Catching exceptions</span></span>
<span data-ttu-id="6952d-129">Ein Fehlerzustand, der auf Ebene der [Windows-Runtime-ABI](interop-winrt-abi.md#what-is-the-windows-runtime-abi-and-what-are-abi-types) auftritt, wird in Form eines HRESULT-Werts zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6952d-129">An error condition that arises at the [Windows Runtime ABI](interop-winrt-abi.md#what-is-the-windows-runtime-abi-and-what-are-abi-types) layer is returned in the form of a HRESULT value.</span></span> <span data-ttu-id="6952d-130">Sie müssen HRESULTs jedoch nicht in Ihrem Code behandeln.</span><span class="sxs-lookup"><span data-stu-id="6952d-130">But you don't need to handle HRESULTs in your code.</span></span> <span data-ttu-id="6952d-131">Der C++/WinRT-Projektionscode, der für eine API auf Nutzungsseite generiert wird, erkennt einen HRESULT-Code auf der ABI-Ebene und konvertiert den Code in eine [**winrt::hresult_error**](/uwp/cpp-ref-for-winrt/error-handling/hresult-error)-Ausnahme, die Sie abfangen und behandeln können.</span><span class="sxs-lookup"><span data-stu-id="6952d-131">The C++/WinRT projection code that's generated for an API on the consuming side detects an error HRESULT code at the ABI layer and converts the code into a [**winrt::hresult_error**](/uwp/cpp-ref-for-winrt/error-handling/hresult-error) exception, which you can catch and handle.</span></span>

<span data-ttu-id="6952d-132">Wenn der Benutzer beispielsweise ein Bild aus der Bildbibliothek löscht, während die Anwendung diese Sammlung durchläuft, wird von der Projektion eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="6952d-132">For example, if the user happens to delete an image from the Pictures Library while your application is iterating over that collection, then the projection throws an exception.</span></span> <span data-ttu-id="6952d-133">Dies ist ein Fall, in dem Sie diese Ausnahme abfangen und behandeln müssen.</span><span class="sxs-lookup"><span data-stu-id="6952d-133">And this is a case where you'll have to catch and handle that exception.</span></span> <span data-ttu-id="6952d-134">Dieses Codebeispiel veranschaulicht diesen Fall.</span><span class="sxs-lookup"><span data-stu-id="6952d-134">Here's a code example showing this case.</span></span>

```cppwinrt
using namespace winrt;
using namespace Windows::Foundation;
using namespace Windows::Storage;
using namespace Windows::UI::Xaml::Media::Imaging;

IAsyncAction MakeThumbnailsAsync()
{
    auto imageFiles{ co_await KnownFolders::PicturesLibrary().GetFilesAsync() };

    for (StorageFile const& imageFile : imageFiles)
    {
        BitmapImage bitmapImage;
        try
        {
            auto thumbnail{ co_await imageFile.GetThumbnailAsync(FileProperties::ThumbnailMode::PicturesView) };
            if (thumbnail) bitmapImage.SetSource(thumbnail);
        }
        catch (winrt::hresult_error const& ex)
        {
            HRESULT hr = ex.to_abi(); // HRESULT_FROM_WIN32(ERROR_FILE_NOT_FOUND).
            winrt::hstring message = ex.message(); // The system cannot find the file specified.
        }
    }
}
```

<span data-ttu-id="6952d-135">Verwenden Sie dieses Muster in einer Coroutine beim Aufrufen einer `co_await`-ed-Funktion.</span><span class="sxs-lookup"><span data-stu-id="6952d-135">Use this same pattern in a coroutine when calling a `co_await`-ed function.</span></span> <span data-ttu-id="6952d-136">Ein weiteres Beispiel für diese Konvertierung von HRESULT in eine Ausnahme ist, wenn eine Komponenten-API E_OUTOFMEMORY zurückgibt, wodurch ein **std::bad_alloc** ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="6952d-136">Another example of this HRESULT-to-exception conversion is that when a component API returns E_OUTOFMEMORY, that causes a **std::bad_alloc** to be thrown.</span></span>

## <a name="throwing-exceptions"></a><span data-ttu-id="6952d-137">Auslösen von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="6952d-137">Throwing exceptions</span></span>
<span data-ttu-id="6952d-138">Es gibt Fälle, in denen Sie dies entscheiden, Ihre Anwendung aber nicht wiederhergestellt werden kann, wenn der Aufruf einer bestimmten Funktion fehlschlägt (Sie könnten sich dann nicht mehr darauf verlassen, dass die Anwendung wie erwartet funktioniert).</span><span class="sxs-lookup"><span data-stu-id="6952d-138">There will be cases where you decide that, should your call to a given function fail, your application won't be able to recover (you'll no longer be able to rely on it to function predictably).</span></span> <span data-ttu-id="6952d-139">Im Codebeispiel unten wird ein [**winrt::handle**](/uwp/cpp-ref-for-winrt/handle)-Wert als Wrapper für den HANDLE verwendet, der von [**CreateEvent**](https://msdn.microsoft.com/library/windows/desktop/ms682396) zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="6952d-139">The code example below uses a [**winrt::handle**](/uwp/cpp-ref-for-winrt/handle) value as a wrapper around the HANDLE returned from [**CreateEvent**](https://msdn.microsoft.com/library/windows/desktop/ms682396).</span></span> <span data-ttu-id="6952d-140">Anschließend wird der Handle (es wird daraus ein `bool`-Wert erstellt) an die Funktionsvorlage [**winrt::check_bool**](/uwp/cpp-ref-for-winrt/error-handling/check-bool) übergeben.</span><span class="sxs-lookup"><span data-stu-id="6952d-140">It then passes the handle (creating a `bool` value from it) to the [**winrt::check_bool**](/uwp/cpp-ref-for-winrt/error-handling/check-bool) function template.</span></span> <span data-ttu-id="6952d-141">**winrt::check_bool** funktioniert mit einem `bool`-Wert oder mit einem beliebigen Wert, der in `false` (Fehler) oder `true` (Erfolg) konvertiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="6952d-141">**winrt::check_bool** works with a `bool`, or with any value that's convertible to `false` (an error condition), or `true` (a success condition).</span></span>

```cppwinrt
winrt::handle h{ ::CreateEvent(nullptr, false, false, nullptr) };
winrt::check_bool(bool{ h });
winrt::check_bool(::SetEvent(h.get()));
```

<span data-ttu-id="6952d-142">Wenn der Wert, den Sie an [**winrt::check_bool**](/uwp/cpp-ref-for-winrt/error-handling/check-bool) übergeben, falsch ist, findet die folgende Abfolge von Aktionen statt.</span><span class="sxs-lookup"><span data-stu-id="6952d-142">If the value that you pass to [**winrt::check_bool**](/uwp/cpp-ref-for-winrt/error-handling/check-bool) is false, then the following sequence of actions take place.</span></span>

- <span data-ttu-id="6952d-143">**winrt::check_bool** ruft die Funktion [**winrt::throw_last_error**](/uwp/cpp-ref-for-winrt/error-handling/throw-last-error) auf.</span><span class="sxs-lookup"><span data-stu-id="6952d-143">**winrt::check_bool** calls the [**winrt::throw_last_error**](/uwp/cpp-ref-for-winrt/error-handling/throw-last-error) function.</span></span>
- <span data-ttu-id="6952d-144">**winrt::throw_last_error** ruft [**GetLastError**](https://msdn.microsoft.com/library/windows/desktop/ms679360) auf, um den letzten Fehlercodewert des aufrufenden Threads abzurufen. Danach ruft es die Funktion [**winrt::throw_hresult**](/uwp/cpp-ref-for-winrt/error-handling/throw-hresult) auf.</span><span class="sxs-lookup"><span data-stu-id="6952d-144">**winrt::throw_last_error** calls [**GetLastError**](https://msdn.microsoft.com/library/windows/desktop/ms679360) to retrieve the calling thread's last-error code value, and then then calls the [**winrt::throw_hresult**](/uwp/cpp-ref-for-winrt/error-handling/throw-hresult) function.</span></span>
- <span data-ttu-id="6952d-145">**winrt::throw_hresult** löst eine Ausnahme unter Verwendung eines [**winrt::hresult_error**](/uwp/cpp-ref-for-winrt/error-handling/hresult-error)-Objekts (oder eines Standardobjekts) aus, das diesen Fehlercode darstellt.</span><span class="sxs-lookup"><span data-stu-id="6952d-145">**winrt::throw_hresult** throws an exception using a [**winrt::hresult_error**](/uwp/cpp-ref-for-winrt/error-handling/hresult-error) object (or a standard object) that represents that error code.</span></span>

<span data-ttu-id="6952d-146">Da Windows-APIs Laufzeitfehler mit verschiedenen Rückgabewerttypen melden, stehen zusätzlich zu **winrt::check_bool** einige weitere nützliche Hilfsfunktionen zur Verfügung, um Werte zu überprüfen und Ausnahmen auszulösen.</span><span class="sxs-lookup"><span data-stu-id="6952d-146">Because Windows APIs report run-time errors using various return-value types, there are in addition to **winrt::check_bool** a handful of other useful helper functions for checking values and throwing exceptions.</span></span>

- <span data-ttu-id="6952d-147">[**winrt::check_hresult**](/uwp/cpp-ref-for-winrt/error-handling/check-hresult).</span><span class="sxs-lookup"><span data-stu-id="6952d-147">[**winrt::check_hresult**](/uwp/cpp-ref-for-winrt/error-handling/check-hresult).</span></span> <span data-ttu-id="6952d-148">Überprüft, ob der HRESULT-Code einen Fehler darstellt. Ist dies der Fall, ruft es **winrt::throw_hresult** auf.</span><span class="sxs-lookup"><span data-stu-id="6952d-148">Checks whether the HRESULT code represents an error and, if so, calls **winrt::throw_hresult**.</span></span>
- <span data-ttu-id="6952d-149">[**winrt::check_nt**](/uwp/cpp-ref-for-winrt/error-handling/check-nt).</span><span class="sxs-lookup"><span data-stu-id="6952d-149">[**winrt::check_nt**](/uwp/cpp-ref-for-winrt/error-handling/check-nt).</span></span> <span data-ttu-id="6952d-150">Überprüft, ob ein Code einen Fehler darstellt. Ist dies der Fall, ruft es **winrt::throw_hresult** auf.</span><span class="sxs-lookup"><span data-stu-id="6952d-150">Checks whether a code represents an error and, if so, calls **winrt::throw_hresult**.</span></span>
- <span data-ttu-id="6952d-151">[**winrt::check_pointer**](/uwp/cpp-ref-for-winrt/error-handling/check-pointer).</span><span class="sxs-lookup"><span data-stu-id="6952d-151">[**winrt::check_pointer**](/uwp/cpp-ref-for-winrt/error-handling/check-pointer).</span></span> <span data-ttu-id="6952d-152">Überprüft, ob ein Zeiger null ist. Ist dies der Fall, ruft es **winrt::throw_last_error** auf.</span><span class="sxs-lookup"><span data-stu-id="6952d-152">Checks whether a pointer is null and, if so, calls **winrt::throw_last_error**.</span></span>
- <span data-ttu-id="6952d-153">[**winrt::check_win32**](/uwp/cpp-ref-for-winrt/error-handling/check-win32).</span><span class="sxs-lookup"><span data-stu-id="6952d-153">[**winrt::check_win32**](/uwp/cpp-ref-for-winrt/error-handling/check-win32).</span></span> <span data-ttu-id="6952d-154">Überprüft, ob ein Code einen Fehler darstellt. Ist dies der Fall, ruft es **winrt::throw_hresult** auf.</span><span class="sxs-lookup"><span data-stu-id="6952d-154">Checks whether a code represents an error and, if so, calls **winrt::throw_hresult**.</span></span>

<span data-ttu-id="6952d-155">Sie können diese Hilfsfunktionen für gängige Rückgabecodetypen verwenden oder auf eine Fehlerbedingung reagieren und entweder [**winrt::throw_last_error**](/uwp/cpp-ref-for-winrt/error-handling/throw-last-error) oder [**winrt::throw_hresult**](/uwp/cpp-ref-for-winrt/error-handling/throw-hresult) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="6952d-155">You can use these helper functions for common return code types, or you can respond to any error condition and call either [**winrt::throw_last_error**](/uwp/cpp-ref-for-winrt/error-handling/throw-last-error) or [**winrt::throw_hresult**](/uwp/cpp-ref-for-winrt/error-handling/throw-hresult).</span></span> 

## <a name="throwing-exceptions-when-authoring-an-api"></a><span data-ttu-id="6952d-156">Auslösen von Ausnahmen beim Erstellen einer API</span><span class="sxs-lookup"><span data-stu-id="6952d-156">Throwing exceptions when authoring an API</span></span>
<span data-ttu-id="6952d-157">Da eine Ausnahme nicht die Grenze der [Windows-Runtime-ABI](interop-winrt-abi.md#what-is-the-windows-runtime-abi-and-what-are-abi-types) überschreiten darf, wird ein Fehlerzustand, der in einer Implementierung auftritt, über die ABI-Ebene in Form eines HRESULT-Fehlercodes zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6952d-157">Since it's invalid for an exception to cross the [Windows Runtime ABI](interop-winrt-abi.md#what-is-the-windows-runtime-abi-and-what-are-abi-types) boundary, an error condition that arises in an implementation is returned across the ABI layer in the form of an HRESULT error code.</span></span> <span data-ttu-id="6952d-158">Wenn Sie eine API mit C++/WinRT entwickeln, wird Code für Sie generiert, um jede Ausnahme, die Sie in Ihrer Implementierung *auslösen*, in ein HRESULT zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="6952d-158">When you're authoring an API using C++/WinRT, code is generated for you to convert any exception that you *do* throw in your implementation into an HRESULT.</span></span> <span data-ttu-id="6952d-159">Die Funktion [**winrt::to_hresult**](/uwp/cpp-ref-for-winrt/error-handling/to-hresult) wird in diesem generierten Code als Muster wie dieses verwendet.</span><span class="sxs-lookup"><span data-stu-id="6952d-159">The [**winrt::to_hresult**](/uwp/cpp-ref-for-winrt/error-handling/to-hresult) function is used in that generated code in a pattern like this.</span></span>

```cppwinrt
HRESULT DoWork() noexcept
{
    try
    {
        // Shim through to your C++/WinRT implementation.
        return S_OK;
    }
    catch (...)
    {
        return winrt::to_hresult(); // Convert any exception to an HRESULT.
    }
}
```

<span data-ttu-id="6952d-160">[**winrt::to_hresult**](/uwp/cpp-ref-for-winrt/error-handling/to-hresult) behandelt Ausnahmen, die von **std::exception** und [**winrt::hresult_error**](/uwp/cpp-ref-for-winrt/error-handling/hresult-error) und deren abgeleiteten Typen abgeleitet wurden.</span><span class="sxs-lookup"><span data-stu-id="6952d-160">[**winrt::to_hresult**](/uwp/cpp-ref-for-winrt/error-handling/to-hresult) handles exceptions derived from **std::exception**, and [**winrt::hresult_error**](/uwp/cpp-ref-for-winrt/error-handling/hresult-error) and its derived types.</span></span> <span data-ttu-id="6952d-161">In Ihrer Implementierung sollten Sie **winrt::hresult_error** oder einen abgeleiteten Typ bevorzugen, sodass Nutzer Ihrer API ausführliche Fehlerinformationen erhalten.</span><span class="sxs-lookup"><span data-stu-id="6952d-161">In your implementation, you should prefer **winrt::hresult_error**, or a derived type, so that consumers of your API receive rich error information.</span></span> <span data-ttu-id="6952d-162">**std::exception** (was E_FAIL entspricht) wird unterstützt, wenn Ausnahmen aus der Verwendung der Standardvorlagenbibliothek entstehen.</span><span class="sxs-lookup"><span data-stu-id="6952d-162">**std::exception** (which maps to E_FAIL) is supported in case exceptions arise from your use of the Standard Template Library.</span></span>

## <a name="assertions"></a><span data-ttu-id="6952d-163">Assertionen</span><span class="sxs-lookup"><span data-stu-id="6952d-163">Assertions</span></span>
<span data-ttu-id="6952d-164">Für interne Annahmen in Ihrer Anwendung gibt es Assertionen.</span><span class="sxs-lookup"><span data-stu-id="6952d-164">For internal assumptions in your application, there are assertions.</span></span> <span data-ttu-id="6952d-165">Bevorzugen Sie möglichst **static_assert** für die Überprüfung während der Kompilierung.</span><span class="sxs-lookup"><span data-stu-id="6952d-165">Prefer **static_assert** for compile-time validation, wherever possible.</span></span> <span data-ttu-id="6952d-166">Verwenden Sie für Laufzeitbedingungen WINRT_ASSERT mit einen booleschen Ausdruck.</span><span class="sxs-lookup"><span data-stu-id="6952d-166">For run-time conditions, use WINRT_ASSERT with a Boolean expression.</span></span>

```cppwinrt
WINRT_ASSERT(pos < size());
```

<span data-ttu-id="6952d-167">WINRT_ASSERT wird bei Releasebuilds kompiliert; in einem Debugbuild beendet es die Anwendung im Debugger an der Codezeile, in der sich die Assertion befindet.</span><span class="sxs-lookup"><span data-stu-id="6952d-167">WINRT_ASSERT is compiled away in release builds; in a debug build, it stops the application in the debugger on the line of code where the assertion is.</span></span>

<span data-ttu-id="6952d-168">Sie sollten keine Ausnahmen in Ihren Destruktoren verwenden.</span><span class="sxs-lookup"><span data-stu-id="6952d-168">You shouldn't use exceptions in your destructors.</span></span> <span data-ttu-id="6952d-169">Folglich können Sie zumindest in Debug-Builds das Ergebnis des Aufrufs einer Funktion von einem Destruktor mit WINRT_VERIFY (mit einem booleschen Ausdruck) und WINRT_VERIFY_ (mit dem erwarteten Ergebnis und einem booleschen Ausdruck) bestätigen.</span><span class="sxs-lookup"><span data-stu-id="6952d-169">So, at least in debug builds, you can assert the result of calling a function from a destructor with WINRT_VERIFY (with a Boolean expression) and WINRT_VERIFY_ (with an expected result and a Boolean expression).</span></span>

```cppwinrt
WINRT_VERIFY(::CloseHandle(value));
WINRT_VERIFY_(TRUE, ::CloseHandle(value));
```

## <a name="important-apis"></a><span data-ttu-id="6952d-170">Wichtige APIs</span><span class="sxs-lookup"><span data-stu-id="6952d-170">Important APIs</span></span>
* [<span data-ttu-id="6952d-171">winrt::check_bool-Funktionsvorlage</span><span class="sxs-lookup"><span data-stu-id="6952d-171">winrt::check_bool function template</span></span>](/uwp/cpp-ref-for-winrt/error-handling/check-bool)
* [<span data-ttu-id="6952d-172">winrt::check_hresult-Funktion</span><span class="sxs-lookup"><span data-stu-id="6952d-172">winrt::check_hresult function</span></span>](/uwp/cpp-ref-for-winrt/error-handling/check-hresult)
* [<span data-ttu-id="6952d-173">winrt::check_nt-Funktionsvorlage</span><span class="sxs-lookup"><span data-stu-id="6952d-173">winrt::check_nt function template</span></span>](/uwp/cpp-ref-for-winrt/error-handling/check-nt)
* [<span data-ttu-id="6952d-174">winrt::check_pointer-Funktionsvorlage</span><span class="sxs-lookup"><span data-stu-id="6952d-174">winrt::check_pointer function template</span></span>](/uwp/cpp-ref-for-winrt/error-handling/check-pointer)
* [<span data-ttu-id="6952d-175">winrt::check_win32-Funktionsvorlage</span><span class="sxs-lookup"><span data-stu-id="6952d-175">winrt::check_win32 function template</span></span>](/uwp/cpp-ref-for-winrt/error-handling/check-win32)
* [<span data-ttu-id="6952d-176">winrt::handle-Struktur</span><span class="sxs-lookup"><span data-stu-id="6952d-176">winrt::handle struct</span></span>](/uwp/cpp-ref-for-winrt/handle)
* [<span data-ttu-id="6952d-177">winrt::hresult_error-Struktur</span><span class="sxs-lookup"><span data-stu-id="6952d-177">winrt::hresult_error struct</span></span>](/uwp/cpp-ref-for-winrt/error-handling/hresult-error)
* [<span data-ttu-id="6952d-178">winrt::throw_hresult-Funktion</span><span class="sxs-lookup"><span data-stu-id="6952d-178">winrt::throw_hresult function</span></span>](/uwp/cpp-ref-for-winrt/error-handling/throw-hresult)
* [<span data-ttu-id="6952d-179">winrt::throw_last_error-Funktion</span><span class="sxs-lookup"><span data-stu-id="6952d-179">winrt::throw_last_error function</span></span>](/uwp/cpp-ref-for-winrt/error-handling/throw-last-error)
* [<span data-ttu-id="6952d-180">winrt::to_hresult-Funktion</span><span class="sxs-lookup"><span data-stu-id="6952d-180">winrt::to_hresult function</span></span>](/uwp/cpp-ref-for-winrt/error-handling/to-hresult)

## <a name="related-topics"></a><span data-ttu-id="6952d-181">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="6952d-181">Related topics</span></span>
* [<span data-ttu-id="6952d-182">Fehler- und Ausnahmebehandlung (modernes C++)</span><span class="sxs-lookup"><span data-stu-id="6952d-182">Errors and Exception Handling (Modern C++)</span></span>](/cpp/cpp/errors-and-exception-handling-modern-cpp)
* [<span data-ttu-id="6952d-183">Vorgehensweise: Entwurf für die Ausnahmesicherheit</span><span class="sxs-lookup"><span data-stu-id="6952d-183">How to: Design for Exception Safety</span></span>](/cpp/cpp/how-to-design-for-exception-safety)
