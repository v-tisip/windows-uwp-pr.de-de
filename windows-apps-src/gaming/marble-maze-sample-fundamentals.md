---
author: mtoepke
title: Grundlagen am Beispiel von Marble Maze
description: In diesem Dokument werden die fundamentalen Eigenschaften des Marble Maze-Projekts beschrieben, beispielsweise wie Visual C++ in der Windows Runtime-Umgebung verwendet wird, wie es erstellt und strukturiert wird und wie es aufgebaut ist.
ms.assetid: 73329b29-62e3-1b36-01db-b7744ee5b4c3
ms.author: mtoepke
ms.date: 02/08/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows10, Uwp, Spiele, Beispiel, Directx, Grundlagen
ms.openlocfilehash: e0769690fa3ac49057fb34d36d2b9d6ff6f25e28
ms.sourcegitcommit: ae20971c4c8276034cd22fd7e10b0e3ddfddf480
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 08/11/2017
---
# <a name="marble-maze-sample-fundamentals"></a><span data-ttu-id="d0ebf-104">Grundlagen am Beispiel von Marble Maze</span><span class="sxs-lookup"><span data-stu-id="d0ebf-104">Marble Maze sample fundamentals</span></span>


<span data-ttu-id="d0ebf-105">\[ Aktualisiert für UWP-Apps unter Windows10.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-105">\[ Updated for UWP apps on Windows 10.</span></span> <span data-ttu-id="d0ebf-106">Artikel zu Windows8.x finden Sie im [Archiv](http://go.microsoft.com/fwlink/p/?linkid=619132) \]</span><span class="sxs-lookup"><span data-stu-id="d0ebf-106">For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \]</span></span>


<span data-ttu-id="d0ebf-107">In diesem Thema werden die fundamentalen Eigenschaften des Marble Maze-Projekt&mdash;s beschrieben, beispielsweise wie Visual C++ in der Windows Runtime-Umgebung verwendet wird, wie es erstellt und strukturiert wird und wie es aufgebaut ist.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-107">This topic describes the fundamental characteristics of the Marble Maze project&mdash;for example, how it uses Visual C++ in the Windows Runtime environment, how it is created and structured, and how it is built.</span></span> <span data-ttu-id="d0ebf-108">Das Thema enthält auch eine Beschreibung verschiedener Konventionen, die im Code verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-108">The topic also describes several of the conventions that are used in the code.</span></span>

> <span data-ttu-id="d0ebf-109">**Hinweis**   Den Beispielcode für dieses Dokument finden Sie im [DirectX-Beispielspiel Marble Maze](http://go.microsoft.com/fwlink/?LinkId=624011).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-109">**Note**   The sample code that corresponds to this document is found in the [DirectX Marble Maze game sample](http://go.microsoft.com/fwlink/?LinkId=624011).</span></span>

<span data-ttu-id="d0ebf-110">Es folgen einige wichtige Punkte, die in diesem Dokument erläutert werden und die beim Planen und Entwickeln Ihres UWP-Spiels relevant sind.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-110">Here are some of the key points that this document discusses for when you plan and develop your Universal Windows Platform (UWP) game.</span></span>

-   <span data-ttu-id="d0ebf-111">Verwenden Sie die Visual C++ Vorlage **DirectX 11-App (Universelle Windows-App)** in Visual Studio, um das DirectX-UWP-Spiel zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-111">Use the **DirectX 11 App (Universal Windows)** Visual C++ template in Visual Studio to create your DirectX UWP game.</span></span>
-   <span data-ttu-id="d0ebf-112">Windows-Runtime stellt Klassen und Schnittstellen bereit, sodass Sie UWP-Apps auf moderne, objektorientierte Art und Weise entwickeln können.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-112">The Windows Runtime provides classes and interfaces so that you can develop UWP apps in a more modern, object-oriented manner.</span></span>
-   <span data-ttu-id="d0ebf-113">Verwenden Sie Objektreferenzen mit Hütchensymbol (^), um die Lebensdauer von Windows-Runtime-Variablen zu verwalten, [**Microsoft::WRL::ComPtr**](https://msdn.microsoft.com/library/windows/apps/br244983.aspx) zum Verwalten der Lebensdauer von COM-Objekten und [**std::shared\_ptr**](https://msdn.microsoft.com/library/windows/apps/bb982026.aspx) oder [**std::unique\_ptr**](https://msdn.microsoft.com/library/windows/apps/ee410601.aspx) zum Verwalten der Lebensdauer aller anderen, vom Heap zugewiesenen C++-Objekte.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-113">Use object references with the hat (^) symbol to manage the lifetime of Windows Runtime variables, [**Microsoft::WRL::ComPtr**](https://msdn.microsoft.com/library/windows/apps/br244983.aspx) to manage the lifetime of COM objects, and [**std::shared\_ptr**](https://msdn.microsoft.com/library/windows/apps/bb982026.aspx) or [**std::unique\_ptr**](https://msdn.microsoft.com/library/windows/apps/ee410601.aspx) to manage the lifetime of all other heap-allocated C++ objects.</span></span>
-   <span data-ttu-id="d0ebf-114">In den meisten Fällen verwenden Sie für die Behandlung unerwarteter Fehler die Ausnahmebehandlung anstelle von Ergebniscodes.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-114">In most cases, use exception handling, instead of result codes, to deal with unexpected errors.</span></span>
-   <span data-ttu-id="d0ebf-115">Verwenden Sie SAL-Anmerkungen in Kombination mit Codeanalysetools, um Fehler in der App zu finden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-115">Use SAL annotations together with code analysis tools to help discover errors in your app.</span></span>

## <a name="creating-the-visual-studio-project"></a><span data-ttu-id="d0ebf-116">Erstellen des Visual Studio-Projekts</span><span class="sxs-lookup"><span data-stu-id="d0ebf-116">Creating the Visual Studio project</span></span>


<span data-ttu-id="d0ebf-117">Wenn Sie das Beispiel heruntergeladen und extrahiert haben, können Sie die Projektmappendatei **MarbleMaze.sln** in Visual Studio öffnen, und der gesamte Code liegt offen vor Ihnen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-117">If you've downloaded and extracted the sample, you can open the **MarbleMaze.sln** solution file in Visual Studio, and you'll have the code in front of you.</span></span> <span data-ttu-id="d0ebf-118">Sie können die Quelle auch auf der MSDN Sample Gallery-Seite mit dem [DirectX-Beispielspiel Marble Maze](http://go.microsoft.com/fwlink/?LinkId=624011) anzeigen, indem Sie die Registerkarte **Code durchsuchen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-118">You can also view the source on the [DirectX Marble Maze game sample](http://go.microsoft.com/fwlink/?LinkId=624011) MSDN Samples Gallery page by selecting the **Browse Code** tab.</span></span>

<span data-ttu-id="d0ebf-119">Beim Erstellen des Visual Studio-Projekts für Marble Maze haben wir mit einem bereits vorhandenen Projekt begonnen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-119">When we created the Visual Studio project for Marble Maze, we started with an existing project.</span></span> <span data-ttu-id="d0ebf-120">Wenn Sie jedoch noch kein vorhandenes Projekt haben, das die grundlegende, für Ihr DirectX-UWP-Spiel erforderliche Funktionalität bereitstellt, wird empfohlen, ein Projekt basierend auf der Visual Studio-Vorlage **DirectX 11-App (Universelle Windows-App)** zu erstellen, da sie eine grundlegende, funktionierende 3D-Anwendung enthält.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-120">However, if you do not already have an existing project that provides the basic functionality that your DirectX UWP game requires, we recommend that you create a project based on the Visual Studio **DirectX 11 App (Universal Windows)** template because it provides a basic working 3D application.</span></span>

<span data-ttu-id="d0ebf-121">Eine wichtige Projekteinstellung in der Voralge **DirectX 11-App (Universelle Windows-App)** ist die Option **/ZW**. Diese Option ermöglicht dem Programm die Verwendung der Windows-Runtime-Spracherweiterungen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-121">One important project setting in the **DirectX 11 App (Universal Windows)** template is the **/ZW** option, which enables the program to use the Windows Runtime language extensions.</span></span> <span data-ttu-id="d0ebf-122">Sie ist standardmäßig aktiviert, wenn Sie die Visual Studio-Vorlage verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-122">This option is enabled by default when you use the Visual Studio template.</span></span> <span data-ttu-id="d0ebf-123">Weitere Informationen zur Vorgehensweise beim Festlegen von Compiler-Optionen in Visual Studio finden Sie unter [Compileroptionen festlegen](https://docs.microsoft.com/cpp/build/reference/setting-compiler-options).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-123">See [Setting Compiler Options](https://docs.microsoft.com/cpp/build/reference/setting-compiler-options) for more info about how to set compiler options in Visual Studio.</span></span>

> <span data-ttu-id="d0ebf-124">**Vorsicht**   Die Option **/ZW** ist nicht mit Optionen wie **/clr** kompatibel.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-124">**Caution**   The **/ZW** option is not compatible with options such as **/clr**.</span></span> <span data-ttu-id="d0ebf-125">Im Fall von **/clr** können Sie demnach über ein und dasselbe Visual C++-Projekt nicht das .NET Framework und die Windows-Runtime erreichen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-125">In the case of **/clr**, this means that you cannot target both the .NET Framework and the Windows Runtime from the same Visual C++ project.</span></span>

 

<span data-ttu-id="d0ebf-126">Jede UWP-App, die Sie aus dem Windows Store erwerben, wird in Form eines App-Pakets bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-126">Every UWP app that you acquire from the Windows Store comes in the form of an app package.</span></span> <span data-ttu-id="d0ebf-127">Ein App-Paket enthält ein App-Manifest, das wiederum Informationen zur App beinhaltet.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-127">An app package contains a package manifest, which contains information about your app.</span></span> <span data-ttu-id="d0ebf-128">Sie können beispielsweise die Funktionen (d.h. den erforderlichen Zugriff auf geschützte Systemressourcen oder Benutzerdaten) Ihrer App angeben.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-128">For example, you can specify the capabilities (that is, the required access to protected system resources or user data) of your app.</span></span> <span data-ttu-id="d0ebf-129">Wenn Sie festlegen, dass für Ihre App bestimmte Funktionen erforderlich sind, verwenden Sie das Paketmanifest, um die erforderlichen Funktionen zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-129">If you determine that your app requires certain capabilities, use the package manifest to declare the required capabilities.</span></span> <span data-ttu-id="d0ebf-130">Das Manifest ermöglicht Ihnen auch die Angabe von Projekteigenschaften wie der Rotation unterstützter Geräte, Kachelbildern und Begrüßungsbildschirm.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-130">The manifest also lets you specify project properties such as supported device rotations, tile images, and the splash screen.</span></span> <span data-ttu-id="d0ebf-131">Sie können das Manifest bearbeiten, indem Sie **Package.appxmanifest** in Ihrem Projekt öffnen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-131">You can edit the manifest by opening **Package.appxmanifest** in your project.</span></span> <span data-ttu-id="d0ebf-132">Weitere Informationen zu App-Paketen finden Sie unter [Verpacken von Apps](https://msdn.microsoft.com/library/windows/apps/mt270969).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-132">For more info about app packages, see [Packaging apps](https://msdn.microsoft.com/library/windows/apps/mt270969).</span></span>

##  <a name="building-deploying-and-running-the-game"></a><span data-ttu-id="d0ebf-133">Erstellen, Bereitstellen und Ausführen des Spiels</span><span class="sxs-lookup"><span data-stu-id="d0ebf-133">Building, deploying, and running the game</span></span>


<!--To build the project, on the menu bar, choose **Build > Build Solution**. The build step compiles the code and also packages it for use as a UWP app.

After you build the project, you must deploy it. In the dropdown menus at the top, select your deployment configuration, and then on the menu bar, choose **Build > Deploy Solution**.

After you deploy the project, pick the Marble Maze tile to run the game. Alternatively, from Visual Studio, on the menu bar, choose **Debug, Start Debugging**.-->

<span data-ttu-id="d0ebf-134">Wählen Sie in den Dropdownmenüs oben in Visual Studio links neben der grünen Schaltfläche "Wiedergabe" die Konfiguration Ihrer Bereitstellung aus.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-134">In the dropdown menus at the top of Visual Studio, to the left of the green play button, select your deployment configuration.</span></span> <span data-ttu-id="d0ebf-135">Wir empfehlen die Einstellung als **Debuggen** und die Architektur Ihres Geräts auf (**x86** für 32-Bit, **x64** für 64-Bit) und auf **Lokaler Computer** festzulegen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-135">We recommend setting it as **Debug** targeting your device's architecture (**x86** for 32-bit, **x64** for 64-bit) and to your **Local Machine**.</span></span> <span data-ttu-id="d0ebf-136">Sie können ebenfalls einen **Remotecomputer** oder ein **Gerät** testen, das über USB verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-136">You can also test on a **Remote Machine**, or to a **Device** that's connected via USB.</span></span> <span data-ttu-id="d0ebf-137">Klicken Sie dann auf die grüne Wiedergabeschaltfläche zum Erstellen und Bereitstellen auf Ihrem Gerät.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-137">Then click the green play button to build and deploy to your device.</span></span>

###  <a name="controlling-the-game"></a><span data-ttu-id="d0ebf-138">Steuern des Spiels</span><span class="sxs-lookup"><span data-stu-id="d0ebf-138">Controlling the game</span></span>

<span data-ttu-id="d0ebf-139">Für die Steuerung von Marble Maze können Sie die Fingereingabe, den Beschleunigungsmesser, den Xbox 360-Controller oder die Maus verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-139">You can use touch, the accelerometer, the Xbox 360 controller, or the mouse to control Marble Maze.</span></span>

-   <span data-ttu-id="d0ebf-140">Mithilfe des Steuerkreuzes am Controller können Sie das aktive Menüelement ändern.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-140">Use the directional pad on the controller to change the active menu item.</span></span>
-   <span data-ttu-id="d0ebf-141">Zum Auswählen eines Menüelements können Sie die A-Taste, die Start-Taste oder die Maus verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-141">Use touch, the A button, the Start button, or the mouse to pick a menu item.</span></span>
-   <span data-ttu-id="d0ebf-142">Über die Fingereingabe, den Beschleunigungsmesser, den linken Ministick oder die Maus können Sie das Labyrinth neigen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-142">Use touch, the accelerometer, the left thumbstick, or the mouse to tilt the maze.</span></span>
-   <span data-ttu-id="d0ebf-143">Zum Schließen von Menüs wie der Highscore-Tabelle können Sie die A-Taste, die Start-Taste oder die Maus verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-143">Use touch, the A button, the Start button, or the mouse to close menus such as the high score table.</span></span>
-   <span data-ttu-id="d0ebf-144">Mithilfe der Start-Taste oder der P-Taste können Sie das Spiel pausieren oder fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-144">Use the Start button or the P key to pause or resume the game.</span></span>
-   <span data-ttu-id="d0ebf-145">Zum Neustarten des Spiels können Sie die Zurück-Taste am Controller oder die Pos1-Taste auf der Tastatur verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-145">Use the Back button on the controller or the Home key on the keyboard to restart the game.</span></span>
-   <span data-ttu-id="d0ebf-146">Wenn die Highscore-Tabelle angezeigt wird, können Sie mit der Zurück- oder der Pos1-Taste alle Punktergebnisse löschen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-146">When the high-score table is visible, use the Back button or Home key to clear all scores.</span></span>

##  <a name="code-conventions"></a><span data-ttu-id="d0ebf-147">Codekonventionen</span><span class="sxs-lookup"><span data-stu-id="d0ebf-147">Code conventions</span></span>


<span data-ttu-id="d0ebf-148">Die Windows-Runtime ist eine Programmierschnittstelle, die Sie zum Erstellen von UWP-Apps verwenden können, die nur in einer speziellen Anwendungsumgebung ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-148">The Windows Runtime is a programming interface that you can use to create UWP apps that run only in a special application environment.</span></span> <span data-ttu-id="d0ebf-149">Solche Apps verwenden autorisierte Funktionen, Datentypen und Geräte, und sie werden über den Windows Store verteilt.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-149">Such apps use authorized functions, data types, and devices, and are distributed from the Windows Store.</span></span> <span data-ttu-id="d0ebf-150">Die Windows-Runtime besteht auf der untersten Ebene aus einer binären Anwendungsschnittstelle (Application Binary Interface, ABI).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-150">At the lowest level, the Windows Runtime consists of an Application Binary Interface (ABI).</span></span> <span data-ttu-id="d0ebf-151">Die ABI ist ein binärer Vertrag auf unterer Ebene, der Windows-Runtime-APIs für mehrere Programmiersprachen zur Verfügung stellt, beispielsweise für JavaScript, die .NET-Sprachen und Visual C++.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-151">The ABI is a low-level binary contract that makes Windows Runtime APIs accessible to multiple programming languages such as JavaScript, the .NET languages, and Visual C++.</span></span>

<span data-ttu-id="d0ebf-152">Diese Sprachen erfordern für den Aufruf von Windows-Runtime-APIs aus JavaScript und .NET Projektionen, die für die jeweilige Sprachumgebung spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-152">In order to call Windows Runtime APIs from JavaScript and .NET, those languages require projections that are specific to each language environment.</span></span> <span data-ttu-id="d0ebf-153">Wenn Sie eine Windows-Runtime-API aus JavaScript oder .NET aufrufen, rufen Sie die Projektion auf, die wiederum die zugrunde liegende ABI-Funktion aufruft.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-153">When you call a Windows Runtime API from JavaScript or .NET, you are invoking the projection, which in turn calls the underlying ABI function.</span></span> <span data-ttu-id="d0ebf-154">Sie können zwar die ABI-Funktionen direkt aus Standard-C++ aufrufen, jedoch stellt Microsoft auch Projektionen für C++ bereit, da diese die Verwendung der Windows-Runtime-APIs stark vereinfachen und dennoch eine hohe Leistung aufrecht erhalten.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-154">Although you can call the ABI functions directly in C++, Microsoft provides projections for C++ as well, because they make it much simpler to consume the Windows Runtime APIs, while still maintaining high performance.</span></span> <span data-ttu-id="d0ebf-155">Microsoft stellt außerdem Spracherweiterungen für Visual C++ bereit, die spezielle Unterstützung für die Windows-Runtime-Projektionen bieten.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-155">Microsoft also provides language extensions to Visual C++ that specifically support the Windows Runtime projections.</span></span> <span data-ttu-id="d0ebf-156">Viele dieser Spracherweiterungen ähneln der Syntax für die Sprache C++/CLI.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-156">Many of these language extensions resemble the syntax for the C++/CLI language.</span></span> <span data-ttu-id="d0ebf-157">Anstelle einer Zielgruppenadressierung für die Common Language Runtime (CLR) durchzuführen, verwenden systemeigene Apps diese Syntax zum Erreichen der Windows-Runtime.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-157">However, instead of targeting the common language runtime (CLR), native apps use this syntax to target the Windows Runtime.</span></span> <span data-ttu-id="d0ebf-158">Der Modifizierer in Form einer Objektreferenz, bzw. des Hütchensymbols (^), ist ein wichtiger Teil dieser neuen Syntax, da er die automatische Löschung von Runtime-Objekten anhand einer Referenzzählung ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-158">The object reference, or hat (^), modifier is an important part of this new syntax because it enables the automatic deletion of runtime objects by means of reference counting.</span></span> <span data-ttu-id="d0ebf-159">Anstatt Methoden wie **AddRef** und **Release** zum Verwalten der Lebensdauer eines Windows-Runtime-Objekts aufzurufen, löscht die Runtime das Objekt, wenn keine andere Komponente darauf verweist. Dies ist beispielsweise der Fall, wenn es den Bereich verlässt oder wenn Sie alle Verweise auf **nullptr** festlegen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-159">Instead of calling methods such as **AddRef** and **Release** to manage the lifetime of a Windows Runtime object, the runtime deletes the object when no other component references it, for example, when it leaves scope or you set all references to **nullptr**.</span></span> <span data-ttu-id="d0ebf-160">Ein weiterer wichtiger Aspekt beim Erstellen von UWP-Apps ist das **ref new**-Schlüsselwort.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-160">Another important part of using Visual C++ to create UWP apps is the **ref new** keyword.</span></span> <span data-ttu-id="d0ebf-161">Verwenden Sie **ref new** anstelle von **new**, um Windows-Runtime-Objekte mit Verweiszählung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-161">Use **ref new** instead of **new** to create reference-counted Windows Runtime objects.</span></span> <span data-ttu-id="d0ebf-162">Weitere Informationen finden Sie unter [Typsystem (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh755822).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-162">For more info, see [Type System (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh755822).</span></span>

> **<span data-ttu-id="d0ebf-163">Wichtig</span><span class="sxs-lookup"><span data-stu-id="d0ebf-163">Important</span></span>**  
<span data-ttu-id="d0ebf-164">Wenn Sie Windows-Runtime-Objekte oder Komponenten für die Windows-Runtime erstellen, müssen Sie nur **^** und **ref new** verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-164">You only have to use **^** and **ref new** when you create Windows Runtime objects or create Windows Runtime components.</span></span> <span data-ttu-id="d0ebf-165">Sie können die C++-Standardsyntax verwenden, wenn Sie Kernanwendungscode schreiben, in dem die Windows-Runtime nicht genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-165">You can use the standard C++ syntax when you write core application code that does not use the Windows Runtime.</span></span>

<span data-ttu-id="d0ebf-166">In Marble Maze werden mit **^** und [**Microsoft::WRL::ComPtr**](https://msdn.microsoft.com/library/windows/apps/br244983.aspx) vom Heap zugewiesene Objekte verwaltet und Arbeitsspeicherverluste minimiert.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-166">Marble Maze uses **^** together with [**Microsoft::WRL::ComPtr**](https://msdn.microsoft.com/library/windows/apps/br244983.aspx) to manage heap-allocated objects and minimize memory leaks.</span></span> <span data-ttu-id="d0ebf-167">Es wird empfohlen, mit ^ die Lebensdauer von Windows-Runtime-Variablen zu verwalten, mit **ComPtr** die Lebensdauer von COM-Variables zu verwalten (z.B. bei Verwendung von DirectX) und mit std::[**std::shared\_ptr**](https://msdn.microsoft.com/library/windows/apps/bb982026) oder [**std::unique\_ptr**](https://msdn.microsoft.com/library/windows/apps/ee410601) die Lebensdauer sämtlicher vom Heap zugewiesenen C++-Objekte zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-167">We recommend that you use ^ to manage the lifetime of Windows Runtime variables, **ComPtr** to manage the lifetime of COM variables (such as when you use DirectX), and std::[**std::shared\_ptr**](https://msdn.microsoft.com/library/windows/apps/bb982026) or [**std::unique\_ptr**](https://msdn.microsoft.com/library/windows/apps/ee410601) to manage the lifetime of all other heap-allocated C++ objects.</span></span>

 

<span data-ttu-id="d0ebf-168">Weitere Informationen zu den Spracherweiterungen, die für eine C++-UWP-App verfügbar sind, finden Sie unter [Sprachreferenz zu Visual C++ (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh699871).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-168">For more info about the language extensions that are available to a C++ UWP app, see [Visual C++ Language Reference (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh699871).</span></span>

###  <a name="error-handling"></a><span data-ttu-id="d0ebf-169">Fehlerbehandlung</span><span class="sxs-lookup"><span data-stu-id="d0ebf-169">Error handling</span></span>

<span data-ttu-id="d0ebf-170">In Marble Maze werden unerwartete Fehler in erster Linie mithilfe der Ausnahmebehandlung verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-170">Marble Maze uses exception handling as the primary way to deal with unexpected errors.</span></span> <span data-ttu-id="d0ebf-171">Obwohl für Spielecode zur Angabe von Fehlern traditionell die Protokollierung oder Fehlercodes verwendet werden, beispielsweise **HRESULT**-Werte, bietet die Ausnahmebehandlung zwei wesentliche Vorteile.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-171">Although game code traditionally uses logging or error codes, such as **HRESULT** values, to indicate errors, exception handling has two main advantages.</span></span> <span data-ttu-id="d0ebf-172">Zunächst kann sie das Lesen und Verwalten von Code erleichtern.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-172">First, it can make the code easier to read and maintain.</span></span> <span data-ttu-id="d0ebf-173">Aus Codeperspektive stellt die Ausnahmebehandlung ein effizienteres Verfahren dar, um einen Fehler an eine Routine weiterzugeben, die den Fehler behandeln kann.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-173">From a code perspective, exception handling is a more efficient way to propagate an error to a routine that can handle that error.</span></span> <span data-ttu-id="d0ebf-174">Bei der Verwendung von Fehlercodes muss i.d.R. jede Funktion explizit Fehler weitergeben.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-174">The use of error codes typically requires each function to explicitly propagate errors.</span></span> <span data-ttu-id="d0ebf-175">Ein zweiter Vorteil besteht darin, dass Sie den Visual Studio-Debugger so konfigurieren können, dass er beim Auftreten einer Ausnahme unterbrochen wird, damit die Ausführung unmittelbar an der Position und im Kontext des Fehlers angehalten wird.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-175">A second advantage is that you can configure the Visual Studio debugger to break when an exception occurs so that you can stop immediately at the location and context of the error.</span></span> <span data-ttu-id="d0ebf-176">Die Windows-Runtime macht ebenfalls extensiven Gebrauch von der Ausnahmebehandlung.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-176">The Windows Runtime also uses exception handling extensively.</span></span> <span data-ttu-id="d0ebf-177">Deshalb können Sie durch die Verwendung von Ausnahmebehandlung im Code die gesamte Fehlerbehandlung in einem einzigen Modell zusammenfassen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-177">Therefore, by using exception handling in your code, you can combine all error handling into one model.</span></span>

<span data-ttu-id="d0ebf-178">Es wird empfohlen, in Ihrem Fehlerbehandlungsmodell die folgenden Konventionen zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="d0ebf-178">We recommend that you use the following conventions in your error handling model:</span></span>

-   <span data-ttu-id="d0ebf-179">Kommunizieren Sie unerwartete Fehler anhand von Ausnahmen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-179">Use exceptions to communicate unexpected errors.</span></span>
-   <span data-ttu-id="d0ebf-180">Verwenden Sie Ausnahmen nicht zum Steuern des Codeflusses.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-180">Do not use exceptions to control the flow of code.</span></span>
-   <span data-ttu-id="d0ebf-181">Fangen Sie nur die Ausnahmen ab, die Sie auf jeden Fall behandeln und beheben können.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-181">Catch only the exceptions that you can safely handle and recover from.</span></span> <span data-ttu-id="d0ebf-182">Fangen Sie andernfalls die Ausnahme nicht ab, und ermöglichen Sie das Beenden der App.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-182">Otherwise, do not catch the exception and allow the app to terminate.</span></span>
-   <span data-ttu-id="d0ebf-183">Wenn Sie eine DirectX-Routine aufrufen, die **HRESULT** zurückgibt, verwenden Sie die **DX::ThrowIfFailed**-Funktion.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-183">When you call a DirectX routine that returns **HRESULT**, use the **DX::ThrowIfFailed** function.</span></span> <span data-ttu-id="d0ebf-184">Diese Funktion wird in DirectXSample.h definiert. **ThrowIfFailed** löst eine Ausnahme aus, wenn das bereitgestellte **HRESULT**-Element ein Fehlercode ist.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-184">This function is defined in DirectXSample.h.**ThrowIfFailed** throws an exception if the provided **HRESULT** is an error code.</span></span> <span data-ttu-id="d0ebf-185">**E\_POINTER** bewirkt beispielsweise, dass **ThrowIfFailed** [**Platform::NullReferenceException**](https://msdn.microsoft.com/library/windows/apps/hh755823.aspx) auslöst.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-185">For example, **E\_POINTER** causes **ThrowIfFailed** to throw [**Platform::NullReferenceException**](https://msdn.microsoft.com/library/windows/apps/hh755823.aspx).</span></span>

    <span data-ttu-id="d0ebf-186">Wenn Sie **ThrowIfFailed** verwenden, platzieren Sie den DirectX-Aufruf in einer separaten Zeile, um die Lesbarkeit des Codes zu verbessern. Dies wird im folgenden Beispiel veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-186">When you use **ThrowIfFailed**, put the DirectX call on a separate line to help improve code readability, as shown in the following example.</span></span>

    ```cpp
    // Identify the physical adapter (GPU or card) this device is running on.
    ComPtr<IDXGIAdapter> dxgiAdapter;
    DX::ThrowIfFailed(
        dxgiDevice->GetAdapter(&dxgiAdapter)
        );
    ```

-   <span data-ttu-id="d0ebf-187">Obwohl empfohlen wird, die Verwendung von **HRESULT** für unerwartete Fehler zu vermeiden, ist es wichtiger, auf die Nutzung der Ausnahmebehandlung zur Steuerung des Codeflusses zu verzichten.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-187">Although we recommend that you avoid the use of **HRESULT** for unexpected errors , it is more important to avoid the use of exception handling to control the flow of code.</span></span> <span data-ttu-id="d0ebf-188">Demzufolge wird bevorzugt, bei Bedarf einen **HRESULT**-Rückgabewert zu verwenden, um den Codefluss zu steuern.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-188">Therefore, it is preferred to use an **HRESULT** return value when necessary to control the flow of code.</span></span>

###  <a name="sal-annotations"></a><span data-ttu-id="d0ebf-189">SAL-Anmerkungen</span><span class="sxs-lookup"><span data-stu-id="d0ebf-189">SAL annotations</span></span>

<span data-ttu-id="d0ebf-190">Verwenden Sie SAL-Anmerkungen in Kombination mit Codeanalysetools, um Fehler in der App zu finden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-190">Use SAL annotations together with code analysis tools to help discover errors in your app.</span></span>

<span data-ttu-id="d0ebf-191">Mithilfe der Microsoft-Quellcodeanmerkungssprache (Source Code Annotation Language, SAL) können Sie anmerken bzw. beschreiben, wie eine Funktion die zugehörigen Parameter verwendet.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-191">By using Microsoft source-code annotation language (SAL), you can annotate, or describe, how a function uses its parameters.</span></span> <span data-ttu-id="d0ebf-192">SAL-Anmerkungen werden auch zum Beschreiben von Rückgabewerten verwendet.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-192">SAL annotations also describe return values.</span></span> <span data-ttu-id="d0ebf-193">SAL-Anmerkungen können mit dem C/C++-Codeanalysetool verwendet werden, um mögliche Fehler im C- und C++-Quellcode zu finden.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-193">SAL annotations work with the C/C++ Code Analysis tool to discover possible defects in C and C++ source code.</span></span> <span data-ttu-id="d0ebf-194">Häufige Codierungsfehler, die vom Tool gemeldet werden, beinhalten Pufferüberläufe, nicht initialisierte Speicher, Nullzeiger-Dereferenzierungen und Speicher- und Ressourcenverluste.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-194">Common coding errors reported by the tool include buffer overruns, uninitialized memory, null pointer dereferences, and memory and resource leaks.</span></span>

<span data-ttu-id="d0ebf-195">Ziehen Sie die **BasicLoader::LoadMesh**-Methode in Erwägung, die in BasicLoader.h deklariert wird.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-195">Consider the **BasicLoader::LoadMesh** method, which is declared in BasicLoader.h.</span></span> <span data-ttu-id="d0ebf-196">Diese Methode verwendet \_In\_ für die Angabe, dass *filename* ein Eingabeparameter ist (und folglich nur daraus gelesen wird). Zudem verwendet sie \_Out\_ für die Angabe, dass *vertexBuffer* und *indexBuffer* und Ausgabeparameter sind (und demzufolge in diese Parameter geschrieben wird). Schlussendlich verwendet die Methode \_Out\_opt\_, um anzugeben, dass *vertexCount* und *indexCount* optionale Ausgabeparameter sind (und möglicherweise in diese Parameter geschrieben wird).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-196">This method uses \_In\_ to specify that *filename* is an input parameter (and therefore will only be read from), \_Out\_ to specify that *vertexBuffer* and *indexBuffer* are output parameters (and therefore will only be written to), and \_Out\_opt\_ to specify that *vertexCount* and *indexCount* are optional output parameters (and might be written to).</span></span> <span data-ttu-id="d0ebf-197">Da *vertexCount* und *indexCount* optionale Ausgabeparameter sind, dürfen sie **nullptr** sein.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-197">Because *vertexCount* and *indexCount* are optional output parameters, they are allowed to be **nullptr**.</span></span> <span data-ttu-id="d0ebf-198">Das C/C++-Codeanalysetool untersucht Aufrufe dieser Methode, um sicherzustellen, dass die von ihr übergebenen Parameter diese Kriterien erfüllen.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-198">The C/C++ Code Analysis tool examines calls to this method to ensure that the parameters it passes meet these criteria.</span></span>

```cpp
void LoadMesh(
    _In_ Platform::String^ filename,
    _Out_ ID3D11Buffer** vertexBuffer,
    _Out_ ID3D11Buffer** indexBuffer,
    _Out_opt_ uint32* vertexCount,
    _Out_opt_ uint32* indexCount
    );
```

<span data-ttu-id="d0ebf-199">Wenn Sie eine Codeanalyse für Ihre App ausführen möchten, wählen Sie auf der Menüleiste die Optionen **Erstellen, Codeanalyse für Lösung ausführen** aus.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-199">To perform code analysis on your app, on the menu bar, choose **Build, Run Code Analysis on Solution**.</span></span> <span data-ttu-id="d0ebf-200">Weitere Informationen zur Codeanalyse finden Sie unter [Analysieren der C/C++-Codequalität mithilfe der Codeanalyse](https://msdn.microsoft.com/library/windows/apps/ms182025.aspx).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-200">For more info about code analysis, see [Analyzing C/C++ Code Quality by Using Code Analysis](https://msdn.microsoft.com/library/windows/apps/ms182025.aspx).</span></span>

<span data-ttu-id="d0ebf-201">Die vollständige Liste der verfügbaren Anmerkungen wird in sal.h definiert.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-201">The complete list of available annotations is defined in sal.h.</span></span> <span data-ttu-id="d0ebf-202">Weitere Informationen finden Sie unter [SAL-Anmerkungen](https://msdn.microsoft.com/library/windows/apps/ms235402.aspx).</span><span class="sxs-lookup"><span data-stu-id="d0ebf-202">For more info, see [SAL Annotations](https://msdn.microsoft.com/library/windows/apps/ms235402.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="d0ebf-203">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="d0ebf-203">Next steps</span></span>


<span data-ttu-id="d0ebf-204">Lesen Sie die Informationen unter [Marble Maze-Anwendungsstruktur](marble-maze-application-structure.md), um zu erfahren, wie der Marble Maze-Anwendungscode strukturiert ist und wodurch sich die Struktur einer DirectX-UWP-App von der einer herkömmlichen Desktopanwendung unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="d0ebf-204">Read [Marble Maze application structure](marble-maze-application-structure.md) for information about how the Marble Maze application code is structured and how the structure of a DirectX UWP app differs from that of a traditional desktop application.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d0ebf-205">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="d0ebf-205">Related topics</span></span>


* [<span data-ttu-id="d0ebf-206">Marble Maze-Anwendungsstruktur</span><span class="sxs-lookup"><span data-stu-id="d0ebf-206">Marble Maze application structure</span></span>](marble-maze-application-structure.md)
* [<span data-ttu-id="d0ebf-207">Entwickeln von Marble Maze, einem UWP-Spiel in C++ und DirectX</span><span class="sxs-lookup"><span data-stu-id="d0ebf-207">Developing Marble Maze, a UWP game in C++ and DirectX</span></span>](developing-marble-maze-a-windows-store-game-in-cpp-and-directx.md)

 

 




