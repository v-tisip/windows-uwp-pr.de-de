---
author: eliotcowley
title: Grundlagen am Beispiel von Marble Maze
description: Dieses Dokument beschreibt die fundamentalen Eigenschaften des Marble Maze-Projekt; beispielsweise wie Visual C++ in der Windows-Runtime-Umgebung verwendet wird, wie es erstellt und strukturiert ist und wie es aufgebaut ist.
ms.assetid: 73329b29-62e3-1b36-01db-b7744ee5b4c3
ms.author: elcowle
ms.date: 08/22/2017
ms.topic: article
keywords: Windows10, Uwp, Spiele, Beispiel, Directx, Grundlagen
ms.localizationpriority: medium
ms.openlocfilehash: f595c8f429c93a13d6342c281a90f3b0f5741621
ms.sourcegitcommit: 6cc275f2151f78db40c11ace381ee2d35f0155f9
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/25/2018
ms.locfileid: "5544401"
---
# <a name="marble-maze-sample-fundamentals"></a><span data-ttu-id="a5ab9-104">Grundlagen am Beispiel von Marble Maze</span><span class="sxs-lookup"><span data-stu-id="a5ab9-104">Marble Maze sample fundamentals</span></span>




<span data-ttu-id="a5ab9-105">In diesem Thema werden die fundamentalen Eigenschaften des Marble Maze-Projekt&mdash;s beschrieben, beispielsweise wie Visual C++ in der Windows Runtime-Umgebung verwendet wird, wie es erstellt und strukturiert wird und wie es aufgebaut ist.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-105">This topic describes the fundamental characteristics of the Marble Maze project&mdash;for example, how it uses Visual C++ in the Windows Runtime environment, how it is created and structured, and how it is built.</span></span> <span data-ttu-id="a5ab9-106">Das Thema enthält auch eine Beschreibung verschiedener Konventionen, die im Code verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-106">The topic also describes several of the conventions that are used in the code.</span></span>

> [!NOTE]
> <span data-ttu-id="a5ab9-107">Den Beispielcode für dieses Dokument finden Sie im [DirectX-Beispielspiel Marble Maze](http://go.microsoft.com/fwlink/?LinkId=624011).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-107">The sample code that corresponds to this document is found in the [DirectX Marble Maze game sample](http://go.microsoft.com/fwlink/?LinkId=624011).</span></span>

<span data-ttu-id="a5ab9-108">Es folgen einige wichtige Punkte, die in diesem Dokument erläutert werden und die beim Planen und Entwickeln Ihres UWP-Spiels relevant sind.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-108">Here are some of the key points that this document discusses for when you plan and develop your Universal Windows Platform (UWP) game.</span></span>

-   <span data-ttu-id="a5ab9-109">Verwenden Sie die Visual C++ Vorlage **DirectX 11-App (Universelle Windows-App)** in Visual Studio, um das DirectX-UWP-Spiel zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-109">Use the **DirectX 11 App (Universal Windows)** Visual C++ template in Visual Studio to create your DirectX UWP game.</span></span>
-   <span data-ttu-id="a5ab9-110">Windows-Runtime stellt Klassen und Schnittstellen bereit, sodass Sie UWP-Apps auf moderne, objektorientierte Art und Weise entwickeln können.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-110">The Windows Runtime provides classes and interfaces so that you can develop UWP apps in a more modern, object-oriented manner.</span></span>
-   <span data-ttu-id="a5ab9-111">Verwenden Sie Objektreferenzen mit Hütchensymbol (^), um die Lebensdauer von Windows-Runtime-Variablen zu verwalten, [Microsoft::WRL::ComPtr](https://docs.microsoft.com/cpp/windows/comptr-class) zum Verwalten der Lebensdauer von COM-Objekten und [std::shared\_ptr](https://docs.microsoft.com/cpp/standard-library/shared-ptr-class) oder [std::unique\_ptr](https://docs.microsoft.com/cpp/standard-library/unique-ptr-class) zum Verwalten der Lebensdauer aller anderen, vom Heap zugewiesenen C++-Objekte.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-111">Use object references with the hat (^) symbol to manage the lifetime of Windows Runtime variables, [Microsoft::WRL::ComPtr](https://docs.microsoft.com/cpp/windows/comptr-class) to manage the lifetime of COM objects, and [std::shared\_ptr](https://docs.microsoft.com/cpp/standard-library/shared-ptr-class) or [std::unique\_ptr](https://docs.microsoft.com/cpp/standard-library/unique-ptr-class) to manage the lifetime of all other heap-allocated C++ objects.</span></span>
-   <span data-ttu-id="a5ab9-112">In den meisten Fällen verwenden Sie für die Behandlung unerwarteter Fehler die Ausnahmebehandlung anstelle von Ergebniscodes.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-112">In most cases, use exception handling, instead of result codes, to deal with unexpected errors.</span></span>
-   <span data-ttu-id="a5ab9-113">Verwenden Sie [SAL-Anmerkungen](https://docs.microsoft.com/visualstudio/code-quality/using-sal-annotations-to-reduce-c-cpp-code-defects) Kombination mit Codeanalysetools, um Fehler in Ihrer app zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-113">Use [SAL annotations](https://docs.microsoft.com/visualstudio/code-quality/using-sal-annotations-to-reduce-c-cpp-code-defects) together with code analysis tools to help discover errors in your app.</span></span>

## <a name="creating-the-visual-studio-project"></a><span data-ttu-id="a5ab9-114">Erstellen des Visual Studio-Projekts</span><span class="sxs-lookup"><span data-stu-id="a5ab9-114">Creating the Visual Studio project</span></span>


<span data-ttu-id="a5ab9-115">Wenn Sie heruntergeladen und extrahiert haben das Beispiel, Sie können die **MarbleMaze_VS2017.sln** -Datei (in der **C++** -Ordner) in Visual Studio öffnen, und Sie müssen den Code vor Ihnen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-115">If you've downloaded and extracted the sample, you can open the **MarbleMaze_VS2017.sln** file (in the **C++** folder) in Visual Studio, and you'll have the code in front of you.</span></span>

<span data-ttu-id="a5ab9-116">Beim Erstellen des Visual Studio-Projekts für Marble Maze haben wir mit einem bereits vorhandenen Projekt begonnen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-116">When we created the Visual Studio project for Marble Maze, we started with an existing project.</span></span> <span data-ttu-id="a5ab9-117">Wenn Sie jedoch noch kein vorhandenes Projekt haben, das die grundlegende, für Ihr DirectX-UWP-Spiel erforderliche Funktionalität bereitstellt, wird empfohlen, ein Projekt basierend auf der Visual Studio-Vorlage **DirectX 11-App (Universelle Windows-App)** zu erstellen, da sie eine grundlegende, funktionierende 3D-Anwendung enthält.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-117">However, if you do not already have an existing project that provides the basic functionality that your DirectX UWP game requires, we recommend that you create a project based on the Visual Studio **DirectX 11 App (Universal Windows)** template because it provides a basic working 3D application.</span></span> <span data-ttu-id="a5ab9-118">Gehen Sie hierzu folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="a5ab9-118">To do this, follow these steps:</span></span>

1. <span data-ttu-id="a5ab9-119">Wählen Sie in Visual Studio 2017 **Datei > Neu > Projekt**</span><span class="sxs-lookup"><span data-stu-id="a5ab9-119">In Visual Studio 2017, select **File > New > Project...**</span></span>

2. <span data-ttu-id="a5ab9-120">Wählen Sie im Fenster **Neues Projekt** in der linken Seitenleiste **installiert > Vorlagen > Visual C++**.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-120">In the **New Project** window, in the left sidebar, select **Installed > Templates > Visual C++**.</span></span>

3. <span data-ttu-id="a5ab9-121">Wählen Sie in der Liste mittleren **DirectX 11-App (Universal Windows)**.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-121">In the middle list, select **DirectX 11 App (Universal Windows)**.</span></span> <span data-ttu-id="a5ab9-122">Wenn diese Option nicht angezeigt wird, können Sie nicht die erforderlichen Komponenten installiert haben&mdash;finden Sie Informationen dazu, wie Sie zusätzliche Komponenten installieren [Ändern Visual Studio 2017 hinzufügen oder Entfernen von Workloads und Komponenten](https://docs.microsoft.com/visualstudio/install/modify-visual-studio) .</span><span class="sxs-lookup"><span data-stu-id="a5ab9-122">If you don't see this option, you may not have the required components installed&mdash;see [Modify Visual Studio 2017 by adding or removing workloads and components](https://docs.microsoft.com/visualstudio/install/modify-visual-studio) for information about how to install additional components.</span></span>

4. <span data-ttu-id="a5ab9-123">Verleihen Sie Ihrem Projekt einen **Namen**, einen **Speicherort** für die Dateien gespeichert werden und eine **Lösungsnamen**, und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-123">Give your project a **Name**, a **Location** for the files to be stored, and a **Solution name**, and click **OK**.</span></span>

![Neues Projekt](images/marble-maze-sample-fundamentals-1.png)

<span data-ttu-id="a5ab9-125">Eine wichtige Projekteinstellung in der Voralge **DirectX 11-App (Universelle Windows-App)** ist die Option **/ZW**. Diese Option ermöglicht dem Programm die Verwendung der Windows-Runtime-Spracherweiterungen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-125">One important project setting in the **DirectX 11 App (Universal Windows)** template is the **/ZW** option, which enables the program to use the Windows Runtime language extensions.</span></span> <span data-ttu-id="a5ab9-126">Sie ist standardmäßig aktiviert, wenn Sie die Visual Studio-Vorlage verwenden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-126">This option is enabled by default when you use the Visual Studio template.</span></span> <span data-ttu-id="a5ab9-127">Weitere Informationen zur Vorgehensweise beim Festlegen von Compiler-Optionen in Visual Studio finden Sie unter [Compileroptionen festlegen](https://docs.microsoft.com/cpp/build/reference/setting-compiler-options).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-127">See [Setting Compiler Options](https://docs.microsoft.com/cpp/build/reference/setting-compiler-options) for more info about how to set compiler options in Visual Studio.</span></span>

> <span data-ttu-id="a5ab9-128">**Achtung**  die **Option/Zw** ist nicht kompatibel mit Optionen wie z. **B./CLR**.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-128">**Caution** The **/ZW** option is not compatible with options such as **/clr**.</span></span> <span data-ttu-id="a5ab9-129">Im Fall von **/clr** können Sie demnach über ein und dasselbe Visual C++-Projekt nicht das .NET Framework und die Windows-Runtime erreichen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-129">In the case of **/clr**, this means that you cannot target both the .NET Framework and the Windows Runtime from the same Visual C++ project.</span></span>

 

<span data-ttu-id="a5ab9-130">Jede UWP-app, die Sie aus dem Microsoft Store erwerben stammt in Form von einem app-Paket.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-130">Every UWP app that you acquire from the Microsoft Store comes in the form of an app package.</span></span> <span data-ttu-id="a5ab9-131">Ein App-Paket enthält ein App-Manifest, das wiederum Informationen zur App beinhaltet.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-131">An app package contains a package manifest, which contains information about your app.</span></span> <span data-ttu-id="a5ab9-132">Sie können beispielsweise die Funktionen (d.h. den erforderlichen Zugriff auf geschützte Systemressourcen oder Benutzerdaten) Ihrer App angeben.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-132">For example, you can specify the capabilities (that is, the required access to protected system resources or user data) of your app.</span></span> <span data-ttu-id="a5ab9-133">Wenn Sie festlegen, dass für Ihre App bestimmte Funktionen erforderlich sind, verwenden Sie das Paketmanifest, um die erforderlichen Funktionen zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-133">If you determine that your app requires certain capabilities, use the package manifest to declare the required capabilities.</span></span> <span data-ttu-id="a5ab9-134">Das Manifest ermöglicht Ihnen auch die Angabe von Projekteigenschaften wie der Rotation unterstützter Geräte, Kachelbildern und Begrüßungsbildschirm.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-134">The manifest also lets you specify project properties such as supported device rotations, tile images, and the splash screen.</span></span> <span data-ttu-id="a5ab9-135">Sie können das Manifest bearbeiten, indem Sie **Package.appxmanifest** in Ihrem Projekt öffnen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-135">You can edit the manifest by opening **Package.appxmanifest** in your project.</span></span> <span data-ttu-id="a5ab9-136">Weitere Informationen zu App-Paketen finden Sie unter [Verpacken von Apps](https://msdn.microsoft.com/library/windows/apps/mt270969).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-136">For more info about app packages, see [Packaging apps](https://msdn.microsoft.com/library/windows/apps/mt270969).</span></span>

##  <a name="building-deploying-and-running-the-game"></a><span data-ttu-id="a5ab9-137">Erstellen, Bereitstellen und Ausführen des Spiels</span><span class="sxs-lookup"><span data-stu-id="a5ab9-137">Building, deploying, and running the game</span></span>

<span data-ttu-id="a5ab9-138">Wählen Sie in den Dropdownmenüs oben in Visual Studio links neben der grünen Schaltfläche "Wiedergabe" die Konfiguration Ihrer Bereitstellung aus.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-138">In the dropdown menus at the top of Visual Studio, to the left of the green play button, select your deployment configuration.</span></span> <span data-ttu-id="a5ab9-139">Wir empfehlen die Einstellung als **Debuggen** und die Architektur Ihres Geräts auf (**x86** für 32-Bit, **x64** für 64-Bit) und auf **Lokaler Computer** festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-139">We recommend setting it as **Debug** targeting your device's architecture (**x86** for 32-bit, **x64** for 64-bit) and to your **Local Machine**.</span></span> <span data-ttu-id="a5ab9-140">Sie können ebenfalls einen **Remotecomputer** oder ein **Gerät** testen, das über USB verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-140">You can also test on a **Remote Machine**, or to a **Device** that's connected via USB.</span></span> <span data-ttu-id="a5ab9-141">Klicken Sie dann auf die grüne Wiedergabeschaltfläche zum Erstellen und Bereitstellen auf Ihrem Gerät.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-141">Then click the green play button to build and deploy to your device.</span></span>

![Debuggen; X64; Lokaler Computer](images/marble-maze-sample-fundamentals-2.png)

###  <a name="controlling-the-game"></a><span data-ttu-id="a5ab9-143">Steuern des Spiels</span><span class="sxs-lookup"><span data-stu-id="a5ab9-143">Controlling the game</span></span>

<span data-ttu-id="a5ab9-144">Sie können die Fingereingabe, den Beschleunigungsmesser, Xbox One-Controller oder die Maus, um die Steuerung von Marble Maze verwenden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-144">You can use touch, the accelerometer, the Xbox One controller, or the mouse to control Marble Maze.</span></span>

-   <span data-ttu-id="a5ab9-145">Mithilfe des Steuerkreuzes am Controller können Sie das aktive Menüelement ändern.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-145">Use the directional pad on the controller to change the active menu item.</span></span>
-   <span data-ttu-id="a5ab9-146">Verwenden Sie Toucheingabe, die A oder Start Taste am Controller oder die Maus, um ein Menüelement auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-146">Use touch, the A or Start button on the controller, or the mouse to pick a menu item.</span></span>
-   <span data-ttu-id="a5ab9-147">Über die Fingereingabe, den Beschleunigungsmesser, den linken Ministick oder die Maus können Sie das Labyrinth neigen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-147">Use touch, the accelerometer, the left thumbstick, or the mouse to tilt the maze.</span></span>
-   <span data-ttu-id="a5ab9-148">Verwenden Sie Toucheingabe, die A oder Start Taste am Controller oder die Maus zum Schließen von Menüs wie der Highscore-Tabelle.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-148">Use touch, the A or Start button on the controller, or the mouse to close menus such as the high score table.</span></span>
-   <span data-ttu-id="a5ab9-149">Verwenden Sie die Schaltfläche "Start" am Controller oder der P-Taste auf der Tastatur, um das Spiel anzuhalten oder fortzusetzen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-149">Use the Start button on the controller or the P key on the keyboard to pause or resume the game.</span></span>
-   <span data-ttu-id="a5ab9-150">Zum Neustarten des Spiels können Sie die Zurück-Taste am Controller oder die Pos1-Taste auf der Tastatur verwenden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-150">Use the Back button on the controller or the Home key on the keyboard to restart the game.</span></span>
-   <span data-ttu-id="a5ab9-151">Wenn die Highscore Tabelle sichtbar ist, verwenden Sie die Schaltfläche "zurück" am Controller oder die POS1-Taste auf der Tastatur, um alle punktergebnisse löschen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-151">When the high-score table is visible, use the Back button on the controller or the Home key on the keyboard to clear all scores.</span></span>

##  <a name="code-conventions"></a><span data-ttu-id="a5ab9-152">Codekonventionen</span><span class="sxs-lookup"><span data-stu-id="a5ab9-152">Code conventions</span></span>


<span data-ttu-id="a5ab9-153">Die Windows-Runtime ist eine Programmierschnittstelle, die Sie zum Erstellen von UWP-Apps verwenden können, die nur in einer speziellen Anwendungsumgebung ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-153">The Windows Runtime is a programming interface that you can use to create UWP apps that run only in a special application environment.</span></span> <span data-ttu-id="a5ab9-154">Solche apps verwenden autorisierte Funktionen, Datentypen und Geräte, und Sie werden aus dem Microsoft Store verteilt.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-154">Such apps use authorized functions, data types, and devices, and are distributed from the Microsoft Store.</span></span> <span data-ttu-id="a5ab9-155">Die Windows-Runtime besteht auf der untersten Ebene aus einer binären Anwendungsschnittstelle (Application Binary Interface, ABI).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-155">At the lowest level, the Windows Runtime consists of an Application Binary Interface (ABI).</span></span> <span data-ttu-id="a5ab9-156">Die ABI ist ein binärer Vertrag auf unterer Ebene, der Windows-Runtime-APIs für mehrere Programmiersprachen zur Verfügung stellt, beispielsweise für JavaScript, die .NET-Sprachen und Visual C++.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-156">The ABI is a low-level binary contract that makes Windows Runtime APIs accessible to multiple programming languages such as JavaScript, the .NET languages, and Visual C++.</span></span>

<span data-ttu-id="a5ab9-157">Diese Sprachen erfordern für den Aufruf von Windows-Runtime-APIs aus JavaScript und .NET Projektionen, die für die jeweilige Sprachumgebung spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-157">In order to call Windows Runtime APIs from JavaScript and .NET, those languages require projections that are specific to each language environment.</span></span> <span data-ttu-id="a5ab9-158">Wenn Sie eine Windows-Runtime-API aus JavaScript oder .NET aufrufen, rufen Sie die Projektion auf, die wiederum die zugrunde liegende ABI-Funktion aufruft.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-158">When you call a Windows Runtime API from JavaScript or .NET, you are invoking the projection, which in turn calls the underlying ABI function.</span></span> <span data-ttu-id="a5ab9-159">Sie können zwar die ABI-Funktionen direkt aus Standard-C++ aufrufen, jedoch stellt Microsoft auch Projektionen für C++ bereit, da diese die Verwendung der Windows-Runtime-APIs stark vereinfachen und dennoch eine hohe Leistung aufrecht erhalten.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-159">Although you can call the ABI functions directly in C++, Microsoft provides projections for C++ as well, because they make it much simpler to consume the Windows Runtime APIs, while still maintaining high performance.</span></span> <span data-ttu-id="a5ab9-160">Microsoft stellt außerdem Spracherweiterungen für Visual C++ bereit, die spezielle Unterstützung für die Windows-Runtime-Projektionen bieten.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-160">Microsoft also provides language extensions to Visual C++ that specifically support the Windows Runtime projections.</span></span> <span data-ttu-id="a5ab9-161">Viele dieser Spracherweiterungen ähneln der Syntax für die Sprache C++/CLI.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-161">Many of these language extensions resemble the syntax for the C++/CLI language.</span></span> <span data-ttu-id="a5ab9-162">Anstelle einer Zielgruppenadressierung für die Common Language Runtime (CLR) durchzuführen, verwenden systemeigene Apps diese Syntax zum Erreichen der Windows-Runtime.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-162">However, instead of targeting the common language runtime (CLR), native apps use this syntax to target the Windows Runtime.</span></span> <span data-ttu-id="a5ab9-163">Der Modifizierer in Form einer Objektreferenz, bzw. des Hütchensymbols (^), ist ein wichtiger Teil dieser neuen Syntax, da er die automatische Löschung von Runtime-Objekten anhand einer Referenzzählung ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-163">The object reference, or hat (^), modifier is an important part of this new syntax because it enables the automatic deletion of runtime objects by means of reference counting.</span></span> <span data-ttu-id="a5ab9-164">Anstatt Methoden wie [AddRef](https://msdn.microsoft.com/library/windows/desktop/ms691379) und [Release](https://msdn.microsoft.com/library/windows/desktop/ms682317) zum Verwalten der Lebensdauer eines Windows-Runtime-Objekts aufzurufen, löscht die Runtime das Objekt, wenn keine andere Komponente darauf verweist. Dies ist beispielsweise der Fall, wenn es den Bereich verlässt oder wenn Sie alle Verweise auf **nullptr** festlegen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-164">Instead of calling methods such as [AddRef](https://msdn.microsoft.com/library/windows/desktop/ms691379) and [Release](https://msdn.microsoft.com/library/windows/desktop/ms682317) to manage the lifetime of a Windows Runtime object, the runtime deletes the object when no other component references it, for example, when it leaves scope or you set all references to **nullptr**.</span></span> <span data-ttu-id="a5ab9-165">Ein weiterer wichtiger Aspekt beim Erstellen von UWP-Apps ist das **ref new**-Schlüsselwort.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-165">Another important part of using Visual C++ to create UWP apps is the **ref new** keyword.</span></span> <span data-ttu-id="a5ab9-166">Verwenden Sie **ref new** anstelle von **new**, um Windows-Runtime-Objekte mit Verweiszählung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-166">Use **ref new** instead of **new** to create reference-counted Windows Runtime objects.</span></span> <span data-ttu-id="a5ab9-167">Weitere Informationen finden Sie unter [Typsystem (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh755822).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-167">For more info, see [Type System (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh755822).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="a5ab9-168">Wenn Sie Windows-Runtime-Objekte oder Komponenten für die Windows-Runtime erstellen, müssen Sie nur **^** und **ref new** verwenden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-168">You only have to use **^** and **ref new** when you create Windows Runtime objects or create Windows Runtime components.</span></span> <span data-ttu-id="a5ab9-169">Sie können die C++-Standardsyntax verwenden, wenn Sie Kernanwendungscode schreiben, in dem die Windows-Runtime nicht genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-169">You can use the standard C++ syntax when you write core application code that does not use the Windows Runtime.</span></span>

<span data-ttu-id="a5ab9-170">In Marble Maze werden mit **^** und **Microsoft::WRL::ComPtr** vom Heap zugewiesene Objekte verwaltet und Arbeitsspeicherverluste minimiert.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-170">Marble Maze uses **^** together with **Microsoft::WRL::ComPtr** to manage heap-allocated objects and minimize memory leaks.</span></span> <span data-ttu-id="a5ab9-171">Wir empfehlen die Verwendung ^ die Lebensdauer von Windows-Runtime-Variablen zu **ComPtr** zum Verwalten der Lebensdauer von COM-Variablen (z. B. bei Verwendung von DirectX), und **Std:: shared\_ptr** oder **Std:: unique\_ptr** zum Verwalten der Lebensdauer aller anderen zu verwalten Heap zugewiesenen C++-Objekte.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-171">We recommend that you use ^ to manage the lifetime of Windows Runtime variables, **ComPtr** to manage the lifetime of COM variables (such as when you use DirectX), and **std::shared\_ptr** or **std::unique\_ptr** to manage the lifetime of all other heap-allocated C++ objects.</span></span>

 

<span data-ttu-id="a5ab9-172">Weitere Informationen zu den Spracherweiterungen, die für eine C++-UWP-App verfügbar sind, finden Sie unter [Sprachreferenz zu Visual C++ (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh699871).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-172">For more info about the language extensions that are available to a C++ UWP app, see [Visual C++ Language Reference (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh699871).</span></span>

###  <a name="error-handling"></a><span data-ttu-id="a5ab9-173">Fehlerbehandlung</span><span class="sxs-lookup"><span data-stu-id="a5ab9-173">Error handling</span></span>

<span data-ttu-id="a5ab9-174">In Marble Maze werden unerwartete Fehler in erster Linie mithilfe der Ausnahmebehandlung verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-174">Marble Maze uses exception handling as the primary way to deal with unexpected errors.</span></span> <span data-ttu-id="a5ab9-175">Obwohl für Spielecode zur Angabe von Fehlern traditionell die Protokollierung oder Fehlercodes verwendet werden, beispielsweise **HRESULT**-Werte, bietet die Ausnahmebehandlung zwei wesentliche Vorteile.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-175">Although game code traditionally uses logging or error codes, such as **HRESULT** values, to indicate errors, exception handling has two main advantages.</span></span> <span data-ttu-id="a5ab9-176">Zunächst kann sie das Lesen und Verwalten von Code erleichtern.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-176">First, it can make the code easier to read and maintain.</span></span> <span data-ttu-id="a5ab9-177">Aus Codeperspektive stellt die Ausnahmebehandlung ein effizienteres Verfahren dar, um einen Fehler an eine Routine weiterzugeben, die den Fehler behandeln kann.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-177">From a code perspective, exception handling is a more efficient way to propagate an error to a routine that can handle that error.</span></span> <span data-ttu-id="a5ab9-178">Bei der Verwendung von Fehlercodes muss i.d.R. jede Funktion explizit Fehler weitergeben.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-178">The use of error codes typically requires each function to explicitly propagate errors.</span></span> <span data-ttu-id="a5ab9-179">Ein zweiter Vorteil besteht darin, dass Sie den Visual Studio-Debugger so konfigurieren können, dass er beim Auftreten einer Ausnahme unterbrochen wird, damit die Ausführung unmittelbar an der Position und im Kontext des Fehlers angehalten wird.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-179">A second advantage is that you can configure the Visual Studio debugger to break when an exception occurs so that you can stop immediately at the location and context of the error.</span></span> <span data-ttu-id="a5ab9-180">Die Windows-Runtime macht ebenfalls extensiven Gebrauch von der Ausnahmebehandlung.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-180">The Windows Runtime also uses exception handling extensively.</span></span> <span data-ttu-id="a5ab9-181">Deshalb können Sie durch die Verwendung von Ausnahmebehandlung im Code die gesamte Fehlerbehandlung in einem einzigen Modell zusammenfassen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-181">Therefore, by using exception handling in your code, you can combine all error handling into one model.</span></span>

<span data-ttu-id="a5ab9-182">Es wird empfohlen, in Ihrem Fehlerbehandlungsmodell die folgenden Konventionen zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="a5ab9-182">We recommend that you use the following conventions in your error handling model:</span></span>

-   <span data-ttu-id="a5ab9-183">Kommunizieren Sie unerwartete Fehler anhand von Ausnahmen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-183">Use exceptions to communicate unexpected errors.</span></span>
-   <span data-ttu-id="a5ab9-184">Verwenden Sie Ausnahmen nicht zum Steuern des Codeflusses.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-184">Do not use exceptions to control the flow of code.</span></span>
-   <span data-ttu-id="a5ab9-185">Fangen Sie nur die Ausnahmen ab, die Sie auf jeden Fall behandeln und beheben können.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-185">Catch only the exceptions that you can safely handle and recover from.</span></span> <span data-ttu-id="a5ab9-186">Fangen Sie andernfalls die Ausnahme nicht ab, und ermöglichen Sie das Beenden der App.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-186">Otherwise, do not catch the exception and allow the app to terminate.</span></span>
-   <span data-ttu-id="a5ab9-187">Wenn Sie eine DirectX-Routine aufrufen, die **HRESULT** zurückgibt, verwenden Sie die **DX::ThrowIfFailed**-Funktion.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-187">When you call a DirectX routine that returns **HRESULT**, use the **DX::ThrowIfFailed** function.</span></span> <span data-ttu-id="a5ab9-188">Diese Funktion wird in ["directxhelper.h"](https://github.com/Microsoft/Windows-appsample-marble-maze/blob/master/C%2B%2B/Shared/DirectXHelper.h)definiert.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-188">This function is defined in [DirectXHelper.h](https://github.com/Microsoft/Windows-appsample-marble-maze/blob/master/C%2B%2B/Shared/DirectXHelper.h).</span></span> <span data-ttu-id="a5ab9-189">**ThrowIfFailed** löst eine Ausnahme aus, wenn das bereitgestellte **HRESULT** ein Fehlercode ist.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-189">**ThrowIfFailed** throws an exception if the provided **HRESULT** is an error code.</span></span> <span data-ttu-id="a5ab9-190">**E\_POINTER** bewirkt beispielsweise, dass **ThrowIfFailed** [Platform::NullReferenceException](https://msdn.microsoft.com/library/windows/apps/hh755823.aspx) auslöst.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-190">For example, **E\_POINTER** causes **ThrowIfFailed** to throw [Platform::NullReferenceException](https://msdn.microsoft.com/library/windows/apps/hh755823.aspx).</span></span>

    <span data-ttu-id="a5ab9-191">Wenn Sie **ThrowIfFailed** verwenden, platzieren Sie den DirectX-Aufruf in einer separaten Zeile, um die Lesbarkeit des Codes zu verbessern. Dies wird im folgenden Beispiel veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-191">When you use **ThrowIfFailed**, put the DirectX call on a separate line to help improve code readability, as shown in the following example.</span></span>

    ```cpp
    // Identify the physical adapter (GPU or card) this device is running on.
    ComPtr<IDXGIAdapter> dxgiAdapter;
    DX::ThrowIfFailed(
        dxgiDevice->GetAdapter(&dxgiAdapter)
        );
    ```

-   <span data-ttu-id="a5ab9-192">Es wird jedoch empfohlen, dass Sie die Verwendung von **HRESULT** für unerwartete Fehler vermeiden, ist es wichtiger, auf die Verwendung der Ausnahmebehandlung zur Steuerung des Code zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-192">Although we recommend that you avoid the use of **HRESULT** for unexpected errors, it is more important to avoid the use of exception handling to control the flow of code.</span></span> <span data-ttu-id="a5ab9-193">Demzufolge wird bevorzugt, bei Bedarf einen **HRESULT**-Rückgabewert zu verwenden, um den Codefluss zu steuern.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-193">Therefore, it is preferred to use an **HRESULT** return value when necessary to control the flow of code.</span></span>

###  <a name="sal-annotations"></a><span data-ttu-id="a5ab9-194">SAL-Anmerkungen</span><span class="sxs-lookup"><span data-stu-id="a5ab9-194">SAL annotations</span></span>

<span data-ttu-id="a5ab9-195">Verwenden Sie SAL-Anmerkungen in Kombination mit Codeanalysetools, um Fehler in der App zu finden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-195">Use SAL annotations together with code analysis tools to help discover errors in your app.</span></span>

<span data-ttu-id="a5ab9-196">Mithilfe der Microsoft-Quellcodeanmerkungssprache (Source Code Annotation Language, SAL) können Sie anmerken bzw. beschreiben, wie eine Funktion die zugehörigen Parameter verwendet.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-196">By using Microsoft source-code annotation language (SAL), you can annotate, or describe, how a function uses its parameters.</span></span> <span data-ttu-id="a5ab9-197">SAL-Anmerkungen werden auch zum Beschreiben von Rückgabewerten verwendet.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-197">SAL annotations also describe return values.</span></span> <span data-ttu-id="a5ab9-198">SAL-Anmerkungen können mit dem C/C++-Codeanalysetool verwendet werden, um mögliche Fehler im C- und C++-Quellcode zu finden.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-198">SAL annotations work with the C/C++ Code Analysis tool to discover possible defects in C and C++ source code.</span></span> <span data-ttu-id="a5ab9-199">Häufige Codierungsfehler, die vom Tool gemeldet werden, beinhalten Pufferüberläufe, nicht initialisierte Speicher, Nullzeiger-Dereferenzierungen und Speicher- und Ressourcenverluste.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-199">Common coding errors reported by the tool include buffer overruns, uninitialized memory, null pointer dereferences, and memory and resource leaks.</span></span>

<span data-ttu-id="a5ab9-200">Betrachten Sie die **basicloader:: Loadmesh** -Methode, die in [BasicLoader.h](https://github.com/Microsoft/Windows-appsample-marble-maze/blob/e62d68a85499e208d591d2caefbd9df62af86809/C%2B%2B/Shared/BasicLoader.h)deklariert wird.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-200">Consider the **BasicLoader::LoadMesh** method, which is declared in [BasicLoader.h](https://github.com/Microsoft/Windows-appsample-marble-maze/blob/e62d68a85499e208d591d2caefbd9df62af86809/C%2B%2B/Shared/BasicLoader.h).</span></span> <span data-ttu-id="a5ab9-201">Diese Methode verwendet `_In_` an *Dateinamen* ein Eingabeparameter ist (und daher nur aus lesen), `_Out_` angeben, dass *VertexBuffer* und *IndexBuffer* Ausgabeparameter sind (und daher nur geschrieben wird) und `_Out_opt_` angeben, dass *VertexCount* und *IndexCount* optionale sind Ausgabeparameter (und möglicherweise in geschrieben werden).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-201">This method uses `_In_` to specify that *filename* is an input parameter (and therefore will only be read from), `_Out_` to specify that *vertexBuffer* and *indexBuffer* are output parameters (and therefore will only be written to), and `_Out_opt_` to specify that *vertexCount* and *indexCount* are optional output parameters (and might be written to).</span></span> <span data-ttu-id="a5ab9-202">Da *vertexCount* und *indexCount* optionale Ausgabeparameter sind, dürfen sie **nullptr** sein.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-202">Because *vertexCount* and *indexCount* are optional output parameters, they are allowed to be **nullptr**.</span></span> <span data-ttu-id="a5ab9-203">Das C/C++-Codeanalysetool untersucht Aufrufe dieser Methode, um sicherzustellen, dass die von ihr übergebenen Parameter diese Kriterien erfüllen.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-203">The C/C++ Code Analysis tool examines calls to this method to ensure that the parameters it passes meet these criteria.</span></span>

```cpp
void LoadMesh(
    _In_ Platform::String^ filename,
    _Out_ ID3D11Buffer** vertexBuffer,
    _Out_ ID3D11Buffer** indexBuffer,
    _Out_opt_ uint32* vertexCount,
    _Out_opt_ uint32* indexCount
    );
```

<span data-ttu-id="a5ab9-204">Wählen Sie zum Ausführen der Codeanalyse auf Ihrer app auf der Menüleiste **Build > Codeanalyse für Lösung ausführen**.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-204">To perform code analysis on your app, on the menu bar, choose **Build > Run Code Analysis on Solution**.</span></span> <span data-ttu-id="a5ab9-205">Weitere Informationen zur Codeanalyse finden Sie unter [Analysieren der C/C++-Codequalität mithilfe der Codeanalyse](https://docs.microsoft.com/visualstudio/code-quality/analyzing-c-cpp-code-quality-by-using-code-analysis).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-205">For more info about code analysis, see [Analyzing C/C++ Code Quality by Using Code Analysis](https://docs.microsoft.com/visualstudio/code-quality/analyzing-c-cpp-code-quality-by-using-code-analysis).</span></span>

<span data-ttu-id="a5ab9-206">Die vollständige Liste der verfügbaren Anmerkungen wird in sal.h definiert.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-206">The complete list of available annotations is defined in sal.h.</span></span> <span data-ttu-id="a5ab9-207">Weitere Informationen finden Sie unter [SAL-Anmerkungen](https://docs.microsoft.com/cpp/c-runtime-library/sal-annotations).</span><span class="sxs-lookup"><span data-stu-id="a5ab9-207">For more info, see [SAL Annotations](https://docs.microsoft.com/cpp/c-runtime-library/sal-annotations).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a5ab9-208">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="a5ab9-208">Next steps</span></span>


<span data-ttu-id="a5ab9-209">Lesen Sie die Informationen unter [Marble Maze-Anwendungsstruktur](marble-maze-application-structure.md), um zu erfahren, wie der Marble Maze-Anwendungscode strukturiert ist und wodurch sich die Struktur einer DirectX-UWP-App von der einer herkömmlichen Desktopanwendung unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="a5ab9-209">Read [Marble Maze application structure](marble-maze-application-structure.md) for information about how the Marble Maze application code is structured and how the structure of a DirectX UWP app differs from that of a traditional desktop application.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a5ab9-210">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="a5ab9-210">Related topics</span></span>


* [<span data-ttu-id="a5ab9-211">Marble Maze-Anwendungsstruktur</span><span class="sxs-lookup"><span data-stu-id="a5ab9-211">Marble Maze application structure</span></span>](marble-maze-application-structure.md)
* [<span data-ttu-id="a5ab9-212">Entwickeln von Marble Maze, einem UWP-Spiel in C++ und DirectX</span><span class="sxs-lookup"><span data-stu-id="a5ab9-212">Developing Marble Maze, a UWP game in C++ and DirectX</span></span>](developing-marble-maze-a-windows-store-game-in-cpp-and-directx.md)

 

 




