---
description: Dieser Artikel beschreibt, wie UWP-XAML-Benutzeroberfläche in Ihrer desktop-Anwendung gehostet wird.
title: Unter Verwendung des UWP-XAML hosting-API in einer desktop-Anwendung
ms.date: 01/11/2019
ms.topic: article
keywords: Windows 10, Uwp, Windows Forms, Wpf, win32
ms.localizationpriority: medium
ms.openlocfilehash: ff5df91c860ab0e063f9a4ff5ed8beb64409e876
ms.sourcegitcommit: 9df81996628359ad6af4227339a2ce01c2d804e3
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/11/2019
ms.locfileid: "9001794"
---
# <a name="using-the-uwp-xaml-hosting-api-in-a-desktop-application"></a><span data-ttu-id="4ffbd-104">Unter Verwendung des UWP-XAML hosting-API in einer desktop-Anwendung</span><span class="sxs-lookup"><span data-stu-id="4ffbd-104">Using the UWP XAML hosting API in a desktop application</span></span>

> [!NOTE]
> <span data-ttu-id="4ffbd-105">Die UWP-XAML-hosting-API und XAML-Inseln sind als Entwicklervorschau verfügbar.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-105">The UWP XAML hosting API and XAML islands are currently available as a developer preview.</span></span> <span data-ttu-id="4ffbd-106">Obwohl wir Sie Sie diese in Ihrem eigenen Code Prototyp ausprobieren können, jetzt dazu ermutigen, wird nicht empfohlen, dass Sie sie zu diesem Zeitpunkt in Produktionscode verwenden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-106">Although we encourage you to try them out in your own prototype code now, we do not recommend that you use them in production code at this time.</span></span> <span data-ttu-id="4ffbd-107">Diese Features werden weiterhin breiter und Stabilisierung in zukünftigen Windows-Versionen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-107">These features will continue to mature and stabilize in future Windows releases.</span></span> <span data-ttu-id="4ffbd-108">Microsoft übernimmt keine Garantie, weder ausdrücklich noch stillschweigend, für die hier bereitgestellten Informationen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-108">Microsoft makes no warranties, express or implied, with respect to the information provided here.</span></span>
>
> <span data-ttu-id="4ffbd-109">Wenn Sie Feedback zur XAML-Inseln haben, erstellen Sie ein neues Problem in das [WindowsCommunityToolkit Repository](https://github.com/windows-toolkit/WindowsCommunityToolkit/issues) , und geben Sie Ihren Kommentar es.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-109">If you have feedback about XAML islands, create a new issue in the [WindowsCommunityToolkit repo](https://github.com/windows-toolkit/WindowsCommunityToolkit/issues) and leave your comments there.</span></span> <span data-ttu-id="4ffbd-110">Wenn Sie es vorziehen, Ihr Feedback privat zu übermitteln, können Sie es senden XamlIslandsFeedback@microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-110">If you prefer to submit your feedback privately, you can send it to XamlIslandsFeedback@microsoft.com.</span></span> <span data-ttu-id="4ffbd-111">Ihre Einblicke und Szenarien sind uns sehr wichtig.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-111">Your insights and scenarios are critically important to us.</span></span>

<span data-ttu-id="4ffbd-112">Ab Windows 10 Insider Preview SDK 17709 erstellen, die nicht-UWP-desktop-Apps (einschließlich WPF, Windows Forms und C++ Win32-Anwendungen) können Sie das *UWP-XAML hosting-API* zum Hosten von UWP-Steuerelementen in alle UI-Element, das ein Fenster-Handle (zugeordnet ist HWND).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-112">Starting in Windows 10 Insider Preview SDK build 17709, non-UWP desktop applications (including WPF, Windows Forms, and C++ Win32 applications) can use the *UWP XAML hosting API* to host UWP controls in any UI element that is associated with a window handle (HWND).</span></span> <span data-ttu-id="4ffbd-113">Mit dieser API können nicht-UWP-desktop-Apps mit den neuesten Windows 10-UI-Features, die nur über UWP-Steuerelemente verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-113">This API enables non-UWP desktop applications to use the latest Windows 10 UI features that are only available via UWP controls.</span></span> <span data-ttu-id="4ffbd-114">Beispielsweise können nicht-UWP-desktop-Apps diese API zum Hosten von UWP-Steuerelementen, die das [Fluent Design-Systems](../design/fluent-design-system/index.md) und [Windows Ink](../design/input/pen-and-stylus-interactions.md)unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-114">For example, non-UWP desktop applications can use this API to host UWP controls that use the [Fluent Design System](../design/fluent-design-system/index.md) and support [Windows Ink](../design/input/pen-and-stylus-interactions.md).</span></span>

<span data-ttu-id="4ffbd-115">Die UWP-XAML hosting-API bildet die Grundlage für eine breitere Gruppe von Steuerelementen, die wir bereit sind, zum Aktivieren der Entwickler Fluent-Benutzeroberfläche in nicht-UWP-desktop-Apps zu bringen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-115">The UWP XAML hosting API provides the foundation for a broader set of controls that we are providing to enable developers to bring Fluent UI to non-UWP desktop applications.</span></span> <span data-ttu-id="4ffbd-116">In diesem Szenario wird mitunter als *XAML-Inseln*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-116">This scenario is sometimes called *XAML islands*.</span></span> <span data-ttu-id="4ffbd-117">Weitere Informationen zu diesem Szenario Entwickler finden Sie in der [UWP-Steuerelemente in desktop-Apps](xaml-host-controls.md).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-117">For more details about this developer scenario, see [UWP controls in desktop applications](xaml-host-controls.md).</span></span>

## <a name="is-the-uwp-xaml-hosting-api-right-for-your-desktop-application"></a><span data-ttu-id="4ffbd-118">Ist die UWP-XAML API für Ihre desktop-Anwendung hosten?</span><span class="sxs-lookup"><span data-stu-id="4ffbd-118">Is the UWP XAML hosting API right for your desktop application?</span></span>

<span data-ttu-id="4ffbd-119">Die UWP-XAML hosting-API bietet die Low-Level-Infrastruktur für das Hosten von UWP-Steuerelemente in desktop-Apps.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-119">The UWP XAML hosting API provides the low-level infrastructure for hosting UWP controls in desktop applications.</span></span> <span data-ttu-id="4ffbd-120">Einige Arten von desktop-Apps können mit alternative und einfacher APIs können Sie um dies zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-120">Some types of desktop applications have the option of using alternative, more convenient APIs to accomplish this goal.</span></span>  

* <span data-ttu-id="4ffbd-121">Wenn Sie eine C++ Win32-desktop-Anwendung und Host-UWP-Steuerelemente in Ihrer Anwendung möchten, müssen Sie die UWP-XAML hosting-API verwenden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-121">If you have a C++ Win32 desktop application and you want to host UWP controls in your application, you must use the UWP XAML hosting API.</span></span> <span data-ttu-id="4ffbd-122">Es gibt keine alternativen für diese Arten von Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-122">There are no alternatives for these types of applications.</span></span>

* <span data-ttu-id="4ffbd-123">WPF- oder Windows Forms-Anwendung empfehlen wir, die [mit dem Steuerelemente](xaml-host-controls.md#wrapped-controls) und die [Host-Steuerelemente](xaml-host-controls.md#host-controls) in der Windows-Community-Toolkit anstelle der UWP-XAML verwenden, hosting-API.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-123">For WPF and Windows Forms applications, we recommend that you use the [wrapped controls](xaml-host-controls.md#wrapped-controls) and [host controls](xaml-host-controls.md#host-controls) in the Windows Community Toolkit instead of the UWP XAML hosting API.</span></span> <span data-ttu-id="4ffbd-124">Diese Steuerelemente verwenden, die UWP-XAML intern hosting-API und ein einfacher Development-Erlebnis zu bieten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-124">These controls use the UWP XAML hosting API internally and provide a simpler development experience.</span></span> <span data-ttu-id="4ffbd-125">Allerdings können Sie die UWP-XAML-API direkt in diese Arten von Anwendungen hosten, wenn Sie auswählen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-125">However, you can use the UWP XAML hosting API directly in these types of applications if you choose.</span></span>

## <a name="related-samples"></a><span data-ttu-id="4ffbd-126">Verwandte Beispiele</span><span class="sxs-lookup"><span data-stu-id="4ffbd-126">Related samples</span></span>

<span data-ttu-id="4ffbd-127">Wie Sie die UWP-XAML hosting-API in Ihrem Code verwenden, hängt von Ihrer Anwendungstyp, den Entwurf der Anwendung und anderen Faktoren.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-127">The way you use the UWP XAML hosting API in your code depends on your application type, the design of your application, and other factors.</span></span> <span data-ttu-id="4ffbd-128">Um zu veranschaulichen, wie Sie diese API im Kontext einer vollständigen Anwendung verwenden, bezieht sich in diesem Artikel auf Code aus den folgenden Beispielen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-128">To help illustrate how to use this API in the context of a complete application, this article refers to code from the following samples.</span></span>

### <a name="c-win32"></a><span data-ttu-id="4ffbd-129">C++ Win32</span><span class="sxs-lookup"><span data-stu-id="4ffbd-129">C++ Win32</span></span>

<span data-ttu-id="4ffbd-130">Es gibt mehrere Beispiele auf GitHub, die zeigen, wie Sie die UWP-XAML hosting-API in einer C++ Win32-Anwendung:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-130">There are several samples on GitHub that demonstrate how to use the UWP XAML hosting API in a C++ Win32 application:</span></span>

  * <span data-ttu-id="4ffbd-131">[XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-131">[XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting).</span></span> <span data-ttu-id="4ffbd-132">In diesem Beispiel wird veranschaulicht, wie die UWP [InkCanvas](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inkcanvas), [InkToolbar](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inktoolbar)und [MediaPlayerElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.mediaplayerelement) -Steuerelemente an eine C++ Win32-Anwendung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-132">This sample demonstrates how to add the UWP [InkCanvas](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inkcanvas), [InkToolbar](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inktoolbar), and [MediaPlayerElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.mediaplayerelement) controls to a C++ Win32 application.</span></span>
  * <span data-ttu-id="4ffbd-133">[XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-133">[XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32).</span></span> <span data-ttu-id="4ffbd-134">In diesem Beispiel wird veranschaulicht, wie eine C++ Win32-Anwendung mehrere grundlegende UWP-Steuerelemente hinzu, und Behandeln von Änderungen von DPI-Wert.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-134">This sample demonstrates how to add several basic UWP controls to a C++ Win32 application and handle DPI changes.</span></span>

### <a name="wpf-and-windows-forms"></a><span data-ttu-id="4ffbd-135">WPF und Windows Forms</span><span class="sxs-lookup"><span data-stu-id="4ffbd-135">WPF and Windows Forms</span></span>

<span data-ttu-id="4ffbd-136">Das Steuerelement [WindowsXamlHost](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) im Windows Community Toolkit fungiert als eine referenzbeispiel für die Verwendung der UWP hosting-API in WPF- oder Windows Forms-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-136">The [WindowsXamlHost](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) control in the Windows Community Toolkit acts as a reference sample for using the UWP hosting API in WPF and Windows Forms applications.</span></span> <span data-ttu-id="4ffbd-137">Der Quellcode ist an folgenden Orten verfügbar:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-137">The source code is available at the following locations:</span></span>

  * <span data-ttu-id="4ffbd-138">Für die WPF-Version des Steuerelements, [Wechseln Sie hier](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Wpf.UI.XamlHost).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-138">For the WPF version of the control, [go here](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Wpf.UI.XamlHost).</span></span> <span data-ttu-id="4ffbd-139">Die WPF-Version wird von [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-139">The WPF version derives from [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost).</span></span>
  * <span data-ttu-id="4ffbd-140">Für die Windows Forms-Version des Steuerelements, [Wechseln Sie hier](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Forms.UI.XamlHost).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-140">For the Windows Forms version of the control, [go here](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Forms.UI.XamlHost).</span></span> <span data-ttu-id="4ffbd-141">Windows Forms-Version von [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-141">The Windows Forms version derives from [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="4ffbd-142">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="4ffbd-142">Prerequisites</span></span>

<span data-ttu-id="4ffbd-143">Die UWP-XAML hosting-API hat diese erforderlichen Komponenten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-143">The UWP XAML hosting API has these prerequisites.</span></span>

* <span data-ttu-id="4ffbd-144">Windows 10 Insider Preview build 17709 (oder einen späteren Build) und den entsprechenden Insider Preview-Build des Windows SDKS.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-144">Windows 10 Insider Preview build 17709 (or a later build) and the corresponding Insider Preview build of the Windows SDK.</span></span> <span data-ttu-id="4ffbd-145">Da es sich um einen neuen Feature handelt, wird empfohlen für eine optimale Verwendung des neuesten Builds.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-145">Because this is an evolving feature, for the best experience we recommend using the latest available build.</span></span>

* <span data-ttu-id="4ffbd-146">Um die UWP-XAML hosting-API in Ihrer desktop-Anwendung zu verwenden, müssen Sie Ihr Projekt konfigurieren, sodass Sie UWP-APIs aufrufen können:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-146">To use the UWP XAML hosting API in your desktop application, you'll need to configure your project so you can call UWP APIs:</span></span>

    * <span data-ttu-id="4ffbd-147">**C++ Win32:** Es wird empfohlen, dass Sie das Projekt zur Verwendung konfigurieren [C++ / WinRT](../cpp-and-winrt-apis/index.md).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-147">**C++ Win32:** We recommend that you configure your project to use [C++/WinRT](../cpp-and-winrt-apis/index.md).</span></span> <span data-ttu-id="4ffbd-148">Herunterladen und Installieren der [C++ / WinRT Visual Studio Extension (VSIX)](https://aka.ms/cppwinrt/vsix) aus dem Visual Studio Marketplace und fügen Sie dann die ```<CppWinRTEnabled>true</CppWinRTEnabled>``` -Eigenschaft verwenden, um Ihre VCXPROJ-Datei als beschrieben [hier](../cpp-and-winrt-apis/intro-to-using-cpp-with-winrt.md#visual-studio-support-for-cwinrt-and-the-vsix).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-148">Download and install the [C++/WinRT Visual Studio Extension (VSIX)](https://aka.ms/cppwinrt/vsix) from the Visual Studio Marketplace and then add the ```<CppWinRTEnabled>true</CppWinRTEnabled>``` property to your .vcxproj file as described [here](../cpp-and-winrt-apis/intro-to-using-cpp-with-winrt.md#visual-studio-support-for-cwinrt-and-the-vsix).</span></span>

    * <span data-ttu-id="4ffbd-149">**Windows Forms und WPF:** [Gehen Sie wie folgt vor.](../porting/desktop-to-uwp-enhance.md)</span><span class="sxs-lookup"><span data-stu-id="4ffbd-149">**Windows Forms and WPF:** Follow [these instructions](../porting/desktop-to-uwp-enhance.md).</span></span>

## <a name="architecture-of-xaml-islands"></a><span data-ttu-id="4ffbd-150">Architektur der XAML-Inseln</span><span class="sxs-lookup"><span data-stu-id="4ffbd-150">Architecture of XAML islands</span></span>

<span data-ttu-id="4ffbd-151">Die UWP-XAML hosting-API enthält [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource), [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager)und andere verwandten Typen im Namespace [**Windows.UI.Xaml.Hosting**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting) .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-151">The UWP XAML hosting API includes [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource), [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager), and other related types in the [**Windows.UI.Xaml.Hosting**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting) namespace.</span></span> <span data-ttu-id="4ffbd-152">Desktop-Apps können diese API zum Rendern von UWP-Steuerelemente und Fokus-Navigation per Tastatur in und aus den Elementen weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-152">Desktop applications can use this API to render UWP controls and route keyboard focus navigation into and out of the elements.</span></span> <span data-ttu-id="4ffbd-153">Desktop-Apps können auch Größe und position von UWP-Steuerelemente nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-153">Desktop applications can also size and position the UWP controls as desired.</span></span>

<span data-ttu-id="4ffbd-154">Wenn Sie eine XAML-Insel unter Verwendung des XAML hosting-API in einer desktop-Anwendung erstellen, haben Sie die folgenden Hierarchie der Objekte:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-154">When you create a XAML island using the XAML hosting API in a desktop application, you will have the following hierarchy of objects:</span></span>

* <span data-ttu-id="4ffbd-155">Auf der Basisebene ist das UI-Element in der Anwendung, in dem Sie die XAML-Insel hosten möchten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-155">At the base level is the UI element in your application where you want to host the XAML island.</span></span> <span data-ttu-id="4ffbd-156">Dieses UI-Element muss einen Fensterhandle (HWND) verfügen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-156">This UI element must have a window handle (HWND).</span></span> <span data-ttu-id="4ffbd-157">Beispiele für UI-Elemente, in denen Sie eine XAML-Insel hosten können, sind [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) für WPF-Anwendung, [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) für Windows Forms-Anwendung, und ein [Fenster](https://docs.microsoft.com/windows/desktop/winmsg/about-windows) für C++ Win32-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-157">Examples of UI elements in which you can host a XAML island include [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) for WPF applications, [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) for Windows Forms applications, and a [window](https://docs.microsoft.com/windows/desktop/winmsg/about-windows) for C++ Win32 applications.</span></span>

* <span data-ttu-id="4ffbd-158">Die nächste ist Ebene ein **DesktopWindowXamlSource** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-158">At the next level is a **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="4ffbd-159">Dieses Objekt stellt die Infrastruktur für die XAML-Insel hosten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-159">This object provides the infrastructure for hosting the XAML island.</span></span> <span data-ttu-id="4ffbd-160">Der Code ist verantwortlich für das Erstellen dieses Objekts und diese an das übergeordnete UI-Element.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-160">Your code is responsible for creating this object and attaching it to the parent UI element.</span></span>

* <span data-ttu-id="4ffbd-161">Wenn Sie eine **DesktopWindowXamlSource**erstellen, erstellt dieses Objekt automatisch native untergeordnetes Fenster um Ihre UWP-Steuerelement zu hosten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-161">When you create a **DesktopWindowXamlSource**, this object automatically creates a native child window to host your UWP control.</span></span> <span data-ttu-id="4ffbd-162">Diese systemeigenen untergeordnetes Fenster hauptsächlich herausgenommen Code, aber Sie können das Handle (HWND) bei Bedarf zugreifen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-162">This native child window is mostly abstracted away from your code, but you can access its handle (HWND) if necessary.</span></span>

* <span data-ttu-id="4ffbd-163">Schließlich ist auf der obersten Ebene das UWP-Steuerelement, das Sie in Ihrer desktop-Anwendung hosten möchten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-163">Finally, at the top level is the UWP control you want to host in your desktop application.</span></span> <span data-ttu-id="4ffbd-164">Dies kann eine UWP-Objekt sein, die von [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement), z. B. alle UWP-Steuerelemente, die von Windows SDK als auch benutzerdefinierte Steuerelemente bereitgestellten abgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-164">This can be any UWP object that derives from [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement), including any UWP control provided by the Windows SDK as well as custom user controls.</span></span>

<span data-ttu-id="4ffbd-165">Das folgende Diagramm zeigt die Hierarchie der Objekte in einer XAML-Insel.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-165">The following diagram illustrates the hierarchy of objects in a XAML island.</span></span>

![DesktopWindowXamlSource-Architektur](images/xaml-hosting-api-rev2.png)

## <a name="how-to-host-uwp-xaml-controls"></a><span data-ttu-id="4ffbd-167">Informationen zum Hosten von UWP-XAML-Steuerelementen</span><span class="sxs-lookup"><span data-stu-id="4ffbd-167">How to host UWP XAML controls</span></span>

<span data-ttu-id="4ffbd-168">Hier sind die wichtigsten Schritte für die Verwendung der UWP-XAML hosting-API für ein UWP-Steuerelement in Ihrer Anwendung hosten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-168">Here are the main steps for using the UWP XAML hosting API to host a UWP control in your application.</span></span>

1. <span data-ttu-id="4ffbd-169">Initialisieren Sie das UWP-XAML-Framework für den aktuellen Thread, bevor Ihrer Anwendung erstellt die [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) -Objekte, die sie hostet, in der [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-169">Initialize the UWP XAML framework for the current thread before your application creates any of the [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) objects that it will host in the [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource).</span></span>

    * <span data-ttu-id="4ffbd-170">Wenn die Anwendung das **DesktopWindowXamlSource** -Objekt erstellt, bevor sie die Objekte **Windows.UI.Xaml.UIElement** erstellt, wird dieses Framework für Sie initialisiert werden, wenn Sie das **DesktopWindowXamlSource** -Objekt zu instanziieren .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-170">If your application creates the **DesktopWindowXamlSource** object before it creates any of the **Windows.UI.Xaml.UIElement** objects, this framework will be initialized for you when you instantiate the **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="4ffbd-171">In diesem Szenario müssen Sie nicht selbst initialisieren Sie das Framework Code hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-171">In this scenario, you don't need to add any code of your own to initialize the framework.</span></span>

    * <span data-ttu-id="4ffbd-172">Jedoch, wenn die Anwendung die **Windows.UI.Xaml.UIElement** Objekte erstellt, bevor sie das **DesktopWindowXamlSource** -Objekt erstellt, das sie hostet, muss die Anwendung die statische [**aufrufen WindowsXamlManager.InitializeForCurrentThread**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread) Methode, um die UWP-XAML-Framework explizit initialisieren, bevor die **Windows.UI.Xaml.UIElement** Objekte instanziiert werden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-172">However, if your application creates the **Windows.UI.Xaml.UIElement** objects before it creates the **DesktopWindowXamlSource** object that will host them, your application must call the static [**WindowsXamlManager.InitializeForCurrentThread**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread) method to explicitly initialize the UWP XAML framework before the **Windows.UI.Xaml.UIElement** objects are instantiated.</span></span> <span data-ttu-id="4ffbd-173">Ihre Anwendung sollte diese Methode in der Regel aufrufen, wenn das übergeordnete UI-Element, das die **DesktopWindowXamlSource** hostet instanziiert wird.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-173">Your application should typically call this method when the parent UI element that hosts the **DesktopWindowXamlSource** is instantiated.</span></span>

    ```cppwinrt
    Windows::UI::Xaml::Hosting::WindowsXamlManager windowsXamlManager =
        Windows::UI::Xaml::Hosting::WindowsXamlManager::InitializeForCurrentThread();
    ```

    ```csharp
    global::Windows.UI.Xaml.Hosting.WindowsXamlManager windowsXamlManager =
        global::Windows.UI.Xaml.Hosting.WindowsXamlManager.InitializeForCurrentThread();
    ```

    > [!NOTE]
    > <span data-ttu-id="4ffbd-174">Diese Methode gibt ein [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) -Objekt, das einen Verweis auf das UWP-XAML-Framework enthält.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-174">This method returns a [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) object that contains a reference to the UWP XAML framework.</span></span> <span data-ttu-id="4ffbd-175">Sie können beliebig viele **WindowsXamlManager** Objekte in einem bestimmten Thread soll erstellen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-175">You can create as many **WindowsXamlManager** objects as you want on a given thread.</span></span> <span data-ttu-id="4ffbd-176">Jedoch, da jedes Objekt einen Verweis auf das UWP-XAML-Framework enthält, sollten Sie freigeben der Objekte, um sicherzustellen, dass XAML-Ressourcen schließlich freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-176">However, because each object holds a reference to the UWP XAML framework, you should dispose the objects to ensure that XAML resources are eventually released.</span></span>

2. <span data-ttu-id="4ffbd-177">Erstellen Sie ein [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) -Objekt, und schließen Sie es an übergeordnete UI-Elemente in der Anwendung, die ein Fensterhandle zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-177">Create a [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) object and attach it to a parent UI element in your application that is associated with a window handle.</span></span>

    <span data-ttu-id="4ffbd-178">Zu diesem Zweck müssen Sie die folgenden Schritte:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-178">To do this, you'll need to follow these steps:</span></span>

    1. <span data-ttu-id="4ffbd-179">Erstellen Sie ein **DesktopWindowXamlSource** -Objekt, und wandeln sie in der **IDesktopWindowXamlSourceNative** COM-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-179">Create a **DesktopWindowXamlSource** object and cast it to the **IDesktopWindowXamlSourceNative** COM interface.</span></span> <span data-ttu-id="4ffbd-180">Diese Schnittstelle wird deklariert, der ```windows.ui.xaml.hosting.desktopwindowxamlsource.h``` im Windows SDK-Header-Datei.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-180">This interface is declared in the ```windows.ui.xaml.hosting.desktopwindowxamlsource.h``` header file in the Windows SDK.</span></span> <span data-ttu-id="4ffbd-181">In C++ Win32-Projekt können Sie diese Headerdatei direkt verweisen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-181">In a C++ Win32 project, you can reference this header file directly.</span></span> <span data-ttu-id="4ffbd-182">In einem WPF- oder Windows Forms-Projekt müssen Sie diese Schnittstelle im Code Ihrer Anwendung, die mit dem [**ComImport**](https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.comimportattribute) -Attribut zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-182">In a WPF or Windows Forms project, you'll need to declare this interface in your application code using the [**ComImport**](https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.comimportattribute) attribute.</span></span> <span data-ttu-id="4ffbd-183">Stellen Sie sicher, Ihre Benutzeroberfläche Deklaration entspricht genau die Schnittstellendeklaration im ```windows.ui.xaml.hosting.desktopwindowxamlsource.h```.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-183">Make sure your interface declaration exactly matches the interface declaration in ```windows.ui.xaml.hosting.desktopwindowxamlsource.h```.</span></span>

    2. <span data-ttu-id="4ffbd-184">Rufen Sie die Methode **AttachToWindow** der **IDesktopWindowXamlSourceNative** -Schnittstelle, und übergeben Sie das Fenster-Handle für das übergeordnete UI-Element in der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-184">Call the **AttachToWindow** method of the **IDesktopWindowXamlSourceNative** interface, and pass in the window handle of the parent UI element in your application.</span></span>

    3. <span data-ttu-id="4ffbd-185">Legen Sie die ursprüngliche Größe des Fensters interne untergeordnetes Element in der **DesktopWindowXamlSource**enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-185">Set the initial size of the internal child window contained in the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="4ffbd-186">Standardmäßig wird diese interne untergeordnetes Fenster auf eine Breite und Höhe von 0 festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-186">By default, this internal child window is set to a width and height of 0.</span></span> <span data-ttu-id="4ffbd-187">Wenn Sie die Größe des Fensters nicht festlegen, werden alle UWP-Steuerelemente, die Sie, um die **DesktopWindowXamlSource hinzufügen** nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-187">If you don't set the size of the window, any UWP controls you add to the **DesktopWindowXamlSource** will not be visible.</span></span> <span data-ttu-id="4ffbd-188">Verwenden Sie den Zugriff auf das interne untergeordnete Fenster in der **DesktopWindowXamlSource** **WindowHandle** -Eigenschaft der **IDesktopWindowXamlSourceNative** -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-188">To access the internal child window in the **DesktopWindowXamlSource**, use the **WindowHandle** property of the **IDesktopWindowXamlSourceNative** interface.</span></span> <span data-ttu-id="4ffbd-189">Die folgenden Beispiele verwenden die [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) -Funktion, um die Größe des Fensters festzulegen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-189">The following examples use the [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to set the size of the window.</span></span>

    <span data-ttu-id="4ffbd-190">Hier sind einige Codebeispiele, die diesen Prozess zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-190">Here are some code examples that demonstrate this process.</span></span>

    ```cppwinrt
    // This example assumes you already have an HWND variable named 'parentHwnd' that
    // contains the handle of the parent window.
    Windows::UI::Xaml::Hosting::DesktopWindowXamlSource desktopWindowXamlSource;
    auto interop = desktopWindowXamlSource.as<IDesktopWindowXamlSourceNative>();
    check_hresult(interop->AttachToWindow(parentHwnd));

    HWND childInteropHwnd = nullptr;
    interop->get_WindowHandle(&childInteropHwnd);

    SetWindowPos(childInteropHwnd, 0, 0, 0, 300, 300, SWP_SHOWWINDOW);
    ```

    ```csharp
    // This WPF example assumes you already have an HwndHost named 'parentHwndHost'
    // that will act as the parent UI elemnt for your XAML island. It also assumes
    // you have used the DllImport attribute to import SetWindowPos from user32.dll
    // as a static method into a class named NativeMethods.
    Windows.UI.Xaml.Hosting.DesktopWindowXamlSource desktopWindowXamlSource =
        new Windows.UI.Xaml.Hosting.DesktopWindowXamlSource();

    IntPtr iUnknownPtr = System.Runtime.InteropServices.Marshal.GetIUnknownForObject(
        desktopWindowXamlSource);
    IDesktopWindowXamlSourceNative desktopWindowXamlSourceNative =
        System.Runtime.InteropServices.Marshal.Marshal.GetTypedObjectForIUnknown(
            iUnknownPtr, typeof(IDesktopWindowXamlSourceNative))
            as IDesktopWindowXamlSourceNative;

    desktopWindowXamlSourceNative.AttachToWindow(parentHwndHost.Handle);

    var childInteropHwnd = desktopWindowXamlSourceNative.WindowHandle;
    NativeMethods.SetWindowPos(childInteropHwnd, HWND_TOP, 0, 0, 300, 300, SWP_SHOWWINDOW);
    ```

3. <span data-ttu-id="4ffbd-191">Legen Sie die **Windows.UI.Xaml.UIElement** , die Sie für die [**Content**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content) -Eigenschaft des Objekts **DesktopWindowXamlSource** hosten möchten.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-191">Set the **Windows.UI.Xaml.UIElement** you want to host to the [**Content**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content) property of your **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="4ffbd-192">Im folgenden Beispiel wird ein [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) mit dem Namen ```myGrid``` um die **Content** -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-192">The following example sets a [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) named ```myGrid``` to the **Content** property.</span></span>

   ```cppwinrt
   desktopWindowXamlSource.Content(myGrid);
   ```

   ```csharp
   desktopWindowXamlSource.Content = myGrid;
   ```

<span data-ttu-id="4ffbd-193">Vollständige Beispiele, die veranschaulichen diese Aufgaben im Kontext einer Beispiel-Anwendung arbeiten, finden Sie unter den folgenden Codedateien:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-193">For complete examples that demonstrate these tasks in the context of a working sample application, see the following code files:</span></span>

  * <span data-ttu-id="4ffbd-194">**C++ Win32:** Finden Sie in der Datei ["Main.cpp"](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting/blob/master/XamlHostingSample/Main.cpp) im Beispiel [XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting) oder [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) -Datei im Beispiel [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-194">**C++ Win32:** See the [Main.cpp](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting/blob/master/XamlHostingSample/Main.cpp) file in the [XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting) sample or the [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) file in the [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) sample.</span></span>
  * <span data-ttu-id="4ffbd-195">**WPF:** Die Dateien [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.cs) und [WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHost.cs) im Windows Community Toolkit wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-195">**WPF:** See the [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.cs) and  [WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHost.cs) files in the Windows Community Toolkit.</span></span>  
  * <span data-ttu-id="4ffbd-196">**Windows Forms:** Die Dateien [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.cs) und [WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHost.cs) im Windows Community Toolkit wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-196">**Windows Forms:** See the [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.cs) and  [WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHost.cs) files in the Windows Community Toolkit.</span></span>


## <a name="how-to-host-custom-uwp-xaml-controls"></a><span data-ttu-id="4ffbd-197">Wie mit benutzerdefinierten Host UWP XAML-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="4ffbd-197">How to host custom UWP XAML controls</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4ffbd-198">3. Parteien benutzerdefinierte UWP-XAML-Steuerelemente werden derzeit nur in C#-WPF- oder Windows Forms-Anwendung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-198">Currently, custom UWP XAML controls from 3rd parties are only supported in C# WPF and Windows Forms applications.</span></span> <span data-ttu-id="4ffbd-199">Sie müssen den Quellcode für die Steuerelemente verfügen, damit Sie ihn in Ihrer Anwendung kompilieren können.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-199">You must have the source code for the controls so you can compile against it in your application.</span></span>

<span data-ttu-id="4ffbd-200">Wenn Sie ein benutzerdefiniertes UWP-XAML-Steuerelement (ein Steuerelement, das Sie selbst definieren oder ein Steuerelement von bereitgestellt, die eine 3rd party) hosten möchten, müssen Sie die folgenden zusätzlichen Aufgaben zusätzlich zu den im [vorherigen Abschnitt](#how-to-host-uwp-xaml-controls)beschriebene Verfahren ausführen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-200">If you want to host a custom UWP XAML control (either a control you define yourself or a control provided by a 3rd party), you must perform the following additional tasks in addition to the process described in the [previous section](#how-to-host-uwp-xaml-controls).</span></span>

1. <span data-ttu-id="4ffbd-201">Definieren Sie einen benutzerdefinierten Typ, der von [**Windows.UI.Xaml.Application**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application) abgeleitet wird, und auch [**IXamlMetadataProvider**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider)implementiert.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-201">Define a custom type that derives from [**Windows.UI.Xaml.Application**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application) and also implements [**IXamlMetadataProvider**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider).</span></span> <span data-ttu-id="4ffbd-202">Diese Art fungiert als Stamm Metadatenanbieter zum Laden von Metadaten für benutzerdefinierte UWP-XAML-Typen in Assemblys im aktuellen Verzeichnis der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-202">This type acts as a root metadata provider for loading metadata for custom UWP XAML types in assemblies in the current directory of your application.</span></span>

    <span data-ttu-id="4ffbd-203">Ein Beispiel, das veranschaulicht, wie Sie dies tun, finden Sie in der Codedatei [XamlApplication.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/XamlApplication.cs) im Windows Community Toolkit.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-203">For an example that demonstrates how to do this, see the [XamlApplication.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/XamlApplication.cs) code file in the Windows Community Toolkit.</span></span> <span data-ttu-id="4ffbd-204">Diese Datei ist Teil der gemeinsam genutzte Implementierung der **WindowsXamlHost** Klassen für WPF und Windows Forms, das verdeutlichen, wie Sie die UWP-XAML hosting-API in diese Arten von apps verwenden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-204">This file is part of the shared implementation of the **WindowsXamlHost** classes for WPF and Windows Forms, which help illustrate how to use the UWP XAML hosting API in those types of apps.</span></span>

2. <span data-ttu-id="4ffbd-205">Rufen Sie die [**GetXamlType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider.getxamltype) -Methode des Anbieters Metadaten Stamm, wenn der Typname des UWP-XAML-Steuerelements zugeordnet ist (Dies kann zur Laufzeit im Code zugewiesen werden oder Sie können diese im Eigenschaftenfenster von Visual Studio zugewiesen werden können).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-205">Call the [**GetXamlType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider.getxamltype) method of your root metadata provider when the type name of the UWP XAML control is assigned (this could be assigned in code at run time, or you might choose to enable this to be assigned in the Visual Studio Properties window).</span></span>

    <span data-ttu-id="4ffbd-206">Ein Beispiel, das veranschaulicht, wie Sie dies tun, finden Sie in der Codedatei [UWPTypeFactory.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/UWPTypeFactory.cs) im Windows Community Toolkit.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-206">For an example that demonstrates how to do this, see the [UWPTypeFactory.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/UWPTypeFactory.cs) code file in the Windows Community Toolkit.</span></span> <span data-ttu-id="4ffbd-207">Diese Datei ist Teil der gemeinsam genutzte Implementierung der **WindowsXamlHost** Klassen für WPF und Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-207">This file is part of the shared implementation of the **WindowsXamlHost** classes for WPF and Windows Forms.</span></span>

3. <span data-ttu-id="4ffbd-208">Integrieren Sie den Quellcode für das benutzerdefinierte UWP-XAML-Steuerelement in Ihrer Projektmappe der Host-Anwendung, erstellen Sie das benutzerdefinierte Steuerelement, und verwenden sie in Ihrer Anwendung, indem Sie folgenden [diese Anweisungen](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost#add-a-custom-uwp-control).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-208">Integrate the source code for the custom UWP XAML control into your host application solution, build the custom control, and use it in your application by following [these instructions](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost#add-a-custom-uwp-control).</span></span>

## <a name="how-to-handle-keyboard-focus-navigation"></a><span data-ttu-id="4ffbd-209">So behandeln Sie den Tastaturfokus</span><span class="sxs-lookup"><span data-stu-id="4ffbd-209">How to handle keyboard focus navigation</span></span>

<span data-ttu-id="4ffbd-210">Wenn der Benutzer über die UI-Elemente in Ihrer Anwendung über die Tastatur (z. B. durch Drücken der **Tab** -Taste oder Richtung-Taste Schlüssel) navigiert, müssen Sie programmgesteuert verlagern des Fokus in und aus dem **DesktopWindowXamlSource** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-210">When the user navigates through the UI elements in your application using the keyboard (for example, by pressing **Tab** or direction/arrow key), you'll need to programmatically move focus into and out of the **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="4ffbd-211">Navigation mithilfe der Tastatur des Benutzers erreicht die **DesktopWindowXamlSource**, verschieben den Fokus in das erste [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) -Objekt in der Navigationsreihenfolge für Ihre Benutzeroberfläche weiterhin Fokus auf die folgenden \*\* Windows.UI.Xaml.UIElement\*\* Objekte als der Benutzer die Elemente, und verschieben den Fokus zurück aus der **DesktopWindowXamlSource** und in das übergeordnete Element der Benutzeroberfläche angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-211">When the user's keyboard navigation reaches the **DesktopWindowXamlSource**, move focus into the first [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) object in the navigation order for your UI, continue to move focus to the following **Windows.UI.Xaml.UIElement** objects as the user cycles through the elements, and then move focus back out of the **DesktopWindowXamlSource** and into the parent UI element.</span></span>  

<span data-ttu-id="4ffbd-212">Die UWP-XAML hosting-API bietet verschiedene Typen und Member, die Sie für diese Aufgaben unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-212">The UWP XAML hosting API provides several types and members to help you accomplish these tasks.</span></span>

1. <span data-ttu-id="4ffbd-213">Wenn die Tastaturnavigation Ihre **DesktopWindowXamlSource**eingibt, wird das [**GotFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.gotfocus) -Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-213">When the keyboard navigation enters your **DesktopWindowXamlSource**, the [**GotFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.gotfocus) event is raised.</span></span> <span data-ttu-id="4ffbd-214">Behandeln Sie dieses Ereignis und programmgesteuert verlagern Sie des Fokus auf das erste gehosteten **Windows.UI.Xaml.UIElement** mithilfe der [**NavigateFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.navigatefocus) -Methode.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-214">Handle this event and programmatically move focus to the first hosted **Windows.UI.Xaml.UIElement** by using the [**NavigateFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.navigatefocus) method.</span></span>

2. <span data-ttu-id="4ffbd-215">Wenn der Benutzer auf das letzte fokussierbare Element in der **DesktopWindowXamlSource** ist und die **Tab** -Taste oder eine Pfeiltaste drückt, wird das [**TakeFocusRequested**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.takefocusrequested) -Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-215">When the user is on the last focusable element in your **DesktopWindowXamlSource** and presses the **Tab** key or an arrow key, the [**TakeFocusRequested**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.takefocusrequested) event is raised.</span></span> <span data-ttu-id="4ffbd-216">Behandeln Sie dieses Ereignis und verlagern Sie des Fokus programmgesteuert auf das nächste fokussierbare Element in der Host-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-216">Handle this event and programmatically move focus to the next focusable element in the host application.</span></span> <span data-ttu-id="4ffbd-217">In einer WPF-Anwendung, die **DesktopWindowXamlSource** in einem [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)gehostet wird, können Sie z. B. die [**MoveFocus**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.movefocus) -Methode verwenden, übertragen Sie den Fokus auf das nächste fokussierbare Element in der Host-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-217">For example, in a WPF application where the **DesktopWindowXamlSource** is hosted in a [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost), you can use the [**MoveFocus**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.movefocus) method to transfer focus to the next focusable element in the host application.</span></span>

<span data-ttu-id="4ffbd-218">Beispiele hierzu im Kontext einer Beispiel-Anwendung arbeiten, finden Sie unter den folgenden Codedateien:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-218">For examples that demonstrate how to do this in the context of a working sample application, see the following code files:</span></span>
  * <span data-ttu-id="4ffbd-219">**WPF:** Finden Sie im Windows Community Toolkit [WindowsXamlHostBase.Focus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs) .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-219">**WPF:** See the [WindowsXamlHostBase.Focus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs) file in the Windows Community Toolkit.</span></span>  
  * <span data-ttu-id="4ffbd-220">**Windows Forms:** Finden Sie im Windows Community Toolkit [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs) .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-220">**Windows Forms:** See the [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs) file in the Windows Community Toolkit.</span></span>

## <a name="how-to-handle-layout-changes"></a><span data-ttu-id="4ffbd-221">So behandeln Sie Layout zu ändern</span><span class="sxs-lookup"><span data-stu-id="4ffbd-221">How to handle layout changes</span></span>

<span data-ttu-id="4ffbd-222">Wenn der Benutzer die Größe des übergeordneten UI-Elements ändert, müssen Sie zum Behandeln von layoutänderungen erforderlich, um sicherzustellen, Ihre UWP-Steuerelemente, die zeigen, wie erwartet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-222">When the user changes the size of the parent UI element, you'll need to handle any necessary layout changes to make sure your UWP controls display as you expect.</span></span> <span data-ttu-id="4ffbd-223">Hier sind einige wichtigen Szenarien zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-223">Here are some important scenarios to consider.</span></span>

1. <span data-ttu-id="4ffbd-224">Wenn das übergeordnete Element der Benutzeroberfläche muss die Größe der rechteckigen Bereich benötigt, um die **Windows.UI.Xaml.UIElement** passen, die Sie auf die **DesktopWindowXamlSource**hosten, rufen Sie die [**Measure**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.measure) -Methode für die \*\*Windows.UI.Xaml.UIElement \*\*.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-224">When the parent UI element needs to get the size of the rectangular area needed to fit the **Windows.UI.Xaml.UIElement** that you are hosting on the **DesktopWindowXamlSource**, call the [**Measure**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.measure) method of the **Windows.UI.Xaml.UIElement**.</span></span> <span data-ttu-id="4ffbd-225">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-225">For example:</span></span>
    * <span data-ttu-id="4ffbd-226">In einer WPF-Anwendung können Sie die [**MeasureOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride) -Methode des die [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) dazu, die die **DesktopWindowXamlSource**hostet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-226">In a WPF application you might do this from the [**MeasureOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride) method of the [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) that hosts the **DesktopWindowXamlSource**.</span></span>
    * <span data-ttu-id="4ffbd-227">In einer Windows Forms-Anwendung können Sie die [**GetPreferredSize**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.getpreferredsize) -Methode des [**Steuerelements**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) dazu, die die **DesktopWindowXamlSource**hostet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-227">In a Windows Forms application you might do this from the [**GetPreferredSize**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.getpreferredsize) method of the [**Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) that hosts the **DesktopWindowXamlSource**.</span></span>

2. <span data-ttu-id="4ffbd-228">Wenn die Größe des übergeordneten UI-Element wird, rufen Sie die Methode [**Anordnen**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.arrange) der Stamm- **Windows.UI.Xaml.UIElement** , die hosten Sie auf die **DesktopWindowXamlSource**.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-228">When the size of the parent UI element changes, call the [**Arrange**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.arrange) method of the root **Windows.UI.Xaml.UIElement** that you are hosting on the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="4ffbd-229">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-229">For example:</span></span>
    * <span data-ttu-id="4ffbd-230">In einer WPF-Anwendung können Sie die [**ArrangeOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride) -Methode des Objekts [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) dazu, die die **DesktopWindowXamlSource**hostet.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-230">In a WPF application you might do this from the [**ArrangeOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride) method of the [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) object that hosts the **DesktopWindowXamlSource**.</span></span>
    * <span data-ttu-id="4ffbd-231">In einer Windows Forms-Anwendung können Sie die Handler für das [**SizeChanged**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.sizechanged) -Ereignis des [**Steuerelements**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) , die hostet die **DesktopWindowXamlSource**dazu.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-231">In a Windows Forms application you might do this from the handler for the [**SizeChanged**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.sizechanged) event of the [**Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) that hosts the **DesktopWindowXamlSource**.</span></span>

<span data-ttu-id="4ffbd-232">Beispiele hierzu im Kontext einer Beispiel-Anwendung arbeiten, finden Sie unter den folgenden Codedateien:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-232">For examples that demonstrate how to do this in the context of a working sample application, see the following code files:</span></span>
  * <span data-ttu-id="4ffbd-233">**WPF:** Finden Sie im Windows Community Toolkit [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-233">**WPF:** See the [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>  
  * <span data-ttu-id="4ffbd-234">**Windows Forms:** Finden Sie im Windows Community Toolkit [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) .</span><span class="sxs-lookup"><span data-stu-id="4ffbd-234">**Windows Forms:** See the [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>

## <a name="how-to-handle-dpi-changes"></a><span data-ttu-id="4ffbd-235">So behandeln Sie DPI-Änderungen</span><span class="sxs-lookup"><span data-stu-id="4ffbd-235">How to handle DPI changes</span></span>

<span data-ttu-id="4ffbd-236">Wenn Sie DPI-Änderungen im Fenster behandeln, die Ihre UWP steuern (z. B., wenn der Benutzer das Fenster zwischen Bildschirmen mit unterschiedlichen Bildschirm DPI-Wert zieht) hostet möchten, müssen Sie zum Konfigurieren von UWP-Steuerelement mit einem Rendertransformation, Lauschen DPI-Änderungen in Ihrer app , und aktualisieren Sie die Position des Fensters und Transformation des UWP-Steuerelements in Reaktion auf die DPI-Änderungen zu rendern.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-236">If you want to handle DPI changes in the window that hosts your UWP control (for example, if the user drags the window between monitors with different screen DPI), you'll need to configure the UWP control with a render transform, listen for DPI changes in your app, and update the window position and render transform of the UWP control in response to the DPI changes.</span></span>

<span data-ttu-id="4ffbd-237">Die folgenden Schritte veranschaulichen eine Möglichkeit zur Behandlung von dieser Vorgang im Kontext einer C++ Win32-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-237">The following steps illustrate one way to handle this process in the context of a C++ Win32 application.</span></span> <span data-ttu-id="4ffbd-238">Ein vollständiges Beispiel finden Sie unter den Codedateien [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) und [Desktop.h](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.h) im [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) -Beispiel auf GitHub.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-238">For a complete example, see the [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) and [Desktop.h](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.h) code files in the [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) sample on GitHub.</span></span>

1. <span data-ttu-id="4ffbd-239">Verwalten Sie ein Objekt [**ScaleTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.media.scaletransform) in Ihrer app, und weisen Sie sie an die Methode [**RenderTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.rendertransform) von Ihrer UWP-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-239">Maintain a [**ScaleTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.media.scaletransform) object in your app and assign it to the [**RenderTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.rendertransform) method of your UWP control.</span></span> <span data-ttu-id="4ffbd-240">Im folgende Beispiel wird für ein Steuerelement [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) in einer C++ Win32-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-240">The following example does this for a [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) control in a C++ Win32 application.</span></span>

    ```cppwinrt
    // Private fields maintained by your app, such as in a window class you have defined.
    Windows::UI::Xaml::Media::ScaleTransform m_scale;
    Windows::UI::Xaml::Controls::Grid m_rootGrid;

    // Code that runs during initialization, such as the constructor for a window class you have defined.
    m_rootGrid.RenderTransform(m_scale);
    ```

2. <span data-ttu-id="4ffbd-241">Achten Sie in Ihrer Funktion [**WindowProc**](https://msdn.microsoft.com/library/windows/desktop/ms633573.aspx) auf die [**WM_DPICHANGED**](https://docs.microsoft.com/windows/desktop/hidpi/wm-dpichanged) Nachricht.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-241">In your [**WindowProc**](https://msdn.microsoft.com/library/windows/desktop/ms633573.aspx) function, listen for the [**WM_DPICHANGED**](https://docs.microsoft.com/windows/desktop/hidpi/wm-dpichanged) message.</span></span> <span data-ttu-id="4ffbd-242">In Reaktion auf diese Meldung:</span><span class="sxs-lookup"><span data-stu-id="4ffbd-242">In response to this message:</span></span>
    * <span data-ttu-id="4ffbd-243">Verwenden Sie die Funktion [**SetWindowPos**](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) , Größe des Fensters, das die UWP-Steuerelement an das Rechteck an Sie übergebenen enthält.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-243">Use the [**SetWindowPos**](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to resize the window that contains the UWP control to the rectangle passed to the message.</span></span>
    * <span data-ttu-id="4ffbd-244">Aktualisieren Sie die Skalierungsfaktoren x- und y-Achse des Objekts **ScaleTransform** gemäß der neue DPI-Wert.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-244">Update the x-axis and y-axis scale factors of your **ScaleTransform** object according to the new DPI value.</span></span>
    * <span data-ttu-id="4ffbd-245">Nehmen Sie alle erforderlichen Anpassungen vor, um die Darstellung und das Layout von Ihrer UWP-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-245">Make any necessary adjustments to the appearance and layout of your UWP control.</span></span> <span data-ttu-id="4ffbd-246">Im folgenden Codebeispiel wird passt [**Padding**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid.padding) des gehosteten **Windows.UI.Xaml.Controls.Grid** Steuerelements in Reaktion auf Änderungen der DPI-Wert.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-246">The following code example adjusts the [**Padding**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid.padding) of the hosted **Windows.UI.Xaml.Controls.Grid** control in response to DPI changes.</span></span>

    ```cppwinrt
    LRESULT HandleDpiChange(HWND hWnd, WPARAM wParam, LPARAM lParam)
    {
        HWND hWndStatic = GetWindow(hWnd, GW_CHILD);
        if (hWndStatic != nullptr)
        {
            UINT uDpi = HIWORD(wParam);

            // Resize the window
            auto lprcNewScale = reinterpret_cast<RECT*>(lParam);

            SetWindowPos(hWnd, nullptr, lprcNewScale->left, lprcNewScale->top,
                lprcNewScale->right - lprcNewScale->left, lprcNewScale->bottom - lprcNewScale->top,
                SWP_NOZORDER | SWP_NOACTIVATE);

            NewScale(uDpi);
          }
          return 0;
    }

    void NewScale(UINT dpi) {

        auto scaleFactor = (float)dpi / 100;

        if (m_scale != nullptr) {
            m_scale.ScaleX(scaleFactor);
            m_scale.ScaleY(scaleFactor);
        }

        ApplyCorrection(scaleFactor);
    }

    void ApplyCorrection(float scaleFactor) {
        float rightCorrection = (m_rootGrid.Width() * scaleFactor - m_rootGrid.Width()) / scaleFactor;
        float bottomCorrection = (m_rootGrid.Height() * scaleFactor - m_rootGrid.Height()) / scaleFactor;

        m_rootGrid.Padding(Windows::UI::Xaml::ThicknessHelper::FromLengths(0, 0, rightCorrection, bottomCorrection));
    }
    ```

2. <span data-ttu-id="4ffbd-247">Zum Konfigurieren Ihrer Anwendungs, darauf zu achten pro-Monitor-DPI-Wert zu Ihrem Projekt hinzufügen einer [parallelen Assembly-manifest](https://docs.microsoft.com/windows/desktop/SbsCs/application-manifests) , und legen Sie ```<dpiAwareness>``` Element ```PerMonitorV2```.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-247">To configure your application to be per-monitor DPI aware, add a [side-by-side assembly manifest](https://docs.microsoft.com/windows/desktop/SbsCs/application-manifests) to your project and set ```<dpiAwareness>``` element to ```PerMonitorV2```.</span></span> <span data-ttu-id="4ffbd-248">Weitere Informationen zu diesen Wert finden Sie in der Beschreibung der [**DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2**](https://docs.microsoft.com/windows/desktop/hidpi/dpi-awareness-context).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-248">For more information about this value, see the description for [**DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2**](https://docs.microsoft.com/windows/desktop/hidpi/dpi-awareness-context).</span></span>

    ```xml
    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
        <application xmlns="urn:schemas-microsoft-com:asm.v3">
            <windowsSettings>
                <dpiAwareness xmlns="http://schemas.microsoft.com/SMI/2016/WindowsSettings">PerMonitorV2</dpiAwareness>
            </windowsSettings>
        </application>
    </assembly>
    ```

    <span data-ttu-id="4ffbd-249">Ein vollständiges Beispiel Side-by-Side-Assembly-Manifest finden Sie in der Datei [XamlIslandsWin32.exe.manifest](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/XamlIslandsWin32.exe.manifest) im [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) -Beispiel auf GitHub.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-249">For a complete example side-by-side assembly manifest, see the [XamlIslandsWin32.exe.manifest](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/XamlIslandsWin32.exe.manifest) file in the [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) sample on GitHub.</span></span>

## <a name="limitations"></a><span data-ttu-id="4ffbd-250">Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="4ffbd-250">Limitations</span></span>

<span data-ttu-id="4ffbd-251">Der XAML-Code hosting-API verwenden dieselben Einschränkungen wie alle anderen Typen von XAML-Steuerelemente für Windows 10.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-251">The XAML hosting API shares the same limitations as all other types of XAML host controls for Windows 10.</span></span> <span data-ttu-id="4ffbd-252">Eine detaillierte Liste finden Sie in der [XAML-Host-Steuerelement Einschränkungen](xaml-host-controls.md#limitations).</span><span class="sxs-lookup"><span data-stu-id="4ffbd-252">For a detailed list, see [XAML host control limitations](xaml-host-controls.md#limitations).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="4ffbd-253">Fehlerbehebung</span><span class="sxs-lookup"><span data-stu-id="4ffbd-253">Troubleshooting</span></span>

### <a name="error-using-uwp-xaml-hosting-api-in-a-uwp-app"></a><span data-ttu-id="4ffbd-254">Fehler bei der Verwendung von UWP-XAML hosting-API in einer UWP-app</span><span class="sxs-lookup"><span data-stu-id="4ffbd-254">Error using UWP XAML hosting API in a UWP app</span></span>

| <span data-ttu-id="4ffbd-255">Problem</span><span class="sxs-lookup"><span data-stu-id="4ffbd-255">Issue</span></span> | <span data-ttu-id="4ffbd-256">Auflösung</span><span class="sxs-lookup"><span data-stu-id="4ffbd-256">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="4ffbd-257">Ihre app erhält eine **COMException** mit folgender Meldung: "DesktopWindowXamlSource kann nicht aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-257">Your app receives a **COMException** with the following message: "Cannot activate DesktopWindowXamlSource.</span></span> <span data-ttu-id="4ffbd-258">Dieser Typ kann nicht in einer UWP-app verwendet werden."</span><span class="sxs-lookup"><span data-stu-id="4ffbd-258">This type cannot be used in a UWP app."</span></span> <span data-ttu-id="4ffbd-259">oder "WindowsXamlManager kann nicht aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-259">or "Cannot activate WindowsXamlManager.</span></span> <span data-ttu-id="4ffbd-260">Dieser Typ kann nicht in einer UWP-app verwendet werden."</span><span class="sxs-lookup"><span data-stu-id="4ffbd-260">This type cannot be used in a UWP app."</span></span> | <span data-ttu-id="4ffbd-261">Dieser Fehler weist darauf hin, Sie versuchen, die UWP-XAML hosting-API verwenden (genauer gesagt: Sie versuchen, die [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) oder [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) Typen instanziieren) in einer UWP-app.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-261">This error indicates you are trying to use the UWP XAML hosting API (specifically, you are trying to instantiate the [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) or [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) types) in a UWP app.</span></span> <span data-ttu-id="4ffbd-262">Die UWP-XAML hosting-API ist nur in nicht-UWP-desktop-apps, z. B. WPF, Windows Forms und C++ Win32-Anwendungen verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-262">The UWP XAML hosting API is only intended to be used in non-UWP desktop apps, such as WPF, Windows Forms, and C++ Win32 applications.</span></span> |

### <a name="error-attaching-to-a-window-on-a-different-thread"></a><span data-ttu-id="4ffbd-263">Fehler beim Anhängen an ein Fenster in einem anderen thread</span><span class="sxs-lookup"><span data-stu-id="4ffbd-263">Error attaching to a window on a different thread</span></span>

| <span data-ttu-id="4ffbd-264">Problem</span><span class="sxs-lookup"><span data-stu-id="4ffbd-264">Issue</span></span> | <span data-ttu-id="4ffbd-265">Auflösung</span><span class="sxs-lookup"><span data-stu-id="4ffbd-265">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="4ffbd-266">Ihre app erhält eine **COMException** mit folgender Meldung: "AttachToWindow Methode ist fehlgeschlagen, da die angegebene HWND in einem anderen Thread erstellt wurde."</span><span class="sxs-lookup"><span data-stu-id="4ffbd-266">Your app receives a **COMException** with the following message: "AttachToWindow method failed because the specified HWND was created on a different thread."</span></span> | <span data-ttu-id="4ffbd-267">Dieser Fehler weist darauf hin, dass die Anwendung die **IDesktopWindowXamlSourceNative.AttachToWindow** -Methode, und übergeben sie die HWND eines Fensters, die in einem anderen Thread erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-267">This error indicates that your application called the **IDesktopWindowXamlSourceNative.AttachToWindow** method and passed it the HWND of a window that was created on a different thread.</span></span> <span data-ttu-id="4ffbd-268">Sie müssen diese Methode die HWND eines Fensters übergeben, die auf demselben Thread wie der Code erstellt wurde, aus denen Sie die Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-268">You must pass this method the HWND of a window that was created on the same thread as the code from which you are calling the method.</span></span> |

### <a name="error-attaching-to-a-window-on-a-different-top-level-window"></a><span data-ttu-id="4ffbd-269">Fehler beim Anhängen an ein Fenster auf eine andere Fenster der obersten Ebene</span><span class="sxs-lookup"><span data-stu-id="4ffbd-269">Error attaching to a window on a different top-level window</span></span>

| <span data-ttu-id="4ffbd-270">Problem</span><span class="sxs-lookup"><span data-stu-id="4ffbd-270">Issue</span></span> | <span data-ttu-id="4ffbd-271">Auflösung</span><span class="sxs-lookup"><span data-stu-id="4ffbd-271">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="4ffbd-272">Ihre app erhält eine **COMException** mit folgender Meldung: "AttachToWindow Methode fehlgeschlagen, da es sich bei das angegebene HWND aus einer anderen auf oberster Ebene als die HWND wird, die zuvor auf demselben Thread AttachToWindow übergeben wurde."</span><span class="sxs-lookup"><span data-stu-id="4ffbd-272">Your app receives a **COMException** with the following  message: "AttachToWindow method failed because the specified HWND descends from a different top-level window than the HWND that was previously passed to AttachToWindow on the same thread."</span></span> | <span data-ttu-id="4ffbd-273">Dieser Fehler weist darauf hin, dass Ihre Anwendung die **IDesktopWindowXamlSourceNative.AttachToWindow** -Methode, und übergeben sie den HWND eines Fensters, die aus einer anderen auf oberster Ebene als ein Fenster wird, die Sie in einem vorherigen Aufruf dieser Methode angegeben auf demselben Thread.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-273">This error indicates that your application called the **IDesktopWindowXamlSourceNative.AttachToWindow** method and passed it the HWND of a window that descends from a different top-level window than a window you specified in a previous call to this method on the same thread.</span></span></p></p><span data-ttu-id="4ffbd-274">Nachdem Ihre Anwendung **IDesktopWindowXamlSourceNative.AttachToWindow** für einen bestimmten Thread aufgerufen hat, können alle anderen [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) Objekte, die auf demselben Thread nur Windows zuordnen, die untergeordneten Elemente der obersten Ebene Fensteransicht werden in dem ersten Aufruf von **IDesktopWindowXamlSourceNative.AttachToWindow**übergeben wurde.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-274">After your application calls **IDesktopWindowXamlSourceNative.AttachToWindow** on a particular thread, all other [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) objects on the same thread can only attach to windows that are descendants of the same top-level window that was passed in the first call to **IDesktopWindowXamlSourceNative.AttachToWindow**.</span></span> <span data-ttu-id="4ffbd-275">Wenn alle **DesktopWindowXamlSource** Objekte, die für einen bestimmten Thread geschlossen werden, kann der nächsten **DesktopWindowXamlSource** dann jedes Fenster erneut an.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-275">When all the **DesktopWindowXamlSource** objects are closed for a particular thread, the next **DesktopWindowXamlSource** is then free to attach to any window again.</span></span></p></p><span data-ttu-id="4ffbd-276">Um dieses Problem zu beheben, schließen Sie entweder alle **DesktopWindowXamlSource** -Objekte, die auf andere Fenster der obersten Ebene für diesen Thread gebunden sind, oder erstellen einen neuen Thread für diese **DesktopWindowXamlSource**.</span><span class="sxs-lookup"><span data-stu-id="4ffbd-276">To resolve this issue, either close all **DesktopWindowXamlSource** objects that are bound to other top-level windows on this thread, or create a new thread for this **DesktopWindowXamlSource**.</span></span> |

## <a name="related-topics"></a><span data-ttu-id="4ffbd-277">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="4ffbd-277">Related topics</span></span>

* [<span data-ttu-id="4ffbd-278">UWP-Steuerelemente in Desktopanwendungen</span><span class="sxs-lookup"><span data-stu-id="4ffbd-278">UWP controls in desktop applications</span></span>](xaml-host-controls.md)
