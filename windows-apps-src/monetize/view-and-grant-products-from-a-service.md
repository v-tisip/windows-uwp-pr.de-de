---
author: mcleanbyron
ms.assetid: B071F6BC-49D3-4E74-98EA-0461A1A55EFB
description: "Wenn Sie über einen Katalog mit Apps und Add-Ons verfügen, können Sie mithilfe der Windows Store-Sammlungs-API und der Windows Store-Einkaufs-API Besitzerinformationen zu diesen Produkten aus Ihren Diensten abrufen."
title: "Verwalten von Produktansprüchen aus einem Dienst"
ms.author: mcleans
ms.date: 02/08/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: "Windows10, UWP, Windows Store-Sammlungs-API, Windows Store-Einkaufs-API, Produkte anzeigen, Produkte gewähren"
ms.openlocfilehash: 6ecc9d6014692cac52f5554f78a0773dfee3fb81
ms.sourcegitcommit: e7e8de39e963b73ba95cb34d8049e35e8d5eca61
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 08/16/2017
---
# <a name="manage-product-entitlements-from-a-service"></a><span data-ttu-id="98516-104">Verwalten von Produktansprüchen aus einem Dienst</span><span class="sxs-lookup"><span data-stu-id="98516-104">Manage product entitlements from a service</span></span>

<span data-ttu-id="98516-105">Wenn Sie über einen Katalog mit Apps und Add-Ons verfügen, können Sie mithilfe der *Windows Store-Sammlungs-API* und der *Windows Store-Einkaufs-API* Besitzerinformationen zu diesen Produkten aus Ihren Diensten abrufen.</span><span class="sxs-lookup"><span data-stu-id="98516-105">If you have a catalog of apps and add-ons, you can use the *Windows Store collection API* and *Windows Store purchase API* to access entitlement information for these products from your services.</span></span> <span data-ttu-id="98516-106">Eine *Berechtigung* ist das Recht des Kunden zur Nutzung einer über den Windows Store veröffentlichten App oder eines Add-ons.</span><span class="sxs-lookup"><span data-stu-id="98516-106">An *entitlement* represents a customer's right to use an app or add-on that is published through the Windows Store.</span></span>

<span data-ttu-id="98516-107">Diese APIs bestehen aus REST-Methoden, die für Entwickler mit Add-on-Katalogen konzipiert sind, die von plattformübergreifenden Diensten unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="98516-107">These APIs consist of REST methods that are designed to be used by developers with add-on catalogs that are supported by cross-platform services.</span></span> <span data-ttu-id="98516-108">Diese APIs bieten folgende Möglichkeiten:</span><span class="sxs-lookup"><span data-stu-id="98516-108">These APIs enable you to do the following:</span></span>

-   <span data-ttu-id="98516-109">Windows Store-Sammlungs-API: [Abfrage von Produkten, die einem Benutzer gehören](query-for-products.md) sowie [Meldung eines Verbrauchsprodukts als erfüllt](report-consumable-products-as-fulfilled.md).</span><span class="sxs-lookup"><span data-stu-id="98516-109">Windows Store collection API: [Query for products owned by a user](query-for-products.md) and [report a consumable product as fulfilled](report-consumable-products-as-fulfilled.md).</span></span>
-   <span data-ttu-id="98516-110">Windows Store-Einkaufs-API: [Einem Benutzer ein kostenloses Produkt gewähren](grant-free-products.md), [Abonnements für einen Benutzer abrufen](get-subscriptions-for-a-user.md) und [Abrechnungszustand eines Abonnements für einen Benutzer ändern](change-the-billing-state-of-a-subscription-for-a-user.md).</span><span class="sxs-lookup"><span data-stu-id="98516-110">Windows Store purchase API: [Grant a free product to a user](grant-free-products.md), [get subscriptions for a user](get-subscriptions-for-a-user.md), and [change the billing state of a subscription for a user](change-the-billing-state-of-a-subscription-for-a-user.md).</span></span>

> [!NOTE]
> <span data-ttu-id="98516-111">Die Windows Store-Sammlungs-API und -Einkaufs-API nutzen die Azure Active Directory (AzureAD)-Authentifizierung, um auf Besitzerinformationen von Kunden zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="98516-111">The Windows Store collection API and purchase API use Azure Active Directory (Azure AD) authentication to access customer ownership information.</span></span> <span data-ttu-id="98516-112">Zur Verwendung dieser APIs müssen Sie (bzw. Ihre Organisation) über ein Azure AD-Verzeichnis und die Berechtigung [Globaler Administrator](http://go.microsoft.com/fwlink/?LinkId=746654) für das Verzeichnis verfügen.</span><span class="sxs-lookup"><span data-stu-id="98516-112">To use these APIs, you (or your organization) must have an Azure AD directory and you must have [Global administrator](http://go.microsoft.com/fwlink/?LinkId=746654) permission for the directory.</span></span> <span data-ttu-id="98516-113">Wenn Sie bereits mit Office 365oder anderen Business Services von Microsoft arbeiten, verfügen Sie schon über ein Azure AD-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="98516-113">If you already use Office 365 or other business services from Microsoft, you already have Azure AD directory.</span></span>

## <a name="overview"></a><span data-ttu-id="98516-114">Übersicht</span><span class="sxs-lookup"><span data-stu-id="98516-114">Overview</span></span>

<span data-ttu-id="98516-115">Die folgenden Schrittebeschreiben den vollständigen Vorgang der Verwendung der Windows Store-Sammlungs-API und der Windows Store-Einkaufs-API.:</span><span class="sxs-lookup"><span data-stu-id="98516-115">The following steps describe the end-to-end process for using the Windows Store collection API and purchase API:</span></span>

1.  <span data-ttu-id="98516-116">[Konfigurieren Sie eine Webanwendung in Azure AD](#step-1).</span><span class="sxs-lookup"><span data-stu-id="98516-116">[Configure a Web application in Azure AD](#step-1).</span></span>
2.  <span data-ttu-id="98516-117">[Ordnen Sie Ihre AzureAD-Client-ID im WindowsDevCenter-Dashboard Ihrer Anwendung zu](#step-2).</span><span class="sxs-lookup"><span data-stu-id="98516-117">[Associate your Azure AD client ID with your application in the Windows Dev Center dashboard](#step-2).</span></span>
3.  <span data-ttu-id="98516-118">In Ihrem Dienst: [Erstellen Sie Azure AD-Zugriffstokens](#step-3), die Ihre Herausgeberidentität darstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-118">In your service, [create Azure AD access tokens](#step-3) that represent your publisher identity.</span></span>
4.  <span data-ttu-id="98516-119">Im clientseitigen Code in Ihrer Windows-App: [Erstellen Sie einen Windows Store-ID-Schlüssel](#step-4), der die Identität des aktuellen Benutzers darstellt, und übergeben Sie den Windows Store-ID-Schlüssel zurück an Ihren Dienst.</span><span class="sxs-lookup"><span data-stu-id="98516-119">In client-side code in your Windows app, [create a Windows Store ID key](#step-4) that represents the identity of the current user, and pass the Windows Store ID key back to your service.</span></span>
5.  <span data-ttu-id="98516-120">Sobald Sie über das erforderliche AzureAD-Zugriffstoken und den WindowsStore-ID-Schlüssel verfügen, [rufen Sie die Windows Store-Sammlungs-API oder -Einkaufs-API aus Ihrem Dienst auf](#step-5).</span><span class="sxs-lookup"><span data-stu-id="98516-120">After you have the required Azure AD access token and Windows Store ID key, [call the Windows Store collection API or purchase API from your service](#step-5).</span></span>

<span data-ttu-id="98516-121">Die folgenden Abschnitte enthalten weitere Details zu den einzelnen Schritten.</span><span class="sxs-lookup"><span data-stu-id="98516-121">The following sections provide more details about each of these steps.</span></span>

<span id="step-1"/>
## <a name="step-1-configure-a-web-application-in-azure-ad"></a><span data-ttu-id="98516-122">Schritt1: Konfigurieren einer Webanwendung in Azure AD</span><span class="sxs-lookup"><span data-stu-id="98516-122">Step 1: Configure a Web application in Azure AD</span></span>

<span data-ttu-id="98516-123">Bevor Sie die Windows Store-Sammlungs-API oder -Einkaufs-API verwenden können, müssen Sie eine Azure AD-Webanwendung erstellen, die Mandanten-ID und die Client-ID für die Anwendung abrufen und einen Schlüssel erzeugen.</span><span class="sxs-lookup"><span data-stu-id="98516-123">Before you can use the Windows Store collection API or purchase API, you must create an Azure AD Web application, retrieve the tenant ID and client ID for the application, and generate a key.</span></span> <span data-ttu-id="98516-124">Die Azure AD-Anwendung ist die Anwendung oder der Dienst, aus denen Sie die Windows Store-Sammlungs- oder -Einkaufs-API aufrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="98516-124">The Azure AD application represents the app or service from which you want to call the Windows Store collection API or purchase API.</span></span> <span data-ttu-id="98516-125">Sie benötigen die Mandanten-ID, die Client-ID und den Schlüssel zum Abrufen eines AzureAD-Zugriffstokens, das Sie an die API übergeben.</span><span class="sxs-lookup"><span data-stu-id="98516-125">You need the tenant ID, client ID and key to obtain an Azure AD access token that you pass to the API.</span></span>

> [!NOTE]
> <span data-ttu-id="98516-126">Sie müssen die in diesem Abschnitt beschriebenen Vorgänge nur einmal durchführen.</span><span class="sxs-lookup"><span data-stu-id="98516-126">You only need to perform the tasks in this section one time.</span></span> <span data-ttu-id="98516-127">Nachdem Sie Ihr Azure AD-Anwendungsmanifest aktualisiert haben und über Ihre Mandanten-ID, die Client-ID und das Clientgeheimnis verfügen, können Sie diese Werte immer verwenden, wenn Sie ein neues Azure AD-Zugriffstoken erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="98516-127">After you update your Azure AD application manifest and you have your tenant ID, client ID and client secret, you can reuse these values any time you need to create a new Azure AD access token.</span></span>

1.  <span data-ttu-id="98516-128">Führen Sie die Schritte unter [Integrieren von Anwendungen in Azure Active Directory](http://go.microsoft.com/fwlink/?LinkId=722502) aus, um AzureAD eine Webanwendung hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="98516-128">Follow the instructions in [Integrating Applications with Azure Active Directory](http://go.microsoft.com/fwlink/?LinkId=722502) to add a Web application to Azure AD.</span></span>
    > [!NOTE]
    > <span data-ttu-id="98516-129">Wählen Sie auf der Seite **Erzählen Sie uns von Ihrer Anwendung** die Option **Webanwendung und/oder Web-API** aus.</span><span class="sxs-lookup"><span data-stu-id="98516-129">On the **Tell us about your application page**, make sure that you choose **Web application and/or web API**.</span></span> <span data-ttu-id="98516-130">Dies ist erforderlich, damit Sie für Ihre Anwendung einen Schlüssel (auch *Clientgeheimnis* genannt) erhalten.</span><span class="sxs-lookup"><span data-stu-id="98516-130">This is required so that you can retrieve a key (also called a *client secret*) for your application.</span></span> <span data-ttu-id="98516-131">Zum Aufrufen der Windows Store-Sammlungs-API oder -Einkaufs-API müssen Sie einen geheimen Clientschlüssel angeben, wenn Sie in einem späteren Schritt ein Zugriffstoken von AzureAD anfordern.</span><span class="sxs-lookup"><span data-stu-id="98516-131">In order to call the Windows Store collection API or purchase API, you must provide a client secret when you request an access token from Azure AD in a later step.</span></span>

2.  <span data-ttu-id="98516-132">Navigieren Sie im [Azure-Verwaltungsportal](http://manage.windowsazure.com/) zu **Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="98516-132">In the [Azure Management Portal](http://manage.windowsazure.com/), navigate to **Active Directory**.</span></span> <span data-ttu-id="98516-133">Wählen Sie Ihr Verzeichnis aus, klicken Sie oben auf die Registerkarte **Anwendungen**, und wählen Sie Ihre Anwendung aus.</span><span class="sxs-lookup"><span data-stu-id="98516-133">Select your directory, click the **Applications** tab at the top, and then select your application.</span></span>
3.  <span data-ttu-id="98516-134">Klicken Sie auf die Registerkarte **Konfigurieren**.</span><span class="sxs-lookup"><span data-stu-id="98516-134">Click the **Configure** tab.</span></span> <span data-ttu-id="98516-135">Ermitteln Sie auf dieser Registerkarte die Client-ID für Ihre Anwendung, und fordern Sie einen Schlüssel an. Dieser Schlüssel wird in den weiteren Schritten als *geheimer Clientschlüssel* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="98516-135">On this tab, obtain the client ID for your application and request a key (this is called a *client secret* in later steps).</span></span>
4.  <span data-ttu-id="98516-136">Klicken Sie am unteren Bildschirmrand auf **Manifest verwalten**.</span><span class="sxs-lookup"><span data-stu-id="98516-136">At the bottom of the screen, click **Manage manifest**.</span></span> <span data-ttu-id="98516-137">Laden Sie Ihr AzureAD-Anwendungsmanifest herunter, und ersetzen Sie den Abschnitt `"identifierUris"` durch folgenden Text:</span><span class="sxs-lookup"><span data-stu-id="98516-137">Download your Azure AD application manifest and replace the `"identifierUris"` section with the following text.</span></span>

    ```json
    "identifierUris" : [                                
            "https://onestore.microsoft.com",
            "https://onestore.microsoft.com/b2b/keys/create/collections",
            "https://onestore.microsoft.com/b2b/keys/create/purchase"
        ],
    ```

    <span data-ttu-id="98516-138">Diese Zeichenfolgen stellen die von der Anwendung unterstützten Zielgruppen dar.</span><span class="sxs-lookup"><span data-stu-id="98516-138">These strings represent the audiences supported by your application.</span></span> <span data-ttu-id="98516-139">In einem späteren Schritt erstellen Sie Azure AD-Zugriffstoken, die den einzelnen Zielgruppenwerten zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="98516-139">In a later step, you will create Azure AD access tokens that are associated with each of these audience values.</span></span> <span data-ttu-id="98516-140">Weitere Informationen zum Herunterladen Ihres Anwendungsmanifests finden Sie unter [Grundlegendes zum AzureActiveDirectory-Anwendungsmanifest](http://go.microsoft.com/fwlink/?LinkId=722500).</span><span class="sxs-lookup"><span data-stu-id="98516-140">For more information about how to download your application manifest, see [Understanding the Azure Active Directory application manifest](http://go.microsoft.com/fwlink/?LinkId=722500).</span></span>

5.  <span data-ttu-id="98516-141">Speichern Sie Ihr Anwendungsmanifest, und laden Sie es im [Azure-Verwaltungsportal](http://manage.windowsazure.com/) für Ihre Anwendung hoch.</span><span class="sxs-lookup"><span data-stu-id="98516-141">Save your application manifest and upload it to your application in the [Azure Management Portal](http://manage.windowsazure.com/).</span></span>

<span id="step-2"/>
## <a name="step-2-associate-your-azure-ad-client-id-with-your-app-in-windows-dev-center"></a><span data-ttu-id="98516-142">Schritt2: Zuordnen Ihrer AzureAD-Client-ID zu Ihrer Anwendung in WindowsDevCenter</span><span class="sxs-lookup"><span data-stu-id="98516-142">Step 2: Associate your Azure AD client ID with your app in Windows Dev Center</span></span>

<span data-ttu-id="98516-143">Bevor Sie mit der Windows Store-Sammlungs-API oder -Einkaufs-API eine Anwendung oder ein Add-On ausführen können, müssen Sie Ihre Azure AD-Client-ID der App (oder der App, die das Add-On enthält) im Dev Center-Dashboard zuordnen.</span><span class="sxs-lookup"><span data-stu-id="98516-143">Before you can use the Windows Store collection API or purchase API to operate on an app or add-on, you must associate your Azure AD client ID with the app (or the app that contains the add-on) in the Dev Center dashboard.</span></span>

> [!NOTE]
> <span data-ttu-id="98516-144">Sie müssen diesen Schritt nur einmal ausführen.</span><span class="sxs-lookup"><span data-stu-id="98516-144">You only need to perform this task one time.</span></span>

1.  <span data-ttu-id="98516-145">Melden Sie sich beim [DevCenter-Dashboard](https://dev.windows.com/overview) an, und wählen Sie Ihre App aus.</span><span class="sxs-lookup"><span data-stu-id="98516-145">Sign in to the [Dev Center dashboard](https://dev.windows.com/overview) and select your app.</span></span>
2.  <span data-ttu-id="98516-146">Geben Sie auf der Seite **Dienste** &gt; **Produktsammlungen und Einkäufe** Ihre AzureAD-Client-ID in eines der verfügbaren Felder ein.</span><span class="sxs-lookup"><span data-stu-id="98516-146">Go to the **Services** &gt; **Product collections and purchases** page and enter your Azure AD client ID into one of the available fields.</span></span>

<span id="step-3"/>
## <a name="step-3-create-azure-ad-access-tokens"></a><span data-ttu-id="98516-147">Schritt3: Erstellen von Azure AD-Zugriffstokens</span><span class="sxs-lookup"><span data-stu-id="98516-147">Step 3: Create Azure AD access tokens</span></span>

<span data-ttu-id="98516-148">Bevor Sie einen WindowsStore-ID-Schlüssel abrufen oder die Windows Store-Sammlungs-API oder -Einkaufs-API aufrufen können, muss Ihr Dienst mehrere verschiedene Azure AD-Zugriffstokens erstellen, die Ihre Herausgeberidentität darstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-148">Before you can retrieve a Windows Store ID key or call the Windows Store collection API or purchase API, your service must create several different Azure AD access tokens that represent your publisher identity.</span></span> <span data-ttu-id="98516-149">Jedes Token wird mit einer anderen API verwendet.</span><span class="sxs-lookup"><span data-stu-id="98516-149">Each token will be used with a different API.</span></span> <span data-ttu-id="98516-150">Jedes Token ist 60Minuten gültig und kann nach Ablauf aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="98516-150">The lifetime of each token is 60 minutes, and you can refresh them after they expire.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="98516-151">Erstellen Sie Azure AD-Zugriffstoken nur im Kontext Ihres Diensts und nicht in Ihrer App.</span><span class="sxs-lookup"><span data-stu-id="98516-151">Create Azure AD access tokens only in the context of your service, not in your app.</span></span> <span data-ttu-id="98516-152">Ihr Clientgeheimnis könnte gefährdet sein, wenn es an Ihre App gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="98516-152">Your client secret could be compromised if it is sent to your app.</span></span>

<span id="access-tokens" />
### <a name="understanding-the-different-tokens-and-audience-uris"></a><span data-ttu-id="98516-153">Grundlegendes zu den unterschiedlichen Tokens und Zielgruppen-URIs</span><span class="sxs-lookup"><span data-stu-id="98516-153">Understanding the different tokens and audience URIs</span></span>

<span data-ttu-id="98516-154">Je nach den Methoden, die Sie in der Windows Store-Sammlungs-API oder -Einkaufs-API aufrufen möchten, müssen Sie zwei oder drei unterschiedliche Tokens erstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-154">Depending on which methods you want to call in the Windows Store collection API or purchase API, you must create either two or three different tokens.</span></span> <span data-ttu-id="98516-155">Jedes Zugriffstoken ist einem anderen Zielgruppen-URI zugeordnet (Hierbei handelt es sich um die gleichen URIs, die Sie zuvor dem `"identifierUris"`-Abschnitt des Azure AD-Anwendungsmanifests hinzugefügt haben).</span><span class="sxs-lookup"><span data-stu-id="98516-155">Each access token is associated with a different audience URI (these are the same URIs that you previously added to the `"identifierUris"` section of the Azure AD application manifest).</span></span>

  * <span data-ttu-id="98516-156">In allen Fällen müssen Sie ein Token mit dem `https://onestore.microsoft.com`-Zielgruppen-URI erstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-156">In all cases, you must create a token with the `https://onestore.microsoft.com` audience URI.</span></span> <span data-ttu-id="98516-157">In einem späteren Schritt übergeben Sie dieses Token an den **Autorisierung**-Kopf der Methoden in der Windows Store-Sammlungs- oder -Einkaufs-API.</span><span class="sxs-lookup"><span data-stu-id="98516-157">In a later step, you will pass this token to the **Authorization** header of methods in the Windows Store collection API or purchase API.</span></span>
      > [!IMPORTANT]
      > <span data-ttu-id="98516-158">Verwenden Sie die Zielgruppe `https://onestore.microsoft.com` nur mit Zugriffstoken, die sicher in Ihrem Dienst gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="98516-158">Use the `https://onestore.microsoft.com` audience only with access tokens that are stored securely within your service.</span></span> <span data-ttu-id="98516-159">Durch das Verfügbarmachen von Zugriffstokens mit dieser Zielgruppe außerhalb Ihres Diensts kann dieser anfällig für Replay-Angriffe werden.</span><span class="sxs-lookup"><span data-stu-id="98516-159">Exposing access tokens with this audience outside your service could make your service vulnerable to replay attacks.</span></span>

  * <span data-ttu-id="98516-160">Wenn Sie eine Methode in der Windows Store-Sammlungs-API zur [Abfrage von Produkten, die einem Benutzer gehören](query-for-products.md) oder zum [Melden eines Verbrauchsprodukts als erfüllt](report-consumable-products-as-fulfilled.md) aufrufen möchten, müssen Sie auch ein Token mit dem `https://onestore.microsoft.com/b2b/keys/create/collections`-Zielgruppen-URI erstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-160">If you want to call a method in the Windows Store collection API to [query for products owned by a user](query-for-products.md) or [report a consumable product as fulfilled](report-consumable-products-as-fulfilled.md), you must also create a token with the `https://onestore.microsoft.com/b2b/keys/create/collections` audience URI.</span></span> <span data-ttu-id="98516-161">In einem späteren Schritt übergeben Sie dieses Token an eine Client-Methode im Windows SDK zur Abfrage eines WindowsStore-ID-Schlüssels, den Sie mit der Windows Store-Sammlungs-API verwenden können.</span><span class="sxs-lookup"><span data-stu-id="98516-161">In a later step, you will pass this token to a client method in the Windows SDK to request a Windows Store ID key that you can use with the Windows Store collection API.</span></span>

  * <span data-ttu-id="98516-162">Wenn Sie eine Methode in der Windows Store-Einkaufs-API aufrufen möchten, um [einem Benutzer ein kostenloses Produkt zu gewähren](grant-free-products.md), [Abonnements für einen Benutzer abzurufen](get-subscriptions-for-a-user.md) oder [den Abrechnungszustand eines Abonnements für einen Benutzer zu ändern](change-the-billing-state-of-a-subscription-for-a-user.md), müssen Sie auch ein Token mit dem `https://onestore.microsoft.com/b2b/keys/create/purchase`-Zielgruppen-URI erstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-162">If you want to call a method in the Windows Store purchase API to [grant a free product to a user](grant-free-products.md), [get subscriptions for a user](get-subscriptions-for-a-user.md), or [change the billing state of a subscription for a user](change-the-billing-state-of-a-subscription-for-a-user.md), you must also create a token with the `https://onestore.microsoft.com/b2b/keys/create/purchase` audience URI.</span></span> <span data-ttu-id="98516-163">In einem späteren Schritt übergeben Sie dieses Token an eine Client-Methode im Windows SDK zur Abfrage eines WindowsStore-ID-Schlüssels, den Sie mit der Windows Store-Einkaufs-API verwenden können.</span><span class="sxs-lookup"><span data-stu-id="98516-163">In a later step, you will pass this token to a client method in the Windows SDK to request a Windows Store ID key that you can use with the Windows Store purchase API.</span></span>

<span />
### <a name="create-the-tokens"></a><span data-ttu-id="98516-164">Erstellen Sie Token</span><span class="sxs-lookup"><span data-stu-id="98516-164">Create the tokens</span></span>

<span data-ttu-id="98516-165">Verwenden Sie zum Erstellen der Zugriffstokens die OAuth 2.0-API in Ihrem Dienst gemäß den Anweisungen in [Aufrufe zwischen Diensten mithilfe von Clientanmeldeinformationen](https://azure.microsoft.com/documentation/articles/active-directory-protocols-oauth-service-to-service), um einen HTTP POST an den ```https://login.microsoftonline.com/<tenant_id>/oauth2/token```-Endpunkt zu senden.</span><span class="sxs-lookup"><span data-stu-id="98516-165">To create the access tokens, use the OAuth 2.0 API in your service by following the instructions in [Service to Service Calls Using Client Credentials](https://azure.microsoft.com/documentation/articles/active-directory-protocols-oauth-service-to-service) to send an HTTP POST to the ```https://login.microsoftonline.com/<tenant_id>/oauth2/token``` endpoint.</span></span> <span data-ttu-id="98516-166">Hier ist ein Beispiel für eine Anforderung angegeben.</span><span class="sxs-lookup"><span data-stu-id="98516-166">Here is a sample request.</span></span>

``` syntax
POST https://login.microsoftonline.com/<tenant_id>/oauth2/token HTTP/1.1
Host: login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded; charset=utf-8

grant_type=client_credentials
&client_id=<your_client_id>
&client_secret=<your_client_secret>
&resource=https://onestore.microsoft.com
```

<span data-ttu-id="98516-167">Geben Sie für jedes Token die folgenden Parameterdaten an:</span><span class="sxs-lookup"><span data-stu-id="98516-167">For each token, specify the following parameter data:</span></span>

* <span data-ttu-id="98516-168">Geben Sie für den *client\_id*-Parameter und den *client\_secret*-Parameter die Client-ID und das Clientgeheimnis Ihrer Anwendung aus dem [Azure-Verwaltungsportal](http://manage.windowsazure.com) an.</span><span class="sxs-lookup"><span data-stu-id="98516-168">For the *client\_id* and *client\_secret* parameters, specify the client ID and the client secret for your application that you retrieved from the [Azure Management Portal](http://manage.windowsazure.com).</span></span> <span data-ttu-id="98516-169">Beide Parameter sind erforderlich, um ein Zugriffstoken mit der Authentifizierungsebene zu erstellen, die für die Windows Store-Sammlungs-API oder -Einkaufs-API benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="98516-169">Both of these parameters are required in order to create an access token with the level of authentication required by the Windows Store collection API or purchase API.</span></span>

* <span data-ttu-id="98516-170">Geben Sie für den Parameter *Ressource* einen der Zielgruppen-URIs aus dem [vorherigen Abschnitt](#access-tokens) an, je nach der Art des Zugriffstokens, den Sie erstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-170">For the *resource* parameter, specify one of the audience URIs listed in the [previous section](#access-tokens), depending on the type of access token you are creating.</span></span>

<span data-ttu-id="98516-171">Nachdem das Zugriffstoken abgelaufen ist, können Sie es aktualisieren, indem Sie [diese Anleitung](https://azure.microsoft.com/documentation/articles/active-directory-protocols-oauth-code/#refreshing-the-access-tokens) befolgen.</span><span class="sxs-lookup"><span data-stu-id="98516-171">After your access token expires, you can refresh it by following the instructions [here](https://azure.microsoft.com/documentation/articles/active-directory-protocols-oauth-code/#refreshing-the-access-tokens).</span></span> <span data-ttu-id="98516-172">Weitere Informationen zur Struktur eines Zugriffstokens finden Sie unter [Unterstützte Token- und Anspruchstypen](http://go.microsoft.com/fwlink/?LinkId=722501).</span><span class="sxs-lookup"><span data-stu-id="98516-172">For more details about the structure of an access token, see [Supported Token and Claim Types](http://go.microsoft.com/fwlink/?LinkId=722501).</span></span>

<span id="step-4"/>
## <a name="step-4-create-a-windows-store-id-key"></a><span data-ttu-id="98516-173">Schritt4: Erstellen eines Windows Store-ID-Schlüssels</span><span class="sxs-lookup"><span data-stu-id="98516-173">Step 4: Create a Windows Store ID key</span></span>

<span data-ttu-id="98516-174">Bevor Sie eine Methode in der Windows Store-Sammlungs- oder -Einkaufs-API aufrufen können, muss Ihre App einen Windows Store-ID-Schlüssel erstellen und an Ihren Dienst senden.</span><span class="sxs-lookup"><span data-stu-id="98516-174">Before you can call any method in the Windows Store collection API or purchase API, your app must create a Windows Store ID key and send it to your service.</span></span> <span data-ttu-id="98516-175">Bei diesem Schlüssel handelt es sich um ein JSON Web Token (JWT), das die Identität des Benutzers darstellt, auf dessen Produktbesitzerinformationen Sie zugreifen möchten.</span><span class="sxs-lookup"><span data-stu-id="98516-175">This key is a JSON Web Token (JWT) that represents the identity of the user whose product ownership information you want to access.</span></span> <span data-ttu-id="98516-176">Weitere Informationen zu den Ansprüchen in diesem Schlüssel finden Sie unter [Ansprüche in einem Windows Store-ID-Schlüssel](#claims).</span><span class="sxs-lookup"><span data-stu-id="98516-176">For more information about the claims in this key, see [Claims in a Windows Store ID key](#claims).</span></span>

<span data-ttu-id="98516-177">Derzeit kann ein WindowsStore-ID-Schlüssel ausschließlich durch Aufrufen einer UWP-API im clientseitigen Code Ihrer App erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="98516-177">Currently, the only way to create a Windows Store ID key is by calling a Universal Windows Platform (UWP) API from client code in your app.</span></span> <span data-ttu-id="98516-178">Der generierte Schlüssel repräsentiert die Identität des Benutzers, der derzeit auf dem Gerät beim Windows Store angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="98516-178">The generated key represents the identity of the user who is currently signed in to the Windows Store on the device.</span></span>

> [!NOTE]
> <span data-ttu-id="98516-179">Jeder WindowsStore-ID-Schlüssel ist 90Tage gültig.</span><span class="sxs-lookup"><span data-stu-id="98516-179">Each Windows Store ID key is valid for 90 days.</span></span> <span data-ttu-id="98516-180">Nach dem Ablauf eines Schlüssels können Sie [den Schlüssel verlängern](renew-a-windows-store-id-key.md).</span><span class="sxs-lookup"><span data-stu-id="98516-180">After a key expires, you can [renew the key](renew-a-windows-store-id-key.md).</span></span> <span data-ttu-id="98516-181">Wir empfehlen, Windows Store-ID-Schlüssel zu verlängern, anstatt neue zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="98516-181">We recommend that you renew your Windows Store ID keys rather than creating new ones.</span></span>

<span />
### <a name="to-create-a-windows-store-id-key-for-the-windows-store-collection-api"></a><span data-ttu-id="98516-182">So erstellen Sie einen Windows Store-ID-Schlüssel für die Windows Store-Sammlungs-API:</span><span class="sxs-lookup"><span data-stu-id="98516-182">To create a Windows Store ID key for the Windows Store collection API</span></span>

<span data-ttu-id="98516-183">Gehen Sie wie folgt vor, um einen Windows Store-ID-Schlüssel zu erstellen, den Sie mit der Windows Store-Sammlungs-API zur [Abfrage von Produkten, die einem Benutzer gehören](query-for-products.md) oder zum [Melden eines Verbrauchsprodukts als erfüllt](report-consumable-products-as-fulfilled.md) verwenden können.</span><span class="sxs-lookup"><span data-stu-id="98516-183">Follow these steps to create a Windows Store ID key that you can use with the Windows Store collection API to [query for products owned by a user](query-for-products.md) or [report a consumable product as fulfilled](report-consumable-products-as-fulfilled.md).</span></span>

1.  <span data-ttu-id="98516-184">Übergeben Sie das Azure AD-Zugriffstoken, das Sie mit dem `https://onestore.microsoft.com/b2b/keys/create/collections`-Zielgruppen-URI erstellt haben, aus Ihrem Dienst an Ihre Client-App.</span><span class="sxs-lookup"><span data-stu-id="98516-184">Pass the Azure AD access token that you created with the `https://onestore.microsoft.com/b2b/keys/create/collections` audience URI from your service to your client app.</span></span>

2.  <span data-ttu-id="98516-185">Rufen Sie in Ihrem App-Code diese Methoden auf, um einen WindowsStore-ID-Schlüssel abzurufen:</span><span class="sxs-lookup"><span data-stu-id="98516-185">In your app code, call one of these methods to retrieve a Windows Store ID key:</span></span>

  * <span data-ttu-id="98516-186">Wenn Ihre App die [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx)-Klasse im [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx)-Namespace zur Verwaltung von In-App-Käufen verwendet, verwenden Sie die Methode [StoreContext.GetCustomerCollectionsIdAsync](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.getcustomercollectionsidasync.aspx).</span><span class="sxs-lookup"><span data-stu-id="98516-186">If your app uses the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) class in the [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) namespace to manage in-app purchases, use the [StoreContext.GetCustomerCollectionsIdAsync](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.getcustomercollectionsidasync.aspx) method.</span></span>

  * <span data-ttu-id="98516-187">Wenn Ihre App die [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) -Klasse im [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) -Namespace zur Verwaltung von In-App-Käufen verwendet, verwenden Sie die Methode [CurrentApp.GetCustomerCollectionsIdAsync](https://msdn.microsoft.com/library/windows/apps/mt608674).</span><span class="sxs-lookup"><span data-stu-id="98516-187">If your app uses the [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) class in the [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) namespace to manage in-app purchases, use the [CurrentApp.GetCustomerCollectionsIdAsync](https://msdn.microsoft.com/library/windows/apps/mt608674) method.</span></span>

    <span data-ttu-id="98516-188">Übergeben Sie Ihr AzureAD-Zugriffstoken an den *serviceTicket*-Parameter der Methode.</span><span class="sxs-lookup"><span data-stu-id="98516-188">Pass your Azure AD access token to the *serviceTicket* parameter of the method.</span></span> <span data-ttu-id="98516-189">Sie können optional eine ID an den *publisherUserId*-Parameter übergeben, der den aktuellen Benutzer im Kontext Ihrer Dienste identifiziert.</span><span class="sxs-lookup"><span data-stu-id="98516-189">You can optionally pass an ID to the *publisherUserId* parameter that identifies the current user in the context of your services.</span></span> <span data-ttu-id="98516-190">Wenn Sie Benutzer-IDs für Ihre Dienste verwalten, können Sie diesen Parameter verwenden, um die Benutzer-IDs mit den Aufrufen an die Windows Store-Sammlungs-API zu korrelieren.</span><span class="sxs-lookup"><span data-stu-id="98516-190">If you maintain user IDs for your services, you can use this parameter to correlate these user IDs with the calls you make to the Windows Store collection API.</span></span>

3.  <span data-ttu-id="98516-191">Übergeben Sie den von Ihrer App erfolgreich erstellten WindowsStore-ID-Schlüssel zurück an Ihren Dienst.</span><span class="sxs-lookup"><span data-stu-id="98516-191">After your app successfully creates a Windows Store ID key, pass the key back to your service.</span></span>

<span />
### <a name="to-create-a-windows-store-id-key-for-the-windows-store-purchase-api"></a><span data-ttu-id="98516-192">So erstellen Sie einen Windows Store-ID-Schlüssel für die Windows Store-Einkaufs-API:</span><span class="sxs-lookup"><span data-stu-id="98516-192">To create a Windows Store ID key for the Windows Store purchase API</span></span>

<span data-ttu-id="98516-193">Befolgen Sie diese Schritte zur Erstellung eines Windows Store-ID-Schlüssels, mit dem Sie– in Kombination mir der Windows Store-Einkaufs-API– [einem Benutzer ein kostenloses Produkt gewähren](grant-free-products.md), [Abonnements für einen Benutzer abrufen](get-subscriptions-for-a-user.md) oder [den Abrechnungszustand eines Abonnements für einen Benutzer ändern](change-the-billing-state-of-a-subscription-for-a-user.md) können.</span><span class="sxs-lookup"><span data-stu-id="98516-193">Follow these steps to create a Windows Store ID key that you can use with the Windows Store purchase API to [grant a free product to a user](grant-free-products.md), [get subscriptions for a user](get-subscriptions-for-a-user.md), or [change the billing state of a subscription for a user](change-the-billing-state-of-a-subscription-for-a-user.md).</span></span>

1.  <span data-ttu-id="98516-194">Übergeben Sie das Azure AD-Zugriffstoken, das Sie mit dem `https://onestore.microsoft.com/b2b/keys/create/purchase`-Zielgruppen-URI erstellt haben, aus Ihrem Dienst an Ihre Client-App.</span><span class="sxs-lookup"><span data-stu-id="98516-194">Pass the Azure AD access token that you created with the `https://onestore.microsoft.com/b2b/keys/create/purchase` audience URI from your service to your client app.</span></span>

2.  <span data-ttu-id="98516-195">Rufen Sie in Ihrem App-Code diese Methoden auf, um einen WindowsStore-ID-Schlüssel abzurufen:</span><span class="sxs-lookup"><span data-stu-id="98516-195">In your app code, call one of these methods to retrieve a Windows Store ID key:</span></span>

  * <span data-ttu-id="98516-196">Wenn Ihre App die [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx)-Klasse im [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx)-Namespace zur Verwaltung von In-App-Käufen verwendet, verwenden Sie die Methode [StoreContext.GetCustomerPurchaseIdAsync](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.getcustomerpurchaseidasync.aspx).</span><span class="sxs-lookup"><span data-stu-id="98516-196">If your app uses the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) class in the [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) namespace to manage in-app purchases, use the [StoreContext.GetCustomerPurchaseIdAsync](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.getcustomerpurchaseidasync.aspx) method.</span></span>

  * <span data-ttu-id="98516-197">Wenn Ihre App die [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) -Klasse im [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) -Namespace zur Verwaltung von In-App-Käufen verwendet, verwenden Sie die Methode [CurrentApp.GetCustomerPurchaseIdAsync](https://msdn.microsoft.com/library/windows/apps/mt608675).</span><span class="sxs-lookup"><span data-stu-id="98516-197">If your app uses the [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) class in the [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) namespace to manage in-app purchases, use the [CurrentApp.GetCustomerPurchaseIdAsync](https://msdn.microsoft.com/library/windows/apps/mt608675) method.</span></span>

    <span data-ttu-id="98516-198">Übergeben Sie Ihr AzureAD-Zugriffstoken an den *serviceTicket*-Parameter der Methode.</span><span class="sxs-lookup"><span data-stu-id="98516-198">Pass your Azure AD access token to the *serviceTicket* parameter of the method.</span></span> <span data-ttu-id="98516-199">Sie können optional eine ID an den *publisherUserId*-Parameter übergeben, der den aktuellen Benutzer im Kontext Ihrer Dienste identifiziert.</span><span class="sxs-lookup"><span data-stu-id="98516-199">You can optionally pass an ID to the *publisherUserId* parameter that identifies the current user in the context of your services.</span></span> <span data-ttu-id="98516-200">Wenn Sie Benutzer-IDs für Ihre Dienste verwalten, können Sie diesen Parameter verwenden, um die Benutzer-IDs mit den Aufrufen an die Windows Store-Einkaufs-API zu korrelieren.</span><span class="sxs-lookup"><span data-stu-id="98516-200">If you maintain user IDs for your services, you can use this parameter to correlate these user IDs with the calls you make to the Windows Store purchase API.</span></span>

3.  <span data-ttu-id="98516-201">Übergeben Sie den von Ihrer App erfolgreich erstellten WindowsStore-ID-Schlüssel zurück an Ihren Dienst.</span><span class="sxs-lookup"><span data-stu-id="98516-201">After your app successfully creates a Windows Store ID key, pass the key back to your service.</span></span>

<span id="step-5"/>
## <a name="step-5-call-the-windows-store-collection-api-or-purchase-api-from-your-service"></a><span data-ttu-id="98516-202">Schritt5: Aufrufen der Windows Store-Sammlungs-API oder -Einkaufs-API aus Ihrem Dienst</span><span class="sxs-lookup"><span data-stu-id="98516-202">Step 5: Call the Windows Store collection API or purchase API from your service</span></span>

<span data-ttu-id="98516-203">Wenn Ihr Dienst über einen WindowsStore-ID-Schlüssel verfügt, der den Zugriff auf die Produkteigentümerinformationen eines bestimmten Benutzers ermöglicht, kann der Dienst wie folgt die Windows Store-Sammlungs-API oder -Einkaufs-API aufrufen.</span><span class="sxs-lookup"><span data-stu-id="98516-203">After your service has a Windows Store ID key that enables it to access a specific user's product ownership information, your service can call the Windows Store collection API or purchase API by following these instructions:</span></span>

* [<span data-ttu-id="98516-204">Produktabfrage</span><span class="sxs-lookup"><span data-stu-id="98516-204">Query for products</span></span>](query-for-products.md)
* [<span data-ttu-id="98516-205">Melden von Verbrauchsprodukten als erfüllt</span><span class="sxs-lookup"><span data-stu-id="98516-205">Report consumable products as fulfilled</span></span>](report-consumable-products-as-fulfilled.md)
* [<span data-ttu-id="98516-206">Gewähren kostenloser Produkte</span><span class="sxs-lookup"><span data-stu-id="98516-206">Grant free products</span></span>](grant-free-products.md)
* [<span data-ttu-id="98516-207">Abrufen von Abonnements für einen Benutzer</span><span class="sxs-lookup"><span data-stu-id="98516-207">Get subscriptions for a user</span></span>](get-subscriptions-for-a-user.md)
* [<span data-ttu-id="98516-208">Ändern des Abrechnungszustands eines Abonnements für Benutzer</span><span class="sxs-lookup"><span data-stu-id="98516-208">Change the billing state of a subscription for a user</span></span>](change-the-billing-state-of-a-subscription-for-a-user.md)

<span data-ttu-id="98516-209">Übergeben Sie bei jedem Szenario die folgenden Informationen an die API:</span><span class="sxs-lookup"><span data-stu-id="98516-209">For each scenario, pass the following information to the API:</span></span>

-   <span data-ttu-id="98516-210">Das AzureAD-Zugriffstoken, das Sie zuvor mit dem Zielgruppen-URI `https://onestore.microsoft.com` erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="98516-210">The Azure AD access token that you created earlier with the `https://onestore.microsoft.com` audience URI.</span></span> <span data-ttu-id="98516-211">Dieses Token stellt die Herausgeberidentität dar.</span><span class="sxs-lookup"><span data-stu-id="98516-211">This token represents your publisher identity.</span></span> <span data-ttu-id="98516-212">Übergeben Sie das Token im Anforderungsheader.</span><span class="sxs-lookup"><span data-stu-id="98516-212">Pass this token in the request header.</span></span>
-   <span data-ttu-id="98516-213">Den WindowsStore-ID-Schlüssel, den Sie aus clientseitigem Code in Ihrer App abgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="98516-213">The Windows Store ID key you retrieved from client-side code in your app.</span></span> <span data-ttu-id="98516-214">Dieser Schlüssel stellt die Identität des Benutzers dar, auf dessen Produktbesitzerinformationen Sie zugreifen möchten.</span><span class="sxs-lookup"><span data-stu-id="98516-214">This key represents the identity of the user whose product ownership information you want to access.</span></span>

<span id="claims"/>
## <a name="claims-in-a-windows-store-id-key"></a><span data-ttu-id="98516-215">Ansprüche in einem Windows Store-ID-Schlüssel</span><span class="sxs-lookup"><span data-stu-id="98516-215">Claims in a Windows Store ID key</span></span>

<span data-ttu-id="98516-216">Ein Windows Store-ID-Schlüssel ist ein JSON Web Token (JWT), das die Identität des Benutzers darstellt, auf dessen Produktbesitzerinformationen Sie zugreifen möchten.</span><span class="sxs-lookup"><span data-stu-id="98516-216">A Windows Store ID key is a JSON Web Token (JWT) that represents the identity of the user whose product ownership information you want to access.</span></span> <span data-ttu-id="98516-217">Bei der Decodierung unter Verwendung von Base64 enthält ein Windows Store-ID-Schlüssel die folgenden Ansprüche.</span><span class="sxs-lookup"><span data-stu-id="98516-217">When decoded using Base64, a Windows Store ID key contains the following claims.</span></span>

* `iat`<span data-ttu-id="98516-218">:&nbsp;&nbsp;&nbsp;Gibt den Ausgabezeitpunkt des Schlüssels an.</span><span class="sxs-lookup"><span data-stu-id="98516-218">:&nbsp;&nbsp;&nbsp;Identifies the time at which the key was issued.</span></span> <span data-ttu-id="98516-219">Mit diesem Anspruch kann das Alter des Tokens bestimmt werden.</span><span class="sxs-lookup"><span data-stu-id="98516-219">This claim can be used to determine the age of the token.</span></span> <span data-ttu-id="98516-220">Dieser Wert wird als Epoche ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="98516-220">This value is expressed as epoch time.</span></span>
* `iss`<span data-ttu-id="98516-221">:&nbsp;&nbsp;&nbsp;Gibt den Aussteller an.</span><span class="sxs-lookup"><span data-stu-id="98516-221">:&nbsp;&nbsp;&nbsp;Identifies the issuer.</span></span> <span data-ttu-id="98516-222">Dieser hat den gleichen Wert wie der `aud`-Anspruch.</span><span class="sxs-lookup"><span data-stu-id="98516-222">This has the same value as the `aud` claim.</span></span>
* `aud`<span data-ttu-id="98516-223">:&nbsp;&nbsp;&nbsp;Gibt die Zielgruppe an.</span><span class="sxs-lookup"><span data-stu-id="98516-223">:&nbsp;&nbsp;&nbsp;Identifies the audience.</span></span> <span data-ttu-id="98516-224">Muss einem der folgenden Werte entsprechen: `https://collections.mp.microsoft.com/v6.0/keys` oder `https://purchase.mp.microsoft.com/v6.0/keys`.</span><span class="sxs-lookup"><span data-stu-id="98516-224">Must be one of the following values: `https://collections.mp.microsoft.com/v6.0/keys` or `https://purchase.mp.microsoft.com/v6.0/keys`.</span></span>
* `exp`<span data-ttu-id="98516-225">:&nbsp;&nbsp;&nbsp;Gibt die Ablaufzeit an, nach der der Schlüssel nicht mehr für Verarbeitungsvorgänge akzeptiert wird, außer für die Verlängerung von Schlüsseln.</span><span class="sxs-lookup"><span data-stu-id="98516-225">:&nbsp;&nbsp;&nbsp;Identifies the expiration time on or after which the key will no longer be accepted for processing anything except for renewing keys.</span></span> <span data-ttu-id="98516-226">Der Wert dieses Anspruchs wird als Epoche ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="98516-226">The value of this claim is expressed as epoch time.</span></span>
* `nbf`<span data-ttu-id="98516-227">&nbsp;&nbsp;&nbsp;Gibt die Zeit an, zu der das Token für die Verarbeitung akzeptiert wird.</span><span class="sxs-lookup"><span data-stu-id="98516-227">:&nbsp;&nbsp;&nbsp;Identifies the time at which the token will be accepted for processing.</span></span> <span data-ttu-id="98516-228">Der Wert dieses Anspruchs wird als Epoche ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="98516-228">The value of this claim is expressed as epoch time.</span></span>
* `http://schemas.microsoft.com/marketplace/2015/08/claims/key/clientId`<span data-ttu-id="98516-229">:&nbsp;&nbsp;&nbsp;Die Client-ID, die den Entwickler angibt.</span><span class="sxs-lookup"><span data-stu-id="98516-229">:&nbsp;&nbsp;&nbsp;The client ID that identifies the developer.</span></span>
* `http://schemas.microsoft.com/marketplace/2015/08/claims/key/payload`<span data-ttu-id="98516-230">:&nbsp;&nbsp;&nbsp;Eine opake (verschlüsselte und Base64-codierte) Nutzlast mit Informationen, die ausschließlich von WindowsStore-Diensten verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="98516-230">:&nbsp;&nbsp;&nbsp;An opaque payload (encrypted and Base64 encoded) that contains information that is intended only for use by Windows Store services.</span></span>
* `http://schemas.microsoft.com/marketplace/2015/08/claims/key/userId`<span data-ttu-id="98516-231">:&nbsp;&nbsp;&nbsp;Eine Benutzer-ID, die den aktuellen Benutzer im Kontext Ihrer Dienste angibt.</span><span class="sxs-lookup"><span data-stu-id="98516-231">:&nbsp;&nbsp;&nbsp;A user ID that identifies the current user in the context of your services.</span></span> <span data-ttu-id="98516-232">Dies ist der gleiche Wert, den Sie an den optionalen *publisherUserId*-Parameter der [Methode zum Erstellen des Schlüssels](#step-4) übergeben.</span><span class="sxs-lookup"><span data-stu-id="98516-232">This is the same value you pass into the optional *publisherUserId* parameter of the [method you use to create the key](#step-4).</span></span>
* `http://schemas.microsoft.com/marketplace/2015/08/claims/key/refreshUri`<span data-ttu-id="98516-233">:&nbsp;&nbsp;&nbsp;Der URI, mit dem Sie den Schlüssel verlängern können.</span><span class="sxs-lookup"><span data-stu-id="98516-233">:&nbsp;&nbsp;&nbsp;The URI that you can use to renew the key.</span></span>

<span data-ttu-id="98516-234">Hier ist ein Beispiel für einen decodierten WindowsStore-ID-Schlüsselkopf.</span><span class="sxs-lookup"><span data-stu-id="98516-234">Here is an example of a decoded Windows Store ID key header.</span></span>

```json
{
    "typ":"JWT",
    "alg":"RS256",
    "x5t":"agA_pgJ7Twx_Ex2_rEeQ2o5fZ5g"
}
```

<span data-ttu-id="98516-235">Hier ein Beispiel für einen decodierten Satz von Windows Store-ID-Schlüsselansprüchen.</span><span class="sxs-lookup"><span data-stu-id="98516-235">Here is an example of a decoded Windows Store ID key claim set.</span></span>

```json
{
    "http://schemas.microsoft.com/marketplace/2015/08/claims/key/clientId": "1d5773695a3b44928227393bfef1e13d",
    "http://schemas.microsoft.com/marketplace/2015/08/claims/key/payload": "ZdcOq0/N2rjytCRzCHSqnfczv3f0343wfSydx7hghfu0snWzMqyoAGy5DSJ5rMSsKoQFAccs1iNlwlGrX+/eIwh/VlUhLrncyP8c18mNAzAGK+lTAd2oiMQWRRAZxPwGrJrwiq2fTq5NOVDnQS9Za6/GdRjeiQrv6c0x+WNKxSQ7LV/uH1x+IEhYVtDu53GiXIwekltwaV6EkQGphYy7tbNsW2GqxgcoLLMUVOsQjI+FYBA3MdQpalV/aFN4UrJDkMWJBnmz3vrxBNGEApLWTS4Bd3cMswXsV9m+VhOEfnv+6PrL2jq8OZFoF3FUUpY8Fet2DfFr6xjZs3CBS1095J2yyNFWKBZxAXXNjn+zkvqqiVRjjkjNajhuaNKJk4MGHfk2rZiMy/aosyaEpCyncdisHVSx/S4JwIuxTnfnlY24vS0OXy7mFiZjjB8qL03cLsBXM4utCyXSIggb90GAx0+EFlVoJD7+ZKlm1M90xO/QSMDlrzFyuqcXXDBOnt7rPynPTrOZLVF+ODI5HhWEqArkVnc5MYnrZD06YEwClmTDkHQcxCvU+XUEvTbEk69qR2sfnuXV4cJRRWseUTfYoGyuxkQ2eWAAI1BXGxYECIaAnWF0W6ThweL5ZZDdadW9Ug5U3fZd4WxiDlB/EZ3aTy8kYXTW4Uo0adTkCmdLibw=",
    "http://schemas.microsoft.com/marketplace/2015/08/claims/key/userId": "infusQMLaYCrgtC0d/SZWoPB4FqLEwHXgZFuMJ6TuTY=",
    "http://schemas.microsoft.com/marketplace/2015/08/claims/key/refreshUri": "https://collections.mp.microsoft.com/v6.0/b2b/keys/renew",
    "iat": 1442395542,
    "iss": "https://collections.mp.microsoft.com/v6.0/keys",
    "aud": "https://collections.mp.microsoft.com/v6.0/keys",
    "exp": 1450171541,
    "nbf": 1442391941
}
```

## <a name="related-topics"></a><span data-ttu-id="98516-236">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="98516-236">Related topics</span></span>

* [<span data-ttu-id="98516-237">Produktabfrage</span><span class="sxs-lookup"><span data-stu-id="98516-237">Query for products</span></span>](query-for-products.md)
* [<span data-ttu-id="98516-238">Melden von Verbrauchsprodukten als erfüllt</span><span class="sxs-lookup"><span data-stu-id="98516-238">Report consumable products as fulfilled</span></span>](report-consumable-products-as-fulfilled.md)
* [<span data-ttu-id="98516-239">Gewähren kostenloser Produkte</span><span class="sxs-lookup"><span data-stu-id="98516-239">Grant free products</span></span>](grant-free-products.md)
* [<span data-ttu-id="98516-240">Abrufen von Abonnements für einen Benutzer</span><span class="sxs-lookup"><span data-stu-id="98516-240">Get subscriptions for a user</span></span>](get-subscriptions-for-a-user.md)
* [<span data-ttu-id="98516-241">Ändern des Abrechnungszustands eines Abonnements für einen Benutzer</span><span class="sxs-lookup"><span data-stu-id="98516-241">Change the billing state of a subscription for a user</span></span>](change-the-billing-state-of-a-subscription-for-a-user.md)
* [<span data-ttu-id="98516-242">Verlängern eines Windows Store-ID-Schlüssels</span><span class="sxs-lookup"><span data-stu-id="98516-242">Renew a Windows Store ID key</span></span>](renew-a-windows-store-id-key.md)
* [<span data-ttu-id="98516-243">Integrieren von Anwendungen in Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="98516-243">Integrating Applications with Azure Active Directory</span></span>](http://go.microsoft.com/fwlink/?LinkId=722502)
* [<span data-ttu-id="98516-244">Grundlegendes zum AzureActiveDirectory-Anwendungsmanifest</span><span class="sxs-lookup"><span data-stu-id="98516-244">Understanding the Azure Active Directory application manifest</span></span>]( http://go.microsoft.com/fwlink/?LinkId=722500)
* [<span data-ttu-id="98516-245">Unterstützte Token- und Anspruchstypen</span><span class="sxs-lookup"><span data-stu-id="98516-245">Supported Token and Claim Types</span></span>](http://go.microsoft.com/fwlink/?LinkId=722501)
