---
author: Xansky
Description: Whether your app is free or not, you can sell content, other apps, or new app functionality (such as unlocking the next level of a game) from right within the app. Here we show you how to enable these products in your app.
title: Unterstützen des Kaufs von In-App-Produkten
ms.assetid: D158E9EB-1907-4173-9889-66507957BD6B
keywords: UWP, Add-Ons, In-App-Käufe, IAPs Windows.ApplicationModel.Store
ms.author: mhopkins
ms.date: 08/25/2017
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: 89e9fff8f041c4beb2a897c7be75b2f6e009f809
ms.sourcegitcommit: e38b334edb82bf2b1474ba686990f4299b8f59c7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/14/2018
ms.locfileid: "6861053"
---
# <a name="enable-in-app-product-purchases"></a><span data-ttu-id="92957-103">Unterstützen von In-App-Produktkäufen</span><span class="sxs-lookup"><span data-stu-id="92957-103">Enable in-app product purchases</span></span>

<span data-ttu-id="92957-104">Sie können unabhängig davon, ob Ihre App kostenlos oder kostenpflichtig ist, Inhalte, andere Apps oder neue App-Funktionen (wie das Freischalten des nächsten Levels eines Spiels) direkt in der App verkaufen.</span><span class="sxs-lookup"><span data-stu-id="92957-104">Whether your app is free or not, you can sell content, other apps, or new app functionality (such as unlocking the next level of a game) from right within the app.</span></span> <span data-ttu-id="92957-105">Hier zeigen wir Ihnen, wie Sie diese Produkte in Ihrer App aktivieren können.</span><span class="sxs-lookup"><span data-stu-id="92957-105">Here we show you how to enable these products in your app.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="92957-106">Dieser Artikel beschreibt, wie Sie Mitglieder des [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx)-Namespace verwenden, um In-App-Produktkäufe zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="92957-106">This article demonstrates how to use members of the [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) namespace to enable in-app product purchases.</span></span> <span data-ttu-id="92957-107">Dieser Namespace wird nicht mehr mit neuen Funktionen aktualisiert, daher wird empfohlen, dass Sie stattdessen den [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) Namespace verwenden.</span><span class="sxs-lookup"><span data-stu-id="92957-107">This namespace is no longer being updated with new features, and we recommend that you use the [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) namespace instead.</span></span> <span data-ttu-id="92957-108">Der **Windows.Services.Store** -Namespace unterstützt die neuesten Add-on-Typen, z. B. Store verwalteten Endverbraucher-Add-Ons und Abonnements, und wurde entwickelt, um die Kompatibilität mit künftigen Arten von Produkten und Features von Partner Center und dem Store unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="92957-108">The **Windows.Services.Store** namespace supports the latest add-on types, such as Store-managed consumable add-ons and subscriptions, and is designed to be compatible with future types of products and features supported by Partner Center and the Store.</span></span> <span data-ttu-id="92957-109">Der **Windows.Services.Store**-Namespace wurde in Windows10, Version 1607, eingeführt und kann nur in Projekten für die **Windows10 Anniversary Edition (10.0; Build 14393)** oder einer neueren Version in Visual Studio verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="92957-109">The **Windows.Services.Store** namespace was introduced in Windows 10, version 1607, and it can only be used in projects that target **Windows 10 Anniversary Edition (10.0; Build 14393)** or a later release in Visual Studio.</span></span> <span data-ttu-id="92957-110">Weitere Informationen zum Aktivieren von in-app-Produktkäufe mit dem **Windows.Services.Store** -Namespace finden Sie [in diesem Artikel](enable-in-app-purchases-of-apps-and-add-ons.md).</span><span class="sxs-lookup"><span data-stu-id="92957-110">For more information about enabling in-app product purchases using the **Windows.Services.Store** namespace, see [this article](enable-in-app-purchases-of-apps-and-add-ons.md).</span></span>

> [!NOTE]
> <span data-ttu-id="92957-111">In-App-Produkte können nicht in einer Testversion einer App angeboten werden.</span><span class="sxs-lookup"><span data-stu-id="92957-111">In-app products cannot be offered from a trial version of an app.</span></span> <span data-ttu-id="92957-112">Kunden, die eine Testversion Ihrer App verwenden, können nur dann In-App-Produkte kaufen, wenn sie eine Vollversion der App kaufen.</span><span class="sxs-lookup"><span data-stu-id="92957-112">Customers using a trial version of your app can only buy an in-app product if they purchase a full version of your app.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="92957-113">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="92957-113">Prerequisites</span></span>

-   <span data-ttu-id="92957-114">Eine Windows-App zum Hinzufügen von Features zum Kauf für Kunden.</span><span class="sxs-lookup"><span data-stu-id="92957-114">A Windows app in which to add features for customers to buy.</span></span>
-   <span data-ttu-id="92957-115">Wenn Sie zum ersten Mal Code für neue In-App-Produkte schreiben und testen, müssen Sie anstelle des [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766)-Objekts das [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765)-Objekt verwenden.</span><span class="sxs-lookup"><span data-stu-id="92957-115">When you code and test new in-app products for the first time, you must use the [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) object instead of the [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) object.</span></span> <span data-ttu-id="92957-116">Auf diese Weise können Sie überprüfen, ob die Lizenzlogik simulierte Aufrufe an den Lizenzserver und nicht an den Liveserver verwendet.</span><span class="sxs-lookup"><span data-stu-id="92957-116">This way you can verify your license logic using simulated calls to the license server instead of calling the live server.</span></span> <span data-ttu-id="92957-117">Dazu müssen Sie die Datei mit dem Namen „WindowsStoreProxy.xml“ in %userprofile%\\AppData\\local\\packages\\&lt;Paketname&gt;\\LocalState\\Microsoft\\Windows Store\\ApiData anpassen.</span><span class="sxs-lookup"><span data-stu-id="92957-117">To do this, you need to customize the file named WindowsStoreProxy.xml in %userprofile%\\AppData\\local\\packages\\&lt;package name&gt;\\LocalState\\Microsoft\\Windows Store\\ApiData.</span></span> <span data-ttu-id="92957-118">Diese Datei wird vom Simulator in Microsoft Visual Studio erstellt, wenn Sie Ihre App zum ersten Mal ausführen. Sie können jedoch auch eine benutzerdefinierte Version dieser Datei zur Laufzeit laden.</span><span class="sxs-lookup"><span data-stu-id="92957-118">The Microsoft Visual Studio simulator creates this file when you run your app for the first time—or you can also load a custom one at runtime.</span></span> <span data-ttu-id="92957-119">Weitere Informationen finden Sie unter [Verwenden der Datei „WindowsStoreProxy.xml“ mit CurrentAppSimulator](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md#proxy).</span><span class="sxs-lookup"><span data-stu-id="92957-119">For more info, see [Using the WindowsStoreProxy.xml file with CurrentAppSimulator](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md#proxy).</span></span>
-   <span data-ttu-id="92957-120">In diesem Thema wird auch auf Codebeispiele verwiesen, die im [Store-Beispiel](https://github.com/Microsoft/Windows-universal-samples/tree/win10-1507/Samples/Store) zu finden sind.</span><span class="sxs-lookup"><span data-stu-id="92957-120">This topic also references code examples provided in the [Store sample](https://github.com/Microsoft/Windows-universal-samples/tree/win10-1507/Samples/Store).</span></span> <span data-ttu-id="92957-121">Dieses Beispiel bietet eine hervorragende Möglichkeit, die verschiedenen Monetarisierungsoptionen zu testen, die für Universelle Windows-Plattform (UWP)-Apps verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="92957-121">This sample is a great way to get hands-on experience with the different monetization options provided for Universal Windows Platform (UWP) apps.</span></span>

## <a name="step-1-initialize-the-license-info-for-your-app"></a><span data-ttu-id="92957-122">Schritt 1: Initialisieren der Lizenzinfos für Ihre App</span><span class="sxs-lookup"><span data-stu-id="92957-122">Step 1: Initialize the license info for your app</span></span>

<span data-ttu-id="92957-123">Rufen Sie bei der Initialisierung Ihrer App das [LicenseInformation](https://msdn.microsoft.com/library/windows/apps/br225157)-Objekt für Ihre App ab, indem Sie [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) oder [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) initialisieren, um Käufe von In-App-Produkten zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="92957-123">When your app is initializing, get the [LicenseInformation](https://msdn.microsoft.com/library/windows/apps/br225157) object for your app by initializing the [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) or [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) to enable purchases of an in-app product.</span></span>

> [!div class="tabbedCodeSnippets"]
[!code-cs[EnableInAppPurchases](./code/InAppPurchasesAndLicenses/cs/EnableInAppPurchases.cs#InitializeLicenseTest)]

## <a name="step-2-add-the-in-app-offers-to-your-app"></a><span data-ttu-id="92957-124">Schritt 2: Hinzufügen von In-App-Produktangeboten zu Ihrer App</span><span class="sxs-lookup"><span data-stu-id="92957-124">Step 2: Add the in-app offers to your app</span></span>

<span data-ttu-id="92957-125">Erstellen Sie für jedes Feature, das über ein In-App-Produkt zur Verfügung stehen soll, ein Angebot in der App, und fügen Sie es Ihrer App hinzu.</span><span class="sxs-lookup"><span data-stu-id="92957-125">For each feature that you want to make available through an in-app product, create an offer and add it to your app.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="92957-126">Sie müssen Ihrer App alle In-App-Produkte hinzufügen, die Sie Ihren Kunden zur Verfügung stellen möchten, bevor Sie sie an den Store übermitteln.</span><span class="sxs-lookup"><span data-stu-id="92957-126">You must add all the in-app products that you want to present to your customers to your app before you submit it to the Store.</span></span> <span data-ttu-id="92957-127">Wenn Sie zu einem späteren Zeitpunkt neue In-App-Produkte hinzufügen möchten, müssen Sie die App aktualisieren und eine neue Version übermitteln.</span><span class="sxs-lookup"><span data-stu-id="92957-127">If you want to add new in-app products later, you must update your app and re-submit a new version.</span></span>

1.  **<span data-ttu-id="92957-128">Erstellen Sie ein Token für In-App-Angebote</span><span class="sxs-lookup"><span data-stu-id="92957-128">Create an in-app offer token</span></span>**

    <span data-ttu-id="92957-129">Sie identifizieren die einzelnen In-App-Produkte Ihrer App durch Token.</span><span class="sxs-lookup"><span data-stu-id="92957-129">You identify each in-app product in your app by a token.</span></span> <span data-ttu-id="92957-130">Bei diesem Token handelt es sich um eine Zeichenfolge, die Sie festlegen und in Ihrer App und im Store verwenden, um ein bestimmtes In-App-Produkt zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="92957-130">This token is a string that you define and use in your app and in the Store to identify a specific in-app product.</span></span> <span data-ttu-id="92957-131">Geben Sie ihm einen (für Ihre App) eindeutigen und aussagekräftigen Namen, sodass Sie beim Schreiben des Codes schnell das richtige Feature ermitteln können, für das es steht.</span><span class="sxs-lookup"><span data-stu-id="92957-131">Give it a unique (to your app) and meaningful name so that you can quickly identify the correct feature it represents while you are coding.</span></span> <span data-ttu-id="92957-132">Im Folgenden finden Sie einige Beispiele für Namen:</span><span class="sxs-lookup"><span data-stu-id="92957-132">Here are some examples of names:</span></span>

    * <span data-ttu-id="92957-133">"SpaceMissionLevel4"</span><span class="sxs-lookup"><span data-stu-id="92957-133">"SpaceMissionLevel4"</span></span>
    * <span data-ttu-id="92957-134">"ContosoCloudSave"</span><span class="sxs-lookup"><span data-stu-id="92957-134">"ContosoCloudSave"</span></span>
    * <span data-ttu-id="92957-135">„RainbowThemePack“</span><span class="sxs-lookup"><span data-stu-id="92957-135">"RainbowThemePack"</span></span>

  > [!NOTE]
  > <span data-ttu-id="92957-136">Das in-app-angebotstoken, das Sie in Ihrem Code verwenden muss entsprechen den [Produkt-ID](../publish/set-your-add-on-product-id.md#product-id) -Wert, die Sie, wenn angeben Sie [das entsprechende Add-on für Ihre app im Partner Center zu definieren](../publish/add-on-submissions.md).</span><span class="sxs-lookup"><span data-stu-id="92957-136">The in-app offer token that you use in your code must match the [product ID](../publish/set-your-add-on-product-id.md#product-id) value you specify when you [define the corresponding add-on for your app in Partner Center](../publish/add-on-submissions.md).</span></span>

2.  **<span data-ttu-id="92957-137">Schreiben Sie den Code für das Feature in einem Bedingungsblock.</span><span class="sxs-lookup"><span data-stu-id="92957-137">Code the feature in a conditional block</span></span>**

    <span data-ttu-id="92957-138">Sie müssen den Code für jedes Feature, das mit einem In-App-Produkt verknüpft ist, in einen Bedingungsblock aufnehmen. Dieser Bedingungsblock überprüft, ob ein Kunde eine Lizenz für die Verwendung dieses Features besitzt.</span><span class="sxs-lookup"><span data-stu-id="92957-138">You must put the code for each feature that is associated with an in-app product in a conditional block that tests to see if the customer has a license to use that feature.</span></span>

    <span data-ttu-id="92957-139">Im folgenden Beispiel wird gezeigt, wie Sie Code für das Produkt-Feature **featureName** in einem lizenzspezifischen Bedingungsblock kodieren.</span><span class="sxs-lookup"><span data-stu-id="92957-139">Here's an example that shows how you can code a product feature named **featureName** in a license-specific conditional block.</span></span> <span data-ttu-id="92957-140">Die Zeichenfolge **featureName** ist das Token, das dieses Produkt eindeutig in der App und im Store identifiziert.</span><span class="sxs-lookup"><span data-stu-id="92957-140">The string, **featureName**,is the token that uniquely identifies this product within the app and is also used to identify it in the Store.</span></span>

    > [!div class="tabbedCodeSnippets"]
    [!code-cs[EnableInAppPurchases](./code/InAppPurchasesAndLicenses/cs/EnableInAppPurchases.cs#CodeFeature)]

3.  **<span data-ttu-id="92957-141">Fügen Sie die Kauf-UI für dieses Feature hinzu.</span><span class="sxs-lookup"><span data-stu-id="92957-141">Add the purchase UI for this feature</span></span>**

    <span data-ttu-id="92957-142">Ihre App muss den Kunden außerdem die Möglichkeit bieten, das über das In-App-Produkt angebotene Produkt oder Feature zu kaufen.</span><span class="sxs-lookup"><span data-stu-id="92957-142">Your app must also provide a way for your customers to purchase the product or feature offered by the in-app product.</span></span> <span data-ttu-id="92957-143">Das Feature oder Produkt kann nicht auf die gleiche Weise wie die gesamte App im Store erworben werden.</span><span class="sxs-lookup"><span data-stu-id="92957-143">They can't purchase them through the Store in the same way they purchased the full app.</span></span>

    <span data-ttu-id="92957-144">Hier finden Sie ein Beispiel dafür, wie Sie testen, ob der Kunde bereits ein In-App-Produkt besitzt. Es veranschaulicht außerdem, wie das Kaufdialogfeld angezeigt wird, sodass der Kunde es ggf. erwerben kann.</span><span class="sxs-lookup"><span data-stu-id="92957-144">Here's how to test to see if your customer already owns an in-app product and, if they don't, displays the purchase dialog so they can buy it.</span></span> <span data-ttu-id="92957-145">Ersetzen Sie den Kommentar „show the purchase dialog“ durch den benutzerdefinierten Code für das Kaufdialogfeld (z.B. ein Fenster mit der Schaltfläche „Diese App kaufen“)</span><span class="sxs-lookup"><span data-stu-id="92957-145">Replace the comment "show the purchase dialog" with your custom code for the purchase dialog (such as a page with a friendly "Buy this app!"</span></span> <span data-ttu-id="92957-146">.</span><span class="sxs-lookup"><span data-stu-id="92957-146">button).</span></span>

    > [!div class="tabbedCodeSnippets"]
    [!code-cs[EnableInAppPurchases](./code/InAppPurchasesAndLicenses/cs/EnableInAppPurchases.cs#BuyFeature)]

## <a name="step-3-change-the-test-code-to-the-final-calls"></a><span data-ttu-id="92957-147">Schritt 3: Ändern Sie den Testcode für die endgültigen Aufrufe.</span><span class="sxs-lookup"><span data-stu-id="92957-147">Step 3: Change the test code to the final calls</span></span>

<span data-ttu-id="92957-148">Dies ist ein einfacher Schritt: Ändern Sie im Code Ihrer App alle Verweise auf [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) in [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765).</span><span class="sxs-lookup"><span data-stu-id="92957-148">This is an easy step: change every reference to [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) to [CurrentApp](https://msdn.microsoft.com/library/windows/apps/hh779765) in your app's code.</span></span> <span data-ttu-id="92957-149">Sie müssen die Datei „WindowsStoreProxy.xml“ nicht mehr bereitstellen. Entfernen Sie diese daher aus dem Pfad Ihrer App. Sie können sie jedoch zu späteren Referenzzwecken speichern, wenn Sie im nächsten Schritt das Angebot in der App konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="92957-149">You don't need to provide the WindowsStoreProxy.xml file any longer, so remove it from your app's path (although you may want to save it for reference when you configure the in-app offer in the next step).</span></span>

## <a name="step-4-configure-the-in-app-product-offer-in-the-store"></a><span data-ttu-id="92957-150">Schritt 4: Konfigurieren des In-App-Produktangebots im Store</span><span class="sxs-lookup"><span data-stu-id="92957-150">Step 4: Configure the in-app product offer in the Store</span></span>

<span data-ttu-id="92957-151">Navigieren Sie im Partner Center zu Ihrer app und [ein Add-on zu erstellen](../publish/add-on-submissions.md) , die Ihrem in-app-Produktangebot entspricht.</span><span class="sxs-lookup"><span data-stu-id="92957-151">In Partner Center, navigate to your app and [create an add-on](../publish/add-on-submissions.md) that matches your in-app product offer.</span></span> <span data-ttu-id="92957-152">Definieren Sie Produkt-ID, Typ, Preis und andere Eigenschaften für das Add-On.</span><span class="sxs-lookup"><span data-stu-id="92957-152">Define the product ID, type, price, and other properties for your add-on.</span></span> <span data-ttu-id="92957-153">Die Konfiguration muss genau mit der Konfiguration in der Datei WindowsStoreProxy.xml übereinstimmen, die Sie beim Testen festlegen.</span><span class="sxs-lookup"><span data-stu-id="92957-153">Make sure that you configure it identically to the configuration you set in WindowsStoreProxy.xml when testing.</span></span>

  > [!NOTE]
  > <span data-ttu-id="92957-154">Das in-app-angebotstoken, das Sie in Ihrem Code verwenden, muss die [Produkt-ID](../publish/set-your-add-on-product-id.md#product-id) -Wert übereinstimmen, die, den Sie für das entsprechende Add-on im Partner Center angeben.</span><span class="sxs-lookup"><span data-stu-id="92957-154">The in-app offer token that you use in your code must match the [product ID](../publish/set-your-add-on-product-id.md#product-id) value you specify for the corresponding add-on in Partner Center.</span></span>

## <a name="remarks"></a><span data-ttu-id="92957-155">Hinweise</span><span class="sxs-lookup"><span data-stu-id="92957-155">Remarks</span></span>

<span data-ttu-id="92957-156">Wenn Sie Ihren Kunden konsumierbare In-App-Produktoptionen (Elemente, die gekauft, verwendet und erneut gekauft werden können, wenn gewünscht) bereitstellen möchten, wechseln Sie zum Thema [Unterstützen von Käufen konsumierbarer In-App-Produkte](enable-consumable-in-app-product-purchases.md).</span><span class="sxs-lookup"><span data-stu-id="92957-156">If you're interested in providing your customers with consumable in-app product options (items that can be purchased, used up, and then purchased again if desired), move on to the [Enable consumable in-app product purchases](enable-consumable-in-app-product-purchases.md) topic.</span></span>

<span data-ttu-id="92957-157">Wenn Sie anhand von Belegen überprüfen möchten, ob ein Kunde einen In-App-Einkauf getätigt hat, lesen Sie den Artikel [Überprüfen von Produktkäufen anhand von Belegen](use-receipts-to-verify-product-purchases.md).</span><span class="sxs-lookup"><span data-stu-id="92957-157">If you need to use receipts to verify that user made an in-app purchase, be sure to review [Use receipts to verify product purchases](use-receipts-to-verify-product-purchases.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="92957-158">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="92957-158">Related topics</span></span>


* [<span data-ttu-id="92957-159">Käufe von konsumierbaren In-App-Produkten aktivieren</span><span class="sxs-lookup"><span data-stu-id="92957-159">Enable consumable in-app product purchases</span></span>](enable-consumable-in-app-product-purchases.md)
* [<span data-ttu-id="92957-160">Verwalten eines großen Katalogs von In-App-Produkten</span><span class="sxs-lookup"><span data-stu-id="92957-160">Manage a large catalog of in-app products</span></span>](manage-a-large-catalog-of-in-app-products.md)
* [<span data-ttu-id="92957-161">Überprüfen von Produktkäufen anhand von Belegen</span><span class="sxs-lookup"><span data-stu-id="92957-161">Use receipts to verify product purchases</span></span>](use-receipts-to-verify-product-purchases.md)
* [<span data-ttu-id="92957-162">Store-Beispiel (zeigt Testversionen und In-App-Einkäufe)</span><span class="sxs-lookup"><span data-stu-id="92957-162">Store sample (demonstrates trials and in-app purchases)</span></span>](https://github.com/Microsoft/Windows-universal-samples/tree/win10-1507/Samples/Store)
