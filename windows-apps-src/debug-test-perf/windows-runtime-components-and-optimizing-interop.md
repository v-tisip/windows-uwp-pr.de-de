---
author: jwmsft
ms.assetid: 9899F6A0-7EDD-4988-A76E-79D7C0C58126
title: Universelle Windows-Plattform-Komponenten und Optimierung der Interoperabilität
description: Erstellen Sie UWP (Universelle Windows-Plattform)-Apps, die UWP-Komponenten verwenden und mit systemeigenen und verwalteten Typen zusammenarbeiten, und vermeiden Sie gleichzeitig Probleme mit der Interoperabilitätsleistung.
ms.author: jimwalk
ms.date: 02/08/2017
ms.topic: article
keywords: windows10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: 726dc4aaa34b9b68aa198e236abcef57b78b21f4
ms.sourcegitcommit: 3257416aebb5a7b1515e107866806f8bd57845a8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/17/2018
ms.locfileid: "7161203"
---
# <a name="uwp-components-and-optimizing-interop"></a><span data-ttu-id="1c230-104">UWP-Komponenten und Optimieren der Interoperabilität</span><span class="sxs-lookup"><span data-stu-id="1c230-104">UWP Components and optimizing interop</span></span>


<span data-ttu-id="1c230-105">Erstellen Sie UWP (Universelle Windows-Plattform)-Apps, die UWP-Komponenten verwenden, mit systemeigenen und verwalteten Typen zusammenarbeiten und gleichzeitig Probleme mit der Interopleistung vermeiden.</span><span class="sxs-lookup"><span data-stu-id="1c230-105">Create Universal Windows Platform (UWP) apps that use UWP Components and interop between native and managed types while avoiding interop performance issues.</span></span>

## <a name="best-practices-for-interoperability-with-uwp-components"></a><span data-ttu-id="1c230-106">Bewährte Methoden für die Interoperabilität mit UWP-Komponenten</span><span class="sxs-lookup"><span data-stu-id="1c230-106">Best practices for interoperability with UWP Components</span></span>

<span data-ttu-id="1c230-107">Wenn Sie nicht vorsichtig sind, kann die Verwendung von UWP-Komponenten die Leistung Ihrer App stark beeinträchtigen.</span><span class="sxs-lookup"><span data-stu-id="1c230-107">If you are not careful, using UWP Components can have a large impact on your app performance.</span></span> <span data-ttu-id="1c230-108">In diesem Abschnitt wird beschrieben, wie Sie eine gute Leistung erzielen, wenn Ihre App UWP-Komponenten verwendet.</span><span class="sxs-lookup"><span data-stu-id="1c230-108">This section discusses how to get good performance when your app uses UWP Components.</span></span>

### <a name="introduction"></a><span data-ttu-id="1c230-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="1c230-109">Introduction</span></span>

<span data-ttu-id="1c230-110">Interoperabilität kann große Auswirkungen auf die Leistung haben, und Sie verwenden sie möglicherweise, ohne es zu bemerken.</span><span class="sxs-lookup"><span data-stu-id="1c230-110">Interoperability can have a big impact on performance and you might be using it without even realizing that you are.</span></span> <span data-ttu-id="1c230-111">Die UWP übernimmt einen Großteil der Interoperabilität für Sie, damit Sie produktiver sein und in anderen Sprachen geschriebenen Code erneut verwenden können.</span><span class="sxs-lookup"><span data-stu-id="1c230-111">The UWP handles a lot of the interoperability for you so that you can be more productive and reuse code that was written in other languages.</span></span> <span data-ttu-id="1c230-112">Sie sollten die Vorteile nutzen, die Ihnen die UWP bietet, müssen aber beachten, dass sie die Leistung beeinträchtigen kann.</span><span class="sxs-lookup"><span data-stu-id="1c230-112">We encourage you to take advantage of what the UWP does for you, but be aware that it can impact performance.</span></span> <span data-ttu-id="1c230-113">In diesem Abschnitt werden Dinge erläutert, die Sie tun können, um die Auswirkungen der Interoperabilität auf die Leistung Ihrer Anwendung zu reduzieren.</span><span class="sxs-lookup"><span data-stu-id="1c230-113">This section discusses things you can do to lessen the impact that interoperability has on your app's performance.</span></span>

<span data-ttu-id="1c230-114">Die UWP verfügt über eine Bibliothek mit Typen, auf die in allen Sprachen zugegriffen werden kann, in denen eine UWP-App geschrieben werden kann.</span><span class="sxs-lookup"><span data-stu-id="1c230-114">The UWP has a library of types that are accessible from any language that can write a UWP app.</span></span> <span data-ttu-id="1c230-115">Sie verwenden die UWP-Typen in C# oder MicrosoftVisual Basic auf die gleiche Weise wie .NET-Objekte.</span><span class="sxs-lookup"><span data-stu-id="1c230-115">You use the UWP types in C# or Microsoft Visual Basic the same way you use .NET objects.</span></span> <span data-ttu-id="1c230-116">Sie müssen in der Plattform keine Methodenaufrufe vornehmen, um auf die UWP-Komponenten zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="1c230-116">You don't need to make platform invoke method calls to access the UWP components.</span></span> <span data-ttu-id="1c230-117">Dadurch wird das Schreiben Ihrer Apps einfacher, aber es muss unbedingt beachtet werden, dass möglicherweise mehr Interoperabilität auftritt, als Sie erwarten.</span><span class="sxs-lookup"><span data-stu-id="1c230-117">This makes writing your apps much less complex, but it is important to realize that there might be more interoperability occurring than you expect.</span></span> <span data-ttu-id="1c230-118">Wenn eine UWP-Komponente in einer anderen Sprache als C# oder Visual Basic geschrieben wird, überschreiten Sie beim Verwenden dieser Komponente die Interoperabilitätsgrenzen.</span><span class="sxs-lookup"><span data-stu-id="1c230-118">If a UWP component is written in a language other than C# or Visual Basic, you cross interoperability boundaries when you use that component.</span></span> <span data-ttu-id="1c230-119">Das Überschreiten der Interoperabilitätsgrenzen kann sich auf die Leistung einer App auswirken.</span><span class="sxs-lookup"><span data-stu-id="1c230-119">Crossing interoperability boundaries can impact the performance of an app.</span></span>

<span data-ttu-id="1c230-120">Wenn Sie eine UWP-App in C# oder Visual Basic entwickeln, verwenden Sie als API-Gruppen am häufigsten UWP-APIs und die .NET-APIs für UWP-Apps.</span><span class="sxs-lookup"><span data-stu-id="1c230-120">When you develop a UWP app in C# or Visual Basic, the two most common set of APIs that you use are the UWP APIs and the .NET APIs for UWP apps.</span></span> <span data-ttu-id="1c230-121">In UWP definierte Typen sind normalerweise in Namespaces enthalten, die mit „Windows“ beginnen.</span><span class="sxs-lookup"><span data-stu-id="1c230-121">In general, types that are defined in the UWP are in namespaces that begin with "Windows."</span></span> <span data-ttu-id="1c230-122">.NET-Typen sind in Namespaces enthalten, die mit „System“ beginnen.</span><span class="sxs-lookup"><span data-stu-id="1c230-122">and .NET types are in namespaces that begin with "System."</span></span> <span data-ttu-id="1c230-123">Es gibt jedoch Ausnahmen.</span><span class="sxs-lookup"><span data-stu-id="1c230-123">There are exceptions, though.</span></span> <span data-ttu-id="1c230-124">Die Verwendung der Typen in .NET für UWP-Apps erfordert keine Interoperabilität.</span><span class="sxs-lookup"><span data-stu-id="1c230-124">The types in .NET for UWP apps do not require interoperability when they are used.</span></span> <span data-ttu-id="1c230-125">Wenn Sie in einem Bereich, in dem die UWP verwendet wird, eine schlechte Leistung feststellen, können Sie stattdessen möglicherweise .NET für UWP-Apps verwenden, um eine bessere Leistung zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="1c230-125">If you find that you have bad performance in an area that uses UWP, you might be able to use .NET for UWP apps instead to get better performance.</span></span>

<span data-ttu-id="1c230-126">**Hinweis:**  der Großteil der UWP-Komponenten, die geliefert mit Windows 10 sind in C++ implementiert, sodass Sie Interoperabilitätsgrenzen überschreiten, wenn Sie sie in c# oder Visual Basic verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c230-126">**Note** Most of the UWP components that ship with Windows10 are implemented in C++ so you cross interoperability boundaries when you use them from C# or Visual Basic.</span></span> <span data-ttu-id="1c230-127">Stellen Sie daher wie immer sicher, dass Sie Ihre App messen, um festzustellen, ob sich die Verwendung der UWP-Komponenten auf die Leistung Ihrer App auswirkt, bevor Sie in Änderungen an Ihrem Code investieren.</span><span class="sxs-lookup"><span data-stu-id="1c230-127">As always, make sure to measure your app to see if using UWP components affects your app's performance before you invest in making changes to your code.</span></span>

<span data-ttu-id="1c230-128">Wenn in diesem Thema von „UWP-Komponenten” die Rede ist, sind Komponenten gemeint, die in einer anderen Sprache als C# oder Visual Basic geschrieben sind.</span><span class="sxs-lookup"><span data-stu-id="1c230-128">In this topic, when we say "UWP components", we mean components that are written in a language other than C# or Visual Basic.</span></span>

 

<span data-ttu-id="1c230-129">Immer wenn Sie auf eine Eigenschaft zugreifen oder eine Methode für eine UWP-Komponente aufrufen, entsteht ein Interoperabilitätsaufwand.</span><span class="sxs-lookup"><span data-stu-id="1c230-129">Each time you access a property or call a method on a UWP component, an interoperability cost is incurred.</span></span> <span data-ttu-id="1c230-130">Das Erstellen einer UWP-Komponente ist tatsächlich aufwendiger als das Erstellen eines .NET-Objekts.</span><span class="sxs-lookup"><span data-stu-id="1c230-130">In fact, creating a UWP component is more costly than creating a .NET object.</span></span> <span data-ttu-id="1c230-131">Gründe dafür sind, dass die UWP Code ausführen muss, der von der Sprache Ihrer App in die Sprache der Komponente übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="1c230-131">The reasons for this are that the UWP must execute code that transitions from your app's language to the component's language.</span></span> <span data-ttu-id="1c230-132">Außerdem müssen die Daten zwischen verwalteten und nicht verwalteten Typen konvertiert werden, wenn Sie Daten an die Komponente übergeben.</span><span class="sxs-lookup"><span data-stu-id="1c230-132">Also, if you pass data to the component, the data must be converted between managed and unmanaged types.</span></span>

### <a name="using-uwp-components-efficiently"></a><span data-ttu-id="1c230-133">Effiziente Verwendung von UWP-Komponenten</span><span class="sxs-lookup"><span data-stu-id="1c230-133">Using UWP Components efficiently</span></span>

<span data-ttu-id="1c230-134">Wenn Sie der Meinung sind, dass Sie eine höhere Leistung benötigen, können Sie sicherstellen, dass Ihr Code die UWP-Komponenten so effizient wie möglich verwendet.</span><span class="sxs-lookup"><span data-stu-id="1c230-134">If you find that you need to get better performance, you can ensure that your code uses UWP components as efficiently as possible.</span></span> <span data-ttu-id="1c230-135">In diesem Abschnitt werden einige Tipps zum Verbessern der Leistung bei Verwendung von UWP-Komponenten erläutert.</span><span class="sxs-lookup"><span data-stu-id="1c230-135">This section discusses some tips for improving performance when you use UWP components.</span></span>

<span data-ttu-id="1c230-136">Es sind viele Aufrufe in einem kurzen Zeitraum erforderlich, damit die Auswirkungen auf die Leistung spürbar werden.</span><span class="sxs-lookup"><span data-stu-id="1c230-136">It takes a significant number of calls in a short period of time for the performance impact to be noticeable.</span></span> <span data-ttu-id="1c230-137">Eine gut entwickelte Anwendung, die Aufrufe von UWP-Komponenten aus Geschäftslogiken und anderem verwalteten Code kapselt, sollte keinen hohen Interoperabilitätsaufwand verursachen.</span><span class="sxs-lookup"><span data-stu-id="1c230-137">A well-designed application that encapsulates calls to UWP components from business logic and other managed code should not incur huge interoperability costs.</span></span> <span data-ttu-id="1c230-138">Wenn Ihre Tests jedoch zeigen, dass die Verwendung der UWP-Komponenten die Leistung Ihrer App beeinträchtigt, helfen Ihnen die in diesem Abschnitt erläuterten Tipps dabei, die Leistung zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="1c230-138">But if your tests indicate that using UWP components is affecting your app's performance, the tips discussed in this section help you improve performance.</span></span>

### <a name="consider-using-net-for-uwp-apps"></a><span data-ttu-id="1c230-139">Erwägen der Verwendung von .NET für UWP-Apps</span><span class="sxs-lookup"><span data-stu-id="1c230-139">Consider using .NET for UWP apps</span></span>

<span data-ttu-id="1c230-140">Es gibt bestimmte Fälle, in denen eine Aufgabe mithilfe der UWP oder .NET für UWP-Apps ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1c230-140">There are certain cases where you can accomplish a task by using either UWP or .NET for UWP apps.</span></span> <span data-ttu-id="1c230-141">Sie sollten .NET-Typen und UWP-Typen nach Möglichkeit nicht mischen.</span><span class="sxs-lookup"><span data-stu-id="1c230-141">It is a good idea to try to not mix .NET types and UWP types.</span></span> <span data-ttu-id="1c230-142">Verwenden Sie die einen oder die anderen Typen.</span><span class="sxs-lookup"><span data-stu-id="1c230-142">Try to stay in one or the other.</span></span> <span data-ttu-id="1c230-143">Beispielweise können Sie einen XML-Datenstrom mithilfe des [**Windows.Data.Xml.Dom.XmlDocument**](https://msdn.microsoft.com/library/windows/apps/BR206173)-Typs (ein UWP-Typ) oder des [**System.Xml.XmlReader**](https://msdn.microsoft.com/library/windows/apps/xaml/system.xml.xmlreader.aspx)-Typs (ein .NET-Typ) analysieren.</span><span class="sxs-lookup"><span data-stu-id="1c230-143">For example, you can parse a stream of xml by using either the [**Windows.Data.Xml.Dom.XmlDocument**](https://msdn.microsoft.com/library/windows/apps/BR206173) type (a UWP type) or the [**System.Xml.XmlReader**](https://msdn.microsoft.com/library/windows/apps/xaml/system.xml.xmlreader.aspx) type (a .NET type).</span></span> <span data-ttu-id="1c230-144">Verwenden Sie die API, die dieselbe Technologie wie der Datenstrom aufweist.</span><span class="sxs-lookup"><span data-stu-id="1c230-144">Use the API that is from the same technology as the stream.</span></span> <span data-ttu-id="1c230-145">Wenn Sie beispielsweise XML aus einem [**MemoryStream**](https://msdn.microsoft.com/library/windows/apps/xaml/system.io.memorystream.aspx) lesen, verwenden Sie den **System.Xml.XmlReader**-Typ, da es sich bei beiden Typen um .NET-Typen handelt.</span><span class="sxs-lookup"><span data-stu-id="1c230-145">For example, if you read xml from a [**MemoryStream**](https://msdn.microsoft.com/library/windows/apps/xaml/system.io.memorystream.aspx), use the **System.Xml.XmlReader** type, because both types are .NET types.</span></span> <span data-ttu-id="1c230-146">Wenn Sie aus einer Datei lesen, verwenden Sie den **Windows.Data.Xml.Dom.XmlDocument**-Typ, da es sich bei den Datei-APIs und **XmlDocument** um UWP-Komponenten handelt.</span><span class="sxs-lookup"><span data-stu-id="1c230-146">If you read from a file, use the **Windows.Data.Xml.Dom.XmlDocument** type because the file APIs and **XmlDocument** are UWP components.</span></span>

### <a name="copy-window-runtime-objects-to-net-types"></a><span data-ttu-id="1c230-147">Kopieren von Windows-Runtime-Objekten in .NET-Typen</span><span class="sxs-lookup"><span data-stu-id="1c230-147">Copy Window Runtime objects to .NET types</span></span>

<span data-ttu-id="1c230-148">Wenn eine UWP-Komponente ein UWP-Objekt zurückgibt, kann es von Vorteil sein, das zurückgegebene Objekt in ein .NET-Objekt zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="1c230-148">When a UWP component returns a UWP object, it might be beneficial to copy the returned object into a .NET object.</span></span> <span data-ttu-id="1c230-149">Zwei Stellen, an denen dies besonders wichtig ist, ist das Verwenden von Sammlungen und Datenströmen.</span><span class="sxs-lookup"><span data-stu-id="1c230-149">Two places where this is especially important is when you're working with collections and streams.</span></span>

<span data-ttu-id="1c230-150">Wenn Sie eine UWP-API aufrufen, die eine Sammlung zurückgibt, und Sie diese Sammlung dann speichern und mehrfach auf sie zugreifen, kann es von Vorteil sein, die Sammlung in eine .NET-Sammlung zu kopieren und ab diesem Zeitpunkt die .NET-Version zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c230-150">If you call a UWP API that returns a collection and then you save and access that collection many times, it might be beneficial to copy the collection into a .NET collection and use the .NET version from then on.</span></span>

### <a name="cache-the-results-of-calls-to-uwp-components-for-later-use"></a><span data-ttu-id="1c230-151">Zwischenspeichern der Ergebnisse von Aufrufen von UWP-Komponenten zur späteren Verwendung</span><span class="sxs-lookup"><span data-stu-id="1c230-151">Cache the results of calls to UWP components for later use</span></span>

<span data-ttu-id="1c230-152">Möglicherweise erzielen Sie eine bessere Leistung, indem Sie Werte in lokalen Variablen speichern, anstatt mehrfach auf einen UWP-Typ zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="1c230-152">You might be able to get better performance by saving values into local variables instead of accessing a UWP type multiple times.</span></span> <span data-ttu-id="1c230-153">Dies kann besonders hilfreich sein, wenn Sie einen Wert innerhalb einer Schleife verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c230-153">This can be especially beneficial if you use a value inside of a loop.</span></span> <span data-ttu-id="1c230-154">Messen Sie Ihre App, um festzustellen, ob sich die Leistung Ihrer App durch die Verwendung lokaler Variablen verbessert.</span><span class="sxs-lookup"><span data-stu-id="1c230-154">Measure your app to see if using local variables improves your app's performance.</span></span> <span data-ttu-id="1c230-155">Mit zwischengespeicherten Werten kann die Geschwindigkeit Ihrer App erhöht werden, da weniger Zeit für die Interoperabilität aufgewendet wird.</span><span class="sxs-lookup"><span data-stu-id="1c230-155">Using cached values can increase your app's speed because it will spend less time on interoperability.</span></span>

### <a name="combine-calls-to-uwp-components"></a><span data-ttu-id="1c230-156">Kombinieren der Aufrufe von UWP-Komponenten</span><span class="sxs-lookup"><span data-stu-id="1c230-156">Combine calls to UWP components</span></span>

<span data-ttu-id="1c230-157">Versuchen Sie, Aufgaben mit möglichst wenigen Aufrufen von UWP-Objekten auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1c230-157">Try to complete tasks with the fewest number of calls to UWP objects as possible.</span></span> <span data-ttu-id="1c230-158">Beispielsweise ist es in der Regel besser, eine große Datenmenge aus einem Datenstrom zu lesen, anstatt jeweils nur kleine Mengen zu lesen.</span><span class="sxs-lookup"><span data-stu-id="1c230-158">For example, it is usually better to read a large amount of data from a stream than to read small amounts at a time.</span></span>

<span data-ttu-id="1c230-159">Verwenden Sie APIs, die die Arbeit in so wenig Aufrufen wie möglich bündeln, anstelle von APIs, die weniger Arbeit ausführen und mehr Aufrufe erfordern.</span><span class="sxs-lookup"><span data-stu-id="1c230-159">Use APIs that bundle work in as few calls as possible instead of APIs that do less work and require more calls.</span></span> <span data-ttu-id="1c230-160">Erstellen Sie beispielsweise lieber ein Objekt durch Aufrufen von Konstruktoren, die mehrere Eigenschaften initialisieren, anstatt den Standardkonstruktor aufzurufen und jeweils eine Eigenschaft zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="1c230-160">For example, prefer to create an object by calling constructors that initialize multiple properties instead of calling the default constructor and assigning properties one at a time.</span></span>

### <a name="building-a-uwp-components"></a><span data-ttu-id="1c230-161">Erstellen einer UWP-Komponente</span><span class="sxs-lookup"><span data-stu-id="1c230-161">Building a UWP components</span></span>

<span data-ttu-id="1c230-162">Wenn Sie eine UWP-Komponente schreiben, die von in C++ oder JavaScript geschriebenen Apps verwendet werden kann, stellen Sie sicher, dass Ihre Komponente eine gute Leistung ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="1c230-162">If you write a UWP Component that can be used by apps written in C++ or JavaScript, make sure that your component is designed for good performance.</span></span> <span data-ttu-id="1c230-163">Alle Vorschläge für das Erzielen einer guten Leistung in Apps gelten auch für das Erzielen einer guten Leistung in Komponenten.</span><span class="sxs-lookup"><span data-stu-id="1c230-163">All the suggestions for getting good performance in apps apply to getting good performance in components.</span></span> <span data-ttu-id="1c230-164">Messen Sie Ihre Komponenten, um festzustellen, welche APIs ein hohes Datenverkehrsmuster aufweisen, und stellen Sie für solche Bereiche APIs bereit, die es Ihren Benutzern ermöglichen, die Arbeit mit wenigen Aufrufen zu erledigen.</span><span class="sxs-lookup"><span data-stu-id="1c230-164">Measure your component to find out which APIs have high traffic patterns and for those areas, consider providing APIs that enable your users to do work with few calls.</span></span>

## <a name="keep-your-app-fast-when-you-use-interop-in-managed-code"></a><span data-ttu-id="1c230-165">Aufrechterhalten der Schnelligkeit Ihrer App bei der Verwendung von Interoperabilität in verwaltetem Code</span><span class="sxs-lookup"><span data-stu-id="1c230-165">Keep your app fast when you use interop in managed code</span></span>

<span data-ttu-id="1c230-166">Die UWP erleichtert die Interoperabilität zwischen systemeigenem und verwaltetem Code, aber wenn Sie nicht vorsichtig sind, können Leistungseinbußen auftreten.</span><span class="sxs-lookup"><span data-stu-id="1c230-166">The UWP makes it easy to interoperate between native and managed code, but if you're not careful it can incur performance costs.</span></span> <span data-ttu-id="1c230-167">Hier zeigen wir Ihnen, wie Sie bei Verwendung der Interoperabilität in verwalteten UWP-Apps eine gute Leistung erzielen.</span><span class="sxs-lookup"><span data-stu-id="1c230-167">Here we show you how to get good performance when you use interop in your managed UWP apps.</span></span>

<span data-ttu-id="1c230-168">Mit der UWP können Entwickler Apps mithilfe von XAML-Code in ihrer bevorzugten Sprache schreiben. Dies ist dank der Projektionen der UWP-APIs möglich, die in jeder Sprache verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="1c230-168">The UWP allows developers to write apps using XAML with their language of choice thanks to the projections of the UWP APIs available in each language.</span></span> <span data-ttu-id="1c230-169">Das Schreiben einer App in C# oder Visual Basic geht auf Kosten der Interoperabilität, da die UWP-APIs normalerweise im systemeigenen Code implementiert sind und die CLR für jeden UWP-Aufruf aus C# oder Visual Basic von einem verwalteten in einen systemeigenen Stapelrahmen übergehen muss. Zudem müssen Funktionsparameter in Darstellungen gemarshallt werden, auf die der systemeigene Code zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="1c230-169">When writing an app in C# or Visual Basic, this convenience comes at an interop cost because the UWP APIs are usually implemented in native code, and any UWP invocation from C# or Visual Basic requires that the CLR transition from a managed to a native stack frame and marshal function parameters to representations accessible by native code.</span></span> <span data-ttu-id="1c230-170">Dieser Aufwand ist für die meisten Apps gering.</span><span class="sxs-lookup"><span data-stu-id="1c230-170">This overhead is negligible for most apps.</span></span> <span data-ttu-id="1c230-171">Wenn Sie jedoch UWP-APIs im kritischen Pfad einer App sehr häufig aufrufen (Hunderttausende bis Millionen Aufrufe), kann dieser Aufwand beträchtlich werden.</span><span class="sxs-lookup"><span data-stu-id="1c230-171">But when you make many calls (hundreds of thousands, to millions) to UWP APIs in the critical path of an app, this cost can become noticeable.</span></span> <span data-ttu-id="1c230-172">Im Allgemeinen möchten Sie erreichen, dass die für den Wechsel von Sprachen erforderliche Zeit klein im Vergleich zur Ausführungszeit des restlichen Codes ist.</span><span class="sxs-lookup"><span data-stu-id="1c230-172">In general you want to ensure that the time spent in transition between languages is small relative to the execution of the rest of your code.</span></span> <span data-ttu-id="1c230-173">Dies wird im folgenden Diagramm veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="1c230-173">This is illustrated by the following diagram.</span></span>

![Interopübergänge sollten die Ausführungszeit des Programms nicht beherrschen.](images/interop-transitions.png)

<span data-ttu-id="1c230-175">Die unter [**.NET für Windows-Apps**](https://msdn.microsoft.com/library/windows/apps/xaml/br230232.aspx) aufgelisteten Typen tragen nicht zum Interopaufwand bei, wenn sie von C# oder Visual Basic aus verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1c230-175">The types listed at [**.NET for Windows apps**](https://msdn.microsoft.com/library/windows/apps/xaml/br230232.aspx) don't incur this interop cost when used from C# or Visual Basic.</span></span> <span data-ttu-id="1c230-176">Als Faustregel kann angenommen werden, dass Typen in Namespaces, die mit „Windows.“ beginnen,</span><span class="sxs-lookup"><span data-stu-id="1c230-176">As a rule of thumb, you can assume that types in namespaces which begin with “Windows.”</span></span> <span data-ttu-id="1c230-177">zur UWP gehören und Typen in Namespaces, die mit „System.” beginnen,</span><span class="sxs-lookup"><span data-stu-id="1c230-177">are part of the UWP, and types in namespaces which begin with “System.”</span></span> <span data-ttu-id="1c230-178">.NET-Typen sind.</span><span class="sxs-lookup"><span data-stu-id="1c230-178">are .NET types.</span></span> <span data-ttu-id="1c230-179">Denken Sie daran, dass selbst die einfache Verwendung von UWP-Typen, z.B. Speicherzuordnung oder Zugriff auf Eigenschaften, Interoperabilitätskosten nach sich zieht.</span><span class="sxs-lookup"><span data-stu-id="1c230-179">Keep in mind that even simple usage of UWP types such as allocation or property access incurs an interop cost.</span></span>

<span data-ttu-id="1c230-180">Sie sollten Ihre App messen und feststellen, ob die Interoperabilität einen großen Teil der Ausführungszeit Ihrer App verschlingt, bevor Sie daran gehen, die Interoperabilitätskosten zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="1c230-180">You should measure your app and determine if interop is taking up a large portion of your apps execution time before optimizing your interop costs.</span></span> <span data-ttu-id="1c230-181">Wenn Sie die Leistung Ihrer App mit Visual Studio analysieren, erhalten Sie leicht eine obere Grenze für die Interoperabilitätskosten, indem Sie in der Ansicht **Funktionen** auf die inklusive Zeit achten, die von Methoden verbraucht wird, die die UWP aufrufen.</span><span class="sxs-lookup"><span data-stu-id="1c230-181">When analyzing your app’s performance with Visual Studio, you can easily get an upper bound on your interop costs by using the **Functions** view and looking at inclusive time spent in methods which call into the UWP.</span></span>

<span data-ttu-id="1c230-182">Wenn Ihre App aufgrund des Interoperabilitätsaufwands langsam ist, können Sie die Leistung der App verbessern, indem Sie die Anzahl von UWP-API-Aufrufen in Pfaden mit wichtigem Code reduzieren.</span><span class="sxs-lookup"><span data-stu-id="1c230-182">If your app is slow because of interop overhead, you can improve its performance by reducing calls to UWP APIs on hot code paths.</span></span> <span data-ttu-id="1c230-183">Beispielsweise kann eine Spielengine, die unzählige physische Berechnungen durchführt und hierzu ständig Position und Dimensionen von [**UIElements**](https://msdn.microsoft.com/library/windows/apps/BR208911) abfragt, sehr viel Zeit sparen, indem die notwendigen Infos aus **UIElements** in lokalen Variablen gespeichert werden. Anschließend werden diese zwischengespeicherte Werte für die Berechnungen verwendet, und das Endergebnis wird nach Abschluss der Berechnungen wieder an **UIElements** zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="1c230-183">For example, a game engine that is doing tons of physics calculations by constantly querying the position and dimensions of [**UIElements**](https://msdn.microsoft.com/library/windows/apps/BR208911) can save a lot of time by storing the necessary info from **UIElements** to local variables, doing calculations on these cached values, and assigning the end result back to the **UIElements** after the calculations are done.</span></span> <span data-ttu-id="1c230-184">Ein weiteres Beispiel: Wenn C#- oder Visual Basic-Code sehr häufig auf eine Auflistung zugreift, ist es effizienter, eine Auflistung aus dem [**System.Collections**](https://msdn.microsoft.com/library/windows/apps/xaml/system.collections.aspx)-Namespace anstatt aus dem [**Windows.Foundation.Collections**](https://msdn.microsoft.com/library/windows/apps/BR206657)-Namespace zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c230-184">Another example: if a collection is heavily accessed by C# or Visual Basic code, then it is more efficient to use a collection from the [**System.Collections**](https://msdn.microsoft.com/library/windows/apps/xaml/system.collections.aspx) namespace, rather than a collection from the [**Windows.Foundation.Collections**](https://msdn.microsoft.com/library/windows/apps/BR206657) namespace.</span></span> <span data-ttu-id="1c230-185">Sie können auch erwägen, Aufrufe von UWP-Komponenten zu kombinieren. Ein Fall, in dem dies möglich ist, ist die Verwendung der [**Windows.Storage.BulkAccess**](https://msdn.microsoft.com/library/windows/apps/BR207676)-APIs.</span><span class="sxs-lookup"><span data-stu-id="1c230-185">You may also consider combining calls to UWP components; one example where this is possible is by using the [**Windows.Storage.BulkAccess**](https://msdn.microsoft.com/library/windows/apps/BR207676) APIs.</span></span>

### <a name="building-a-uwp-component"></a><span data-ttu-id="1c230-186">Erstellen einer UWP-Komponente</span><span class="sxs-lookup"><span data-stu-id="1c230-186">Building a UWP component</span></span>

<span data-ttu-id="1c230-187">Wenn Sie eine UWP-Komponente schreiben, die von Apps verwendet werden soll, die in C++ oder JavaScript geschrieben wurden, stellen Sie sicher, dass Ihre Komponente eine gute Leistung ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="1c230-187">If you write a UWP component for use in apps written in C++ or JavaScript, make sure that your component is designed for good performance.</span></span> <span data-ttu-id="1c230-188">Ihre API-Oberfläche definiert Ihre Interoperabilitätsgrenze und den Grad, bis zu dem Benutzer über die Richtlinien in diesem Thema nachdenken müssen.</span><span class="sxs-lookup"><span data-stu-id="1c230-188">Your API surface defines your interop boundary and defines the degree to which your users will have to think about the guidance in this topic.</span></span> <span data-ttu-id="1c230-189">Wenn Sie Ihre Komponenten weitergeben, wird dies besonders wichtig.</span><span class="sxs-lookup"><span data-stu-id="1c230-189">If you are distributing your components to other parties then this becomes especially important.</span></span>

<span data-ttu-id="1c230-190">Alle Vorschläge für das Erzielen einer guten Leistung in Apps gelten auch für das Erzielen einer guten Leistung in Komponenten.</span><span class="sxs-lookup"><span data-stu-id="1c230-190">All of the suggestions for getting good performance in apps apply to getting good performance in components.</span></span> <span data-ttu-id="1c230-191">Messen Sie Ihre Komponenten, um festzustellen, welche APIs ein hohes Datenverkehrsmuster aufweisen, und stellen Sie für solche Bereiche APIs bereit, die es Ihren Benutzern ermöglichen, die Arbeit mit wenigen Aufrufen zu erledigen.</span><span class="sxs-lookup"><span data-stu-id="1c230-191">Measure your component to find out which APIs have high traffic patterns, and for those areas, consider providing APIs that enable your users to do work with few calls.</span></span> <span data-ttu-id="1c230-192">Es wurden große Anstrengungen unternommen, um die UWP so zu gestalten, dass Apps sie ohne häufige Überschreitung der Interoperabilitätsgrenze verwenden können.</span><span class="sxs-lookup"><span data-stu-id="1c230-192">Significant effort was put into designing the UWP to allow apps to use it without requiring frequent crossing of the interop boundary.</span></span>

 

