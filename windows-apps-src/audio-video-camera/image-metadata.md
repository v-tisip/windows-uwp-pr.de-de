---
author: laurenhughes
ms.assetid: D5D98044-7221-4C2A-9724-56E59F341AB0
description: In diesem Artikel werden das Lesen und Schreiben von Eigenschaften von Bildmetadaten und das Hinzufügen von Geomarkierungen zu Dateien mithilfe der GeotagHelper-Hilfsklasse erläutert.
title: Bildmetadaten
ms.author: lahugh
ms.date: 02/08/2017
ms.topic: article
keywords: Windows10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: a3e2f10174412b49ce60f3da6a4bb73b2efc4411
ms.sourcegitcommit: 71e8eae5c077a7740e5606298951bb78fc42b22c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/13/2018
ms.locfileid: "6654525"
---
# <a name="image-metadata"></a><span data-ttu-id="a940a-104">Bildmetadaten</span><span class="sxs-lookup"><span data-stu-id="a940a-104">Image Metadata</span></span>



<span data-ttu-id="a940a-105">In diesem Artikel werden das Lesen und Schreiben von Eigenschaften von Bildmetadaten und das Hinzufügen von Geomarkierungen zu Dateien mithilfe der [**GeotagHelper**](https://msdn.microsoft.com/library/windows/apps/dn903683)-Hilfsklasse erläutert.</span><span class="sxs-lookup"><span data-stu-id="a940a-105">This article shows how to read and write image metadata properties and how to geotag files using the [**GeotagHelper**](https://msdn.microsoft.com/library/windows/apps/dn903683) utility class.</span></span>

## <a name="image-properties"></a><span data-ttu-id="a940a-106">Bildeigenschaften</span><span class="sxs-lookup"><span data-stu-id="a940a-106">Image properties</span></span>

<span data-ttu-id="a940a-107">Die [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225)-Eigenschaft gibt ein [**StorageItemContentProperties**](https://msdn.microsoft.com/library/windows/apps/hh770642)-Objekt zurück, das Zugriff auf inhaltsbezogene Informationen zur Datei bietet.</span><span class="sxs-lookup"><span data-stu-id="a940a-107">The [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225) property returns a [**StorageItemContentProperties**](https://msdn.microsoft.com/library/windows/apps/hh770642) object that provides access to content-related information about the file.</span></span> <span data-ttu-id="a940a-108">Rufen Sie die bildspezifischen Eigenschaften durch Aufruf von [**GetImagePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh770646) ab.</span><span class="sxs-lookup"><span data-stu-id="a940a-108">Get the image-specific properties by calling [**GetImagePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh770646).</span></span> <span data-ttu-id="a940a-109">Das zurückgegebene [**ImageProperties**](https://msdn.microsoft.com/library/windows/apps/br207718)-Objekt macht Member verfügbar, die Felder mit grundlegenden Bildmetadaten enthalten, z. B. den Titel des Bilds und das Aufnahmedatum.</span><span class="sxs-lookup"><span data-stu-id="a940a-109">The returned [**ImageProperties**](https://msdn.microsoft.com/library/windows/apps/br207718) object exposes members that contain basic image metadata fields, like the title of the image and the capture date.</span></span>

[!code-cs[GetImageProperties](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetGetImageProperties)]

<span data-ttu-id="a940a-110">Verwenden Sie für den Zugriff auf eine größere Menge von Dateimetadaten das Windows-Eigenschaftensystem, eine Reihe von Eigenschaften von Dateimetadaten, die mit einem eindeutigen Zeichenfolgenbezeichner abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="a940a-110">To access a larger set of file metadata, use the Windows Property System, a set of file metadata properties that can be retrieved with a unique string identifier.</span></span> <span data-ttu-id="a940a-111">Erstellen Sie eine Liste mit Zeichenfolgen, und fügen Sie den Bezeichner für jede Eigenschaft hinzu, die Sie abrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="a940a-111">Create a list of strings and add the identifier for each property you want to retrieve.</span></span> <span data-ttu-id="a940a-112">Die [**ImageProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br207732)-Methode verwendet diese Liste mit Zeichenfolgen und gibt ein Wörterbuch von Schlüssel-Wert-Paaren zurück, bei denen der Schlüssel der Eigenschaftsbezeichner und der Wert der Eigenschaftswert ist.</span><span class="sxs-lookup"><span data-stu-id="a940a-112">The [**ImageProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br207732) method takes this list of strings and returns a dictionary of key/value pairs where the key is the property identifier and the value is the property value.</span></span>

[!code-cs[GetWindowsProperties](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetGetWindowsProperties)]

-   <span data-ttu-id="a940a-113">Eine vollständige Liste der Windows-Eigenschaften einschließlich Bezeichnern und Typ jeder Eigenschaft finden Sie unter [Windows-Eigenschaften](https://msdn.microsoft.com/library/windows/desktop/dd561977).</span><span class="sxs-lookup"><span data-stu-id="a940a-113">For a complete list of Windows Properties, including the identifiers and type for each property, see [Windows Properties](https://msdn.microsoft.com/library/windows/desktop/dd561977).</span></span>

-   <span data-ttu-id="a940a-114">Einige Eigenschaften werden nur für bestimmte Dateicontainer und Bildcodecs unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a940a-114">Some properties are only supported for certain file containers and image codecs.</span></span> <span data-ttu-id="a940a-115">Eine Liste der für die einzelnen Bildtypen unterstützten Bildmetadaten finden Sie unter [Richtlinien zu Fotometadaten](https://msdn.microsoft.com/library/windows/desktop/ee872003).</span><span class="sxs-lookup"><span data-stu-id="a940a-115">For a listing of the image metadata supported for each image type, see [Photo Metadata Policies](https://msdn.microsoft.com/library/windows/desktop/ee872003).</span></span>

-   <span data-ttu-id="a940a-116">Da nicht unterstützte Eigenschaften beim Abrufen möglicherweise einen NULL-Wert zurückgeben, prüfen Sie immer auf NULL, bevor Sie einen zurückgegebenen Metadatenwert verwenden.</span><span class="sxs-lookup"><span data-stu-id="a940a-116">Because properties that are unsupported may return a null value when retrieved, always check for null before using a returned metadata value.</span></span>

## <a name="geotag-helper"></a><span data-ttu-id="a940a-117">GeotagHelper</span><span class="sxs-lookup"><span data-stu-id="a940a-117">Geotag helper</span></span>

<span data-ttu-id="a940a-118">„GeotagHelper“ ist eine Hilfsklasse, die das problemlose und direkte Markieren von Bildern mit geografischen Daten unter Verwendung der [**Windows.Devices.Geolocation**](https://msdn.microsoft.com/library/windows/apps/br225603)-APIs ermöglicht, ohne dass das Metadatenformat manuell analysiert oder konstruiert werden muss.</span><span class="sxs-lookup"><span data-stu-id="a940a-118">GeotagHelper is a utility class that makes it easy to tag images with geographic data using the [**Windows.Devices.Geolocation**](https://msdn.microsoft.com/library/windows/apps/br225603) APIs directly, without having to manually parse or construct the metadata format.</span></span>

<span data-ttu-id="a940a-119">Wenn Sie bereits über ein [**Geopoint**](https://msdn.microsoft.com/library/windows/apps/dn263675)-Objekt verfügen, das die Position darstellt, die Sie im Bild markieren möchten (entweder aus einer früheren Verwendung der Geolocation-APIs oder aus einer anderen Quelle), können Sie die Geomarkierungsdaten festlegen, indem Sie [**GeotagHelper.SetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903685) aufrufen und eine [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) und einen **Geopoint** übergeben.</span><span class="sxs-lookup"><span data-stu-id="a940a-119">If you already have a [**Geopoint**](https://msdn.microsoft.com/library/windows/apps/dn263675) object representing the location you want to tag in the image, either from a previous use of the geolocation APIs or some other source, you can set the geotag data by calling [**GeotagHelper.SetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903685) and passing in a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) and the **Geopoint**.</span></span>

[!code-cs[SetGeoDataFromPoint](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetSetGeoDataFromPoint)]

<span data-ttu-id="a940a-120">Um die Geomarkierungsdaten mithilfe der aktuellen Position des Geräts festzulegen, erstellen Sie ein neues [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534)-Objekt, und rufen Sie [**GeotagHelper.SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) auf. Übergeben Sie dabei die **Geolocator**-Klasse und die zu markierende Datei.</span><span class="sxs-lookup"><span data-stu-id="a940a-120">To set the geotag data using the device's current location, create a new [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object and call [**GeotagHelper.SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) passing in the **Geolocator** and the file to be tagged.</span></span>

[!code-cs[SetGeoDataFromGeolocator](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetSetGeoDataFromGeolocator)]

-   <span data-ttu-id="a940a-121">Sie müssen die **location**-Gerätefunktion in das App-Manifest einschließen, um die [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686)-API verwenden zu können.</span><span class="sxs-lookup"><span data-stu-id="a940a-121">You must include the **location** device capability in your app manifest in order to use the [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) API.</span></span>

-   <span data-ttu-id="a940a-122">Sie müssen [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) vor [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) aufrufen, um sicherzustellen, dass der Benutzer Ihrer App die Berechtigung zur Verwendung seiner Position gewährt hat.</span><span class="sxs-lookup"><span data-stu-id="a940a-122">You must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) before calling [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) to ensure the user has granted your app permission to use their location.</span></span>

-   <span data-ttu-id="a940a-123">Weitere Informationen zu den Geolocation-APIs finden Sie unter [Karten und Position](https://msdn.microsoft.com/library/windows/apps/mt219699).</span><span class="sxs-lookup"><span data-stu-id="a940a-123">For more information on the geolocation APIs, see [Maps and location](https://msdn.microsoft.com/library/windows/apps/mt219699).</span></span>

<span data-ttu-id="a940a-124">Um einen GeoPoint abzurufen, der die geomarkierte Position einer Bilddatei darstellt, rufen Sie [**GetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903684) auf.</span><span class="sxs-lookup"><span data-stu-id="a940a-124">To get a GeoPoint representing the geotagged location of an image file, call [**GetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903684).</span></span>

[!code-cs[GetGeoData](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetGetGeoData)]

## <a name="decode-and-encode-image-metadata"></a><span data-ttu-id="a940a-125">Decodieren und Codieren von Bildmetadaten</span><span class="sxs-lookup"><span data-stu-id="a940a-125">Decode and encode image metadata</span></span>

<span data-ttu-id="a940a-126">Die fortschrittlichste Methode zum Arbeiten mit Bilddaten ist das Lesen und Schreiben der Eigenschaften auf Datenstromebene mithilfe von [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) oder [BitmapEncoder](bitmapencoder-options-reference.md).</span><span class="sxs-lookup"><span data-stu-id="a940a-126">The most advanced way of working with image data is to read and write the properties on the stream level using a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) or a [BitmapEncoder](bitmapencoder-options-reference.md).</span></span> <span data-ttu-id="a940a-127">Für diese Vorgänge können Sie Windows-Eigenschaften verwenden, um die gelesenen oder geschriebenen Daten anzugeben. Sie können aber auch die von der Windows-Bilderstellungskomponente (WIC) bereitgestellte Metadatenabfragesprache verwenden, um den Pfad zu einer angeforderten Eigenschaft anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a940a-127">For these operations you can use Windows Properties to specify the data you are reading or writing, but you can also use the metadata query language provided by the Windows Imaging Component (WIC) to specify the path to a requested property.</span></span>

<span data-ttu-id="a940a-128">Um Bildmetadaten mit diesem Verfahren lesen zu können, benötigen Sie einen [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176), der mit dem Dateidatenstrom des Quellbilds erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="a940a-128">Reading image metadata using this technique requires you to have a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) that was created with the source image file stream.</span></span> <span data-ttu-id="a940a-129">Informationen zur Vorgehensweise finden Sie unter [Bildverarbeitung](imaging.md).</span><span class="sxs-lookup"><span data-stu-id="a940a-129">For information on how to do this, see [Imaging](imaging.md).</span></span>

<span data-ttu-id="a940a-130">Nachdem Sie über den Decoder verfügen, erstellen Sie eine Liste mit Zeichenfolgen, und fügen Sie für jede abzurufende Metadateneigenschaft einen neuen Eintrag hinzu; verwenden Sie dabei entweder die ID-Zeichenfolge der Windows-Eigenschaft oder eine WIC-Metadatenabfrage.</span><span class="sxs-lookup"><span data-stu-id="a940a-130">Once you have the decoder, create a list of strings and add a new entry for each metadata property you want to retrieve, using either the Windows Property identifier string or a WIC metadata query.</span></span> <span data-ttu-id="a940a-131">Rufen Sie die [**BitmapPropertiesView.GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250)-Methode für den [**BitmapProperties**](https://msdn.microsoft.com/library/windows/apps/br226248)-Member des Decoders auf, um die angegebenen Eigenschaften anzufordern.</span><span class="sxs-lookup"><span data-stu-id="a940a-131">Call the [**BitmapPropertiesView.GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) method on the decoder's [**BitmapProperties**](https://msdn.microsoft.com/library/windows/apps/br226248) member to request the specified properties.</span></span> <span data-ttu-id="a940a-132">Die Eigenschaften werden in einem Wörterbuch mit Schlüssel-Wert-Paaren zurückgegeben, die den Eigenschaftsnamen oder den Pfad und den Eigenschaftswert enthalten.</span><span class="sxs-lookup"><span data-stu-id="a940a-132">The properties are returned in a dictionary of key/value pairs containing the property name or path and the property value.</span></span>

[!code-cs[ReadImageMetadata](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetReadImageMetadata)]

-   <span data-ttu-id="a940a-133">Informationen über die WIC-Metadatenabfragesprache und die unterstützten Eigenschaften finden Sie unter [WIC-Metadatenabfragen für native Bildformate](https://msdn.microsoft.com/library/windows/desktop/ee719904).</span><span class="sxs-lookup"><span data-stu-id="a940a-133">For information on the WIC metadata query language and the properties supported, see [WIC image format native metadata queries](https://msdn.microsoft.com/library/windows/desktop/ee719904).</span></span>

-   <span data-ttu-id="a940a-134">Viele Metadateneigenschaften werden nur von einer Teilmenge aller Bildtypen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a940a-134">Many metadata properties are only supported by a subset of image types.</span></span> <span data-ttu-id="a940a-135">[Bei Ausführung von **GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) tritt ein Fehler mit Fehlercode 0x88982F41 auf, wenn eine der angeforderten Eigenschaften von dem dem Decoder zugeordneten Bild nicht unterstützt wird, und mit Fehlercode 0x88982F81, wenn das Bild überhaupt keine Metadaten unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a940a-135">[**GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the decoder and 0x88982F81 if the image does not support metadata at all.</span></span> <span data-ttu-id="a940a-136">Die diesen Fehlercodes zugeordneten Konstanten sind WINCODEC\_ERR\_PROPERTYNOTSUPPORTED und WINCODEC\_ERR\_UNSUPPORTEDOPERATION und werden in der Headerdatei „winerror.h“ definiert.</span><span class="sxs-lookup"><span data-stu-id="a940a-136">The constants associated with these error codes are WINCODEC\_ERR\_PROPERTYNOTSUPPORTED and WINCODEC\_ERR\_UNSUPPORTEDOPERATION and are defined in the winerror.h header file.</span></span>
-   <span data-ttu-id="a940a-137">Da ein Bild nicht unbedingt einen Wert für eine bestimmte Eigenschaft enthält, überprüfen Sie mithilfe von **IDictionary.ContainsKey**, ob eine Eigenschaft in den Ergebnissen vorhanden ist, bevor Sie versuchen, darauf zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="a940a-137">Because an image may or may not contain a value for a particular property, use the **IDictionary.ContainsKey** to verify that a property is present in the results before attempting to access it.</span></span>

<span data-ttu-id="a940a-138">Um Bildmetadaten in den Datenstrom zu schreiben, muss der Bildausgabedatei ein **BitmapEncoder** zugeordnet sein.</span><span class="sxs-lookup"><span data-stu-id="a940a-138">Writing image metadata to the stream requires a **BitmapEncoder** associated with the image output file.</span></span>

<span data-ttu-id="a940a-139">Erstellen Sie ein [**BitmapPropertySet**](https://msdn.microsoft.com/library/windows/apps/hh974338)-Objekt als Container für die festzulegenden Eigenschaftswerte.</span><span class="sxs-lookup"><span data-stu-id="a940a-139">Create a [**BitmapPropertySet**](https://msdn.microsoft.com/library/windows/apps/hh974338) object to contain the property values you want set.</span></span> <span data-ttu-id="a940a-140">Erstellen Sie ein [**BitmapTypedValue**](https://msdn.microsoft.com/library/windows/apps/hh700687)-Objekt für den Eigenschaftswert.</span><span class="sxs-lookup"><span data-stu-id="a940a-140">Create a [**BitmapTypedValue**](https://msdn.microsoft.com/library/windows/apps/hh700687) object to represent the property value.</span></span> <span data-ttu-id="a940a-141">Dieses Objekt verwendet **object** als Wert und Member der [**PropertyType**](https://msdn.microsoft.com/library/windows/apps/br225871)-Enumeration, die den Typ des Werts definiert.</span><span class="sxs-lookup"><span data-stu-id="a940a-141">This object uses an **object** as the value and member of the [**PropertyType**](https://msdn.microsoft.com/library/windows/apps/br225871) enumeration that defines the type of the value.</span></span> <span data-ttu-id="a940a-142">Fügen Sie den **BitmapTypedValue** dem **BitmapPropertySet** hinzu, und rufen Sie dann [**BitmapProperties.SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) auf, damit der Encoder die Eigenschaften in den Datenstrom schreibt.</span><span class="sxs-lookup"><span data-stu-id="a940a-142">Add the **BitmapTypedValue** to the **BitmapPropertySet** and then call [**BitmapProperties.SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) to cause the encoder to write the properties to the stream.</span></span>

[!code-cs[WriteImageMetadata](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetWriteImageMetadata)]

-   <span data-ttu-id="a940a-143">Ausführliche Informationen dazu, welche Eigenschaften für welche Bilddateitypen unterstützt werden, finden Sie unter [Windows-Eigenschaften](https://msdn.microsoft.com/library/windows/desktop/dd561977), [Richtlinien zu Fotometadaten](https://msdn.microsoft.com/library/windows/desktop/ee872003) und [WIC-Metadatenabfragen für systemeigene Bildformate](https://msdn.microsoft.com/library/windows/desktop/ee719904).</span><span class="sxs-lookup"><span data-stu-id="a940a-143">For details on which properties are supported for which image file types, see [Windows Properties](https://msdn.microsoft.com/library/windows/desktop/dd561977), [Photo Metadata Policies](https://msdn.microsoft.com/library/windows/desktop/ee872003), and [WIC image format native metadata queries](https://msdn.microsoft.com/library/windows/desktop/ee719904).</span></span>

-   <span data-ttu-id="a940a-144">[Für **SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) tritt ein Fehler mit dem Fehlercode 0x88982F41 auf, wenn das dem Encoder zugeordnete Bild eine der angeforderten Eigenschaften nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a940a-144">[**SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the encoder.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a940a-145">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="a940a-145">Related topics</span></span>

* [<span data-ttu-id="a940a-146">Bildverarbeitung</span><span class="sxs-lookup"><span data-stu-id="a940a-146">Imaging</span></span>](imaging.md)
 

 




