---
author: drewbatgit
ms.assetid: B5D915E4-4280-422C-BA0E-D574C534410B
description: Dieser Artikel beschreibt, wie Sie mit SceneAnalysisEffect und FaceDetectionEffect den Inhalt des Vorschaudatenstroms der Medienaufnahme analysieren.
title: Effekte für die Analyse von Kamera-Frames
ms.author: drewbat
ms.date: 02/08/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP
ms.openlocfilehash: 3fc55919942c1edc82f7c2e5da2608b5f1b1445b
ms.sourcegitcommit: 909d859a0f11981a8d1beac0da35f779786a6889
ms.translationtype: MT
ms.contentlocale: de-DE
ms.locfileid: "233830"
---
# <a name="effects-for-analyzing-camera-frames"></a><span data-ttu-id="16cdb-104">Effekte für die Analyse von Kamera-Frames</span><span class="sxs-lookup"><span data-stu-id="16cdb-104">Effects for analyzing camera frames</span></span>

<span data-ttu-id="16cdb-105">\[ Aktualisiert für UWP-Apps unter Windows10.</span><span class="sxs-lookup"><span data-stu-id="16cdb-105">\[ Updated for UWP apps on Windows 10.</span></span> <span data-ttu-id="16cdb-106">Artikel zu Windows8.x finden Sie im [Archiv](http://go.microsoft.com/fwlink/p/?linkid=619132) \].</span><span class="sxs-lookup"><span data-stu-id="16cdb-106">For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \]</span></span>


<span data-ttu-id="16cdb-107">Dieser Artikel beschreibt, wie Sie mit [**SceneAnalysisEffect**](https://msdn.microsoft.com/library/windows/apps/dn948902) und [**FaceDetectionEffect**](https://msdn.microsoft.com/library/windows/apps/dn948776) den Inhalt des Vorschaudatenstroms der Medienaufnahme analysieren.</span><span class="sxs-lookup"><span data-stu-id="16cdb-107">This article describes how to use the [**SceneAnalysisEffect**](https://msdn.microsoft.com/library/windows/apps/dn948902) and the [**FaceDetectionEffect**](https://msdn.microsoft.com/library/windows/apps/dn948776) to analyze the content of the media capture preview stream.</span></span>

## <a name="scene-analysis-effect"></a><span data-ttu-id="16cdb-108">Effekt der Szenenanalyse</span><span class="sxs-lookup"><span data-stu-id="16cdb-108">Scene analysis effect</span></span>

<span data-ttu-id="16cdb-109">Die [**SceneAnalysisEffect**](https://msdn.microsoft.com/library/windows/apps/dn948902)-Klasse analysiert die Videoframes im Vorschaudatenstrom der Medienaufnahme und empfiehlt Verarbeitungsoptionen zur Verbesserung des Aufnahmeergebnisses.</span><span class="sxs-lookup"><span data-stu-id="16cdb-109">The [**SceneAnalysisEffect**](https://msdn.microsoft.com/library/windows/apps/dn948902) analyzes the video frames in the media capture preview stream and recommends processing options to improve the capture result.</span></span> <span data-ttu-id="16cdb-110">Der Effekt ermittelt derzeit, ob die Verwendung der HDR-Verarbeitung (High Dynamic Range) die Aufnahme verbessern würde.</span><span class="sxs-lookup"><span data-stu-id="16cdb-110">Currently, the effect supports detecting whether the capture would be improved by using High Dynamic Range (HDR) processing.</span></span>

<span data-ttu-id="16cdb-111">Wenn der Effekt die Verwendung von HDR empfiehlt, können Sie dies auf folgende Weise tun:</span><span class="sxs-lookup"><span data-stu-id="16cdb-111">If the effect recommends using HDR, you can do this in the following ways:</span></span>

-   <span data-ttu-id="16cdb-112">Verwenden Sie die [**AdvancedPhotoCapture**](https://msdn.microsoft.com/library/windows/apps/mt181386)-Klasse für Videoaufnahmen mit dem integrierten Windows-HDR-Verarbeitungsalgorithmus.</span><span class="sxs-lookup"><span data-stu-id="16cdb-112">Use the [**AdvancedPhotoCapture**](https://msdn.microsoft.com/library/windows/apps/mt181386) class to capture photos using the Windows built-in HDR processing algorithm.</span></span> <span data-ttu-id="16cdb-113">Weitere Informationen finden Sie unter [High Dynamic Range-Fotoaufnahme (HDR)](high-dynamic-range-hdr-photo-capture.md).</span><span class="sxs-lookup"><span data-stu-id="16cdb-113">For more information, see [High Dynamic Range (HDR) photo capture](high-dynamic-range-hdr-photo-capture.md).</span></span>

-   <span data-ttu-id="16cdb-114">Verwenden Sie das [**HdrVideoControl**](https://msdn.microsoft.com/library/windows/apps/dn926680) für Videoaufnahmen mit dem integrierten Windows-HDR-Verarbeitungsalgorithmus.</span><span class="sxs-lookup"><span data-stu-id="16cdb-114">Use the [**HdrVideoControl**](https://msdn.microsoft.com/library/windows/apps/dn926680) to capture video using the Windows built-in HDR processing algorithm.</span></span> <span data-ttu-id="16cdb-115">Weitere Informationen finden Sie unter [Steuerelemente des Aufnahmegeräts für Videoaufnahmen](capture-device-controls-for-video-capture.md).</span><span class="sxs-lookup"><span data-stu-id="16cdb-115">For more information, see [Capture device controls for video capture](capture-device-controls-for-video-capture.md).</span></span>

-   <span data-ttu-id="16cdb-116">Verwenden Sie die [**VariablePhotoSequenceControl**](https://msdn.microsoft.com/library/windows/apps/dn640573)-Klasse für die Aufnahme einer Framesequenz, die Sie anschließend mithilfe einer benutzerdefinierten HDR-Implementierung zusammensetzen können.</span><span class="sxs-lookup"><span data-stu-id="16cdb-116">Use the [**VariablePhotoSequenceControl**](https://msdn.microsoft.com/library/windows/apps/dn640573) to capture a sequence of frames that you can then composite using a custom HDR implementation.</span></span> <span data-ttu-id="16cdb-117">Weitere Informationen finden Sie unter [Variable Fotosequenz](variable-photo-sequence.md).</span><span class="sxs-lookup"><span data-stu-id="16cdb-117">For more information, see [Variable photo sequence](variable-photo-sequence.md).</span></span>

### <a name="scene-analysis-namespaces"></a><span data-ttu-id="16cdb-118">Namespaces der Szenenanalyse</span><span class="sxs-lookup"><span data-stu-id="16cdb-118">Scene analysis namespaces</span></span>

<span data-ttu-id="16cdb-119">Um die Szenenanalyse verwenden zu können, muss Ihre App zusätzlich zu den für die grundlegende Medienaufnahme erforderlichen Namespaces die folgenden Namespaces enthalten.</span><span class="sxs-lookup"><span data-stu-id="16cdb-119">To use scene analysis, your app must include the following namespaces in addition to the namespaces required for basic media capture.</span></span>

[!code-cs[<span data-ttu-id="16cdb-120">SceneAnalysisUsing</span><span class="sxs-lookup"><span data-stu-id="16cdb-120">SceneAnalysisUsing</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetSceneAnalysisUsing)]

### <a name="initialize-the-scene-analysis-effect-and-add-it-to-the-preview-stream"></a><span data-ttu-id="16cdb-121">Initialisieren und Hinzufügen des Szenenanalyseneffekts zum Vorschaudatenstrom</span><span class="sxs-lookup"><span data-stu-id="16cdb-121">Initialize the scene analysis effect and add it to the preview stream</span></span>

<span data-ttu-id="16cdb-122">Videoeffekte werden mit zwei APIs, einer Effektdefinition, die die für das Aufnahmegerät benötigten Einstellungen zum Initialisieren des Effekts bereitstellt, und einer Effektinstanz implementiert, die zum Steuern des Effekts verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="16cdb-122">Video effects are implemented using two APIs, an effect definition, which provides settings that the capture device needs to initialize the effect, and an effect instance, which can be used to control the effect.</span></span> <span data-ttu-id="16cdb-123">Da Sie ggf. von mehreren Stellen innerhalb des Codes aus auf die Effektinstanz zugreifen müssen, sollten Sie in der Regel eine Membervariable als Container für das Objekt deklarieren.</span><span class="sxs-lookup"><span data-stu-id="16cdb-123">Since you may want to access the effect instance from multiple places within your code, you should typically declare a member variable to hold the object.</span></span>

[!code-cs[<span data-ttu-id="16cdb-124">DeclareSceneAnalysisEffect</span><span class="sxs-lookup"><span data-stu-id="16cdb-124">DeclareSceneAnalysisEffect</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetDeclareSceneAnalysisEffect)]

<span data-ttu-id="16cdb-125">Erstellen Sie nach dem Initialisieren des **MediaCapture**-Objekts in Ihrer App eine neue Instanz der [**SceneAnalysisEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn948903)-Klasse.</span><span class="sxs-lookup"><span data-stu-id="16cdb-125">In your app, after you have initialized the **MediaCapture** object, create a new instance of [**SceneAnalysisEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn948903).</span></span>

<span data-ttu-id="16cdb-126">Registrieren Sie den Effekt mit dem Aufnahmegerät durch Aufrufen der [**AddVideoEffectAsync**](https://msdn.microsoft.com/library/windows/apps/dn878035)-Methode für Ihr **MediaCapture**-Objekt, stellen Sie **SceneAnalysisEffectDefinition** bereit, und geben Sie [**MediaStreamType.VideoPreview**](https://msdn.microsoft.com/library/windows/apps/br226640) an, damit der Effekt im Gegensatz zum Aufnahmedatenstrom auf den Videovorschaudatenstrom angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="16cdb-126">Register the effect with the capture device by calling [**AddVideoEffectAsync**](https://msdn.microsoft.com/library/windows/apps/dn878035) on your **MediaCapture** object, providing the **SceneAnalysisEffectDefinition** and specifying [**MediaStreamType.VideoPreview**](https://msdn.microsoft.com/library/windows/apps/br226640) to indicate that the effect should be applied to the video preview stream, as opposed to the capture stream.</span></span> <span data-ttu-id="16cdb-127">**AddVideoEffectAsync** gibt eine Instanz des hinzugefügten Effekts zurück.</span><span class="sxs-lookup"><span data-stu-id="16cdb-127">**AddVideoEffectAsync** returns an instance of the added effect.</span></span> <span data-ttu-id="16cdb-128">Da diese Methode mit verschiedenen Effekttypen verwendet werden kann, müssen Sie die zurückgegebene Instanz in ein [**SceneAnalysisEffect**](https://msdn.microsoft.com/library/windows/apps/dn948902)-Objekt umwandeln.</span><span class="sxs-lookup"><span data-stu-id="16cdb-128">Because this method can be used with multiple effect types, you must cast the returned instance to a [**SceneAnalysisEffect**](https://msdn.microsoft.com/library/windows/apps/dn948902) object.</span></span>

<span data-ttu-id="16cdb-129">Um die Ergebnisse der Szenenanalyse zu erhalten, müssen Sie einen Handler für das [**SceneAnalyzed**](https://msdn.microsoft.com/library/windows/apps/dn948920)-Ereignis registrieren.</span><span class="sxs-lookup"><span data-stu-id="16cdb-129">To receive the results of the scene analysis, you must register a handler for the [**SceneAnalyzed**](https://msdn.microsoft.com/library/windows/apps/dn948920) event.</span></span>

<span data-ttu-id="16cdb-130">Derzeit umfasst der Szenenanalyseeffekt nur die HDR-Analyzer.</span><span class="sxs-lookup"><span data-stu-id="16cdb-130">Currently, the scene analysis effect only includes the high dynamic range analyzer.</span></span> <span data-ttu-id="16cdb-131">Aktivieren Sie die HDR-Analyse, indem Sie die [**HighDynamicRangeControl.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948827)-Eigenschaft des Effekts auf „true“ festlegen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-131">Enable HDR analysis by setting the effect's [**HighDynamicRangeControl.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948827) to true.</span></span>

[!code-cs[<span data-ttu-id="16cdb-132">CreateSceneAnalysisEffectAsync</span><span class="sxs-lookup"><span data-stu-id="16cdb-132">CreateSceneAnalysisEffectAsync</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetCreateSceneAnalysisEffectAsync)]

### <a name="implement-the-sceneanalyzed-event-handler"></a><span data-ttu-id="16cdb-133">Implementieren des SceneAnalyzed-Ereignishandlers</span><span class="sxs-lookup"><span data-stu-id="16cdb-133">Implement the SceneAnalyzed event handler</span></span>

<span data-ttu-id="16cdb-134">Die Ergebnisse der Szenenanalyse werden im **SceneAnalyzed**-Ereignishandler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="16cdb-134">The results of the scene analysis are returned in the **SceneAnalyzed** event handler.</span></span> <span data-ttu-id="16cdb-135">Das an den Handler übergebene [**SceneAnalyzedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn948922)-Objekt verfügt über ein [**SceneAnalysisEffectFrame**](https://msdn.microsoft.com/library/windows/apps/dn948907)-Objekt mit einem [**HighDynamicRangeOutput**](https://msdn.microsoft.com/library/windows/apps/dn948830)-Objekt.</span><span class="sxs-lookup"><span data-stu-id="16cdb-135">The [**SceneAnalyzedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn948922) object passed into the handler has a [**SceneAnalysisEffectFrame**](https://msdn.microsoft.com/library/windows/apps/dn948907) object which has a [**HighDynamicRangeOutput**](https://msdn.microsoft.com/library/windows/apps/dn948830) object.</span></span> <span data-ttu-id="16cdb-136">Die [**Certainty**](https://msdn.microsoft.com/library/windows/apps/dn948833)-Eigenschaft der HDR-Ausgabe liefert einen Wert zwischen 0 und 1,0, wobei 0 angibt, dass die HDR-Verarbeitung das Aufnahmeergebnis nicht verbessern und 1,0, dass die HDR-Verarbeitung dieses verbessern würde.</span><span class="sxs-lookup"><span data-stu-id="16cdb-136">The [**Certainty**](https://msdn.microsoft.com/library/windows/apps/dn948833) property of the high dynamic range output provides a value between 0 and 1.0 where 0 indicates that HDR processing would not help improve the capture result and 1.0 indicates that HDR processing would help.</span></span> <span data-ttu-id="16cdb-137">Sie können den Schwellenwert festlegen, an dem Sie HDR verwenden möchten, oder die Ergebnisse für den Benutzer anzeigen und diesen darüber entscheiden lassen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-137">Your can decide the threshold point at which you want to use HDR or show the results to the user and let the user decide.</span></span>

[!code-cs[<span data-ttu-id="16cdb-138">SceneAnalyzed</span><span class="sxs-lookup"><span data-stu-id="16cdb-138">SceneAnalyzed</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetSceneAnalyzed)]

<span data-ttu-id="16cdb-139">Das an den Handler übergebene [**HighDynamicRangeOutput**](https://msdn.microsoft.com/library/windows/apps/dn948830)-Objekt verfügt auch über eine [**FrameControllers**](https://msdn.microsoft.com/library/windows/apps/dn948834)-Eigenschaft, die die vorgeschlagenen Framecontroller für die Aufnahme einer variablen Fotosequenz für HDR-Verarbeitung enthält.</span><span class="sxs-lookup"><span data-stu-id="16cdb-139">The [**HighDynamicRangeOutput**](https://msdn.microsoft.com/library/windows/apps/dn948830) object passed into the handler also has a [**FrameControllers**](https://msdn.microsoft.com/library/windows/apps/dn948834) property which contains suggested frame controllers for capturing a variable photo sequence for HDR processing.</span></span> <span data-ttu-id="16cdb-140">Weitere Informationen finden Sie unter [Variable Fotosequenz](variable-photo-sequence.md).</span><span class="sxs-lookup"><span data-stu-id="16cdb-140">For more information, see [Variable photo sequence](variable-photo-sequence.md).</span></span>

### <a name="clean-up-the-scene-analysis-effect"></a><span data-ttu-id="16cdb-141">Bereinigen des Szenenanalyseeffekts</span><span class="sxs-lookup"><span data-stu-id="16cdb-141">Clean up the scene analysis effect</span></span>

<span data-ttu-id="16cdb-142">Wenn Ihre App die Aufnahme abgeschlossen hat, deaktivieren Sie vor dem Löschen des **MediaCapture**-Objekts den Szenenanalyseeffekt, indem Sie die [**HighDynamicRangeAnalyzer.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948827)-Eigenschaft des Effekts auf „false“ festlegen und die Registrierung Ihres [**SceneAnalyzed**](https://msdn.microsoft.com/library/windows/apps/dn948920)-Ereignishandlers aufheben.</span><span class="sxs-lookup"><span data-stu-id="16cdb-142">When your app is done capturing, before disposing of the **MediaCapture** object, you should disable the scene analysis effect by setting the effect's [**HighDynamicRangeAnalyzer.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948827) property to false and unregister your [**SceneAnalyzed**](https://msdn.microsoft.com/library/windows/apps/dn948920) event handler.</span></span> <span data-ttu-id="16cdb-143">Rufen Sie die [**MediaCapture.ClearEffectsAsync**](https://msdn.microsoft.com/library/windows/apps/br226592)-Methode auf, und geben Sie den Videovorschaudatenstrom an, da der Effekt diesem Datenstrom hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="16cdb-143">Call [**MediaCapture.ClearEffectsAsync**](https://msdn.microsoft.com/library/windows/apps/br226592), specifying the video preview stream since that was the stream to which the effect was added.</span></span> <span data-ttu-id="16cdb-144">Legen Sie schließlich die Membervariable auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="16cdb-144">Finally, set your member variable to null.</span></span>

[!code-cs[<span data-ttu-id="16cdb-145">CleanUpSceneAnalysisEffectAsync</span><span class="sxs-lookup"><span data-stu-id="16cdb-145">CleanUpSceneAnalysisEffectAsync</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetCleanUpSceneAnalysisEffectAsync)]

## <a name="face-detection-effect"></a><span data-ttu-id="16cdb-146">Gesichtserkennungseffekt</span><span class="sxs-lookup"><span data-stu-id="16cdb-146">Face detection effect</span></span>

<span data-ttu-id="16cdb-147">[**FaceDetectionEffect**](https://msdn.microsoft.com/library/windows/apps/dn948776) identifiziert die Position von Gesichtern innerhalb des Vorschaudatenstroms der Medienaufnahme.</span><span class="sxs-lookup"><span data-stu-id="16cdb-147">The [**FaceDetectionEffect**](https://msdn.microsoft.com/library/windows/apps/dn948776) identifies the location of faces within the media capture preview stream.</span></span> <span data-ttu-id="16cdb-148">Mit dem Effekt erhalten Sie eine Benachrichtigung, wenn ein Gesicht im Vorschaudatenstrom erkannt wird, und es wird der Begrenzungsrahmen für jedes erkannte Gesicht im Vorschauframe bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="16cdb-148">The effect allows you to receive a notification whenever a face is detected in the preview stream and provides the bounding box for each detected face within the preview frame.</span></span> <span data-ttu-id="16cdb-149">Auf unterstützten Geräten stellt die Gesichtserkennung auch erweiterte Belichtung und Fokus auf das wichtigste Gesicht in der Szene bereit.</span><span class="sxs-lookup"><span data-stu-id="16cdb-149">On supported devices, the face detection effect also provides enhanced exposure and focus on the most important face in the scene.</span></span>

### <a name="face-detection-namespaces"></a><span data-ttu-id="16cdb-150">Namespaces der Gesichtserkennung</span><span class="sxs-lookup"><span data-stu-id="16cdb-150">Face detection namespaces</span></span>

<span data-ttu-id="16cdb-151">Um die Gesichtserkennung verwenden zu können, muss Ihre App die folgenden Namespaces zusätzlich zu den für die grundlegende Medienaufnahme erforderlichen Namespaces enthalten.</span><span class="sxs-lookup"><span data-stu-id="16cdb-151">To use face detection, your app must include the following namespaces in addition to the namespaces required for basic media capture.</span></span>

[!code-cs[<span data-ttu-id="16cdb-152">FaceDetectionUsing</span><span class="sxs-lookup"><span data-stu-id="16cdb-152">FaceDetectionUsing</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetFaceDetectionUsing)]

### <a name="initialize-the-face-detection-effect-and-add-it-to-the-preview-stream"></a><span data-ttu-id="16cdb-153">Initialisieren und Hinzufügen des Gesichterkennungseffekts zum Vorschaudatenstrom</span><span class="sxs-lookup"><span data-stu-id="16cdb-153">Initialize the face detection effect and add it to the preview stream</span></span>

<span data-ttu-id="16cdb-154">Videoeffekte werden mit zwei APIs, einer Effektdefinition, die die für das Aufnahmegerät benötigten Einstellungen zum Initialisieren des Effekts bereitstellt, und einer Effektinstanz implementiert, die zum Steuern des Effekts verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="16cdb-154">Video effects are implemented using two APIs, an effect definition, which provides settings that the capture device needs to initialize the effect, and an effect instance, which can be used to control the effect.</span></span> <span data-ttu-id="16cdb-155">Da Sie ggf. von mehreren Stellen innerhalb des Codes aus auf die Effektinstanz zugreifen müssen, sollten Sie in der Regel eine Membervariable als Container für das Objekt deklarieren.</span><span class="sxs-lookup"><span data-stu-id="16cdb-155">Since you may want to access the effect instance from multiple places within your code, you should typically declare a member variable to hold the object.</span></span>

[!code-cs[<span data-ttu-id="16cdb-156">DeclareFaceDetectionEffect</span><span class="sxs-lookup"><span data-stu-id="16cdb-156">DeclareFaceDetectionEffect</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetDeclareFaceDetectionEffect)]

<span data-ttu-id="16cdb-157">Erstellen Sie nach dem Initialisieren des **MediaCapture**-Objekts in Ihrer App eine neue Instanz von [**FaceDetectionEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn948778).</span><span class="sxs-lookup"><span data-stu-id="16cdb-157">In your app, after you have initialized the **MediaCapture** object, create a new instance of [**FaceDetectionEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn948778).</span></span> <span data-ttu-id="16cdb-158">Legen Sie die [**DetectionMode**](https://msdn.microsoft.com/library/windows/apps/dn948781)-Eigenschaft fest, um eine schnellere oder genauere Gesichtserkennung zu bevorzugen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-158">Set the [**DetectionMode**](https://msdn.microsoft.com/library/windows/apps/dn948781) property to prioritize faster face detection or more accurate face detection.</span></span> <span data-ttu-id="16cdb-159">Legen Sie die [**SynchronousDetectionEnabled**](https://msdn.microsoft.com/library/windows/apps/dn948786)-Eigenschaft fest, um anzugeben, dass eingehende Frames nicht durch eine andauernde Gesichtserkennung verzögert werden, da dies zu einer stockenden Vorschau führen kann.</span><span class="sxs-lookup"><span data-stu-id="16cdb-159">Set [**SynchronousDetectionEnabled**](https://msdn.microsoft.com/library/windows/apps/dn948786) to specify that incoming frames are not delayed waiting for face detection to complete as this can result in a choppy preview experience.</span></span>

<span data-ttu-id="16cdb-160">Registrieren Sie den Effekt mit dem Aufnahmegerät durch Aufrufen der [**AddVideoEffectAsync**](https://msdn.microsoft.com/library/windows/apps/dn878035)-Methode für Ihr **MediaCapture**-Objekt, stellen Sie **FaceDetectionEffectDefinition** bereit, und geben Sie [**MediaStreamType.VideoPreview**](https://msdn.microsoft.com/library/windows/apps/br226640) an, damit der Effekt im Gegensatz zum Aufnahmedatenstrom auf den Videovorschaudatenstrom angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="16cdb-160">Register the effect with the capture device by calling [**AddVideoEffectAsync**](https://msdn.microsoft.com/library/windows/apps/dn878035) on your **MediaCapture** object, providing the **FaceDetectionEffectDefinition** and specifying [**MediaStreamType.VideoPreview**](https://msdn.microsoft.com/library/windows/apps/br226640) to indicate that the effect should be applied to the video preview stream, as opposed to the capture stream.</span></span> <span data-ttu-id="16cdb-161">**AddVideoEffectAsync** gibt eine Instanz des hinzugefügten Effekts zurück.</span><span class="sxs-lookup"><span data-stu-id="16cdb-161">**AddVideoEffectAsync** returns an instance of the added effect.</span></span> <span data-ttu-id="16cdb-162">Da diese Methode mit verschiedenen Effekttypen verwendet werden kann, müssen Sie die zurückgegebene Instanz in ein [**FaceDetectionEffect**](https://msdn.microsoft.com/library/windows/apps/dn948776)-Objekt umwandeln.</span><span class="sxs-lookup"><span data-stu-id="16cdb-162">Because this method can be used with multiple effect types, you must cast the returned instance to a [**FaceDetectionEffect**](https://msdn.microsoft.com/library/windows/apps/dn948776) object.</span></span>

<span data-ttu-id="16cdb-163">Aktivieren bzw. deaktivieren Sie den Effekt, indem Sie die [**FaceDetectionEffect.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948818)-Eigenschaft festlegen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-163">Enable or disable the effect by setting the [**FaceDetectionEffect.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948818) property.</span></span> <span data-ttu-id="16cdb-164">Geben Sie an, wie oft der Effekt Frames analysieren soll, indem Sie die [**FaceDetectionEffect.DesiredDetectionInterval**](https://msdn.microsoft.com/library/windows/apps/dn948814)-Eigenschaft festlegen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-164">Adjust how often the effect analyzes frames by setting the [**FaceDetectionEffect.DesiredDetectionInterval**](https://msdn.microsoft.com/library/windows/apps/dn948814) property.</span></span> <span data-ttu-id="16cdb-165">Beide Eigenschaften können angepasst werden, während der Medienaufnahme ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="16cdb-165">Both of these properties can be adjusted while media capture is ongoing.</span></span>

[!code-cs[<span data-ttu-id="16cdb-166">CreateFaceDetectionEffectAsync</span><span class="sxs-lookup"><span data-stu-id="16cdb-166">CreateFaceDetectionEffectAsync</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetCreateFaceDetectionEffectAsync)]

### <a name="receive-notifications-when-faces-are-detected"></a><span data-ttu-id="16cdb-167">Empfangen von Benachrichtigungen, wenn Gesichter erkannt werden</span><span class="sxs-lookup"><span data-stu-id="16cdb-167">Receive notifications when faces are detected</span></span>

<span data-ttu-id="16cdb-168">Wenn Sie während der Gesichtserkennung Aktionen ausführen möchten, z. B. Zeichnen eines Rahmens um die erkannten Gesichter in der Videovorschau, können Sie eine Registrierung für das [**FaceDetected**](https://msdn.microsoft.com/library/windows/apps/dn948820)-Ereignis durchführen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-168">If you want to perform some action when faces are detected, such as drawing a box around detected faces in the video preview, you can register for the [**FaceDetected**](https://msdn.microsoft.com/library/windows/apps/dn948820) event.</span></span>

[!code-cs[<span data-ttu-id="16cdb-169">RegisterFaceDetectionHandler</span><span class="sxs-lookup"><span data-stu-id="16cdb-169">RegisterFaceDetectionHandler</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetRegisterFaceDetectionHandler)]

<span data-ttu-id="16cdb-170">Im Handler für das Ereignis erhalten Sie eine Liste mit allen in einem Frame erkannten Gesichtern, indem Sie auf die [**FaceDetectionEffectFrame.DetectedFaces**](https://msdn.microsoft.com/library/windows/apps/dn948792)-Eigenschaft von [**FaceDetectedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn948774) zugreifen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-170">In the handler for the event, you can get a list of all faces detected in a frame by accessing the [**FaceDetectionEffectFrame.DetectedFaces**](https://msdn.microsoft.com/library/windows/apps/dn948792) property of the [**FaceDetectedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn948774).</span></span> <span data-ttu-id="16cdb-171">Die [**FaceBox**](https://msdn.microsoft.com/library/windows/apps/dn974126)-Eigenschaft ist eine [**BitmapBounds**](https://msdn.microsoft.com/library/windows/apps/br226169)-Struktur, die das Rechteck mit dem erkannten Gesicht relativ zu den Abmessungen des Vorschaudatenstroms beschreibt.</span><span class="sxs-lookup"><span data-stu-id="16cdb-171">The [**FaceBox**](https://msdn.microsoft.com/library/windows/apps/dn974126) property is a [**BitmapBounds**](https://msdn.microsoft.com/library/windows/apps/br226169) structure that describes the rectangle containing the detected face in units relative to the preview stream dimensions.</span></span> <span data-ttu-id="16cdb-172">Einen Beispielcode, der die Koordinaten des Vorschaudatenstroms in Bildschirmkoordinaten umwandelt, finden Sie unter [Gesichtserkennungsbeispiel für UWP](http://go.microsoft.com/fwlink/?LinkId=619486).</span><span class="sxs-lookup"><span data-stu-id="16cdb-172">To view sample code that transforms the preview stream coordinates into screen coordinates, see the [face detection UWP sample](http://go.microsoft.com/fwlink/?LinkId=619486).</span></span>

[!code-cs[<span data-ttu-id="16cdb-173">FaceDetected</span><span class="sxs-lookup"><span data-stu-id="16cdb-173">FaceDetected</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetFaceDetected)]

### <a name="clean-up-the-face-detection-effect"></a><span data-ttu-id="16cdb-174">Bereinigen des Gesichtserkennungseffekts</span><span class="sxs-lookup"><span data-stu-id="16cdb-174">Clean up the face detection effect</span></span>

<span data-ttu-id="16cdb-175">Wenn Ihre App die Aufnahme abgeschlossen hat, deaktivieren Sie vor dem Löschen des **MediaCapture**-Objekts den Gesichtserkennungseffekt mit [**FaceDetectionEffect.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948818), und heben Sie die Registrierung Ihres [**FaceDetected**](https://msdn.microsoft.com/library/windows/apps/dn948820)-Ereignishandlers auf, wenn Sie einen registriert haben.</span><span class="sxs-lookup"><span data-stu-id="16cdb-175">When your app is done capturing, before disposing of the **MediaCapture** object, you should disable the face detection effect with [**FaceDetectionEffect.Enabled**](https://msdn.microsoft.com/library/windows/apps/dn948818) and unregister your [**FaceDetected**](https://msdn.microsoft.com/library/windows/apps/dn948820) event handler if you previously registered one.</span></span> <span data-ttu-id="16cdb-176">Rufen Sie [**MediaCapture.ClearEffectsAsync**](https://msdn.microsoft.com/library/windows/apps/br226592) auf, und geben Sie den Videovorschaudatenstrom an, da der Effekt diesem Datenstrom hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="16cdb-176">Call [**MediaCapture.ClearEffectsAsync**](https://msdn.microsoft.com/library/windows/apps/br226592), specifying the video preview stream since that was the stream to which the effect was added.</span></span> <span data-ttu-id="16cdb-177">Legen Sie schließlich die Membervariable auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="16cdb-177">Finally, set your member variable to null.</span></span>

[!code-cs[<span data-ttu-id="16cdb-178">CleanUpFaceDetectionEffectAsync</span><span class="sxs-lookup"><span data-stu-id="16cdb-178">CleanUpFaceDetectionEffectAsync</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetCleanUpFaceDetectionEffectAsync)]

### <a name="check-for-focus-and-exposure-support-for-detected-faces"></a><span data-ttu-id="16cdb-179">Überprüfen der Fokus- und Belichtungsunterstützung für erkannte Gesichter</span><span class="sxs-lookup"><span data-stu-id="16cdb-179">Check for focus and exposure support for detected faces</span></span>

<span data-ttu-id="16cdb-180">Nicht alle Geräte verfügen über ein Aufnahmegerät, das den Fokus und die Belichtung auf Grundlage der erkannten Gesichter anpassen kann.</span><span class="sxs-lookup"><span data-stu-id="16cdb-180">Not all devices have a capture device that can adjust its focus and exposure based on detected faces.</span></span> <span data-ttu-id="16cdb-181">Da Gesichtserkennung Geräteressourcen in Anspruch nimmt, sollten Sie die Gesichtserkennung nur auf Geräten aktivieren, die das Feature zur Verbesserung der Aufnahme verwenden können.</span><span class="sxs-lookup"><span data-stu-id="16cdb-181">Because face detection consumes device resources, you may only want to enable face detection on devices that can use the feature to enhance capture.</span></span> <span data-ttu-id="16cdb-182">Rufen Sie zum Festzustellen, ob die gesichtsbasierte Aufnahmeoptimierung verfügbar ist, die [**VideoDeviceController**](https://msdn.microsoft.com/library/windows/apps/br226825)-Klasse für Ihre initialisierte [MediaCapture](capture-photos-and-video-with-mediacapture.md) ab, und rufen Sie dann die [**RegionsOfInterestControl**](https://msdn.microsoft.com/library/windows/apps/dn279064)-Klasse des Videogerätecontrollers ab.</span><span class="sxs-lookup"><span data-stu-id="16cdb-182">To see if face-based capture optimization is available, get the [**VideoDeviceController**](https://msdn.microsoft.com/library/windows/apps/br226825) for your initialized [MediaCapture](capture-photos-and-video-with-mediacapture.md) and then get the video device controller's [**RegionsOfInterestControl**](https://msdn.microsoft.com/library/windows/apps/dn279064).</span></span> <span data-ttu-id="16cdb-183">Überprüfen Sie, ob die [**MaxRegions**](https://msdn.microsoft.com/library/windows/apps/dn279069)-Eigenschaft mindestens eine Region unterstützt.</span><span class="sxs-lookup"><span data-stu-id="16cdb-183">Check to see if the [**MaxRegions**](https://msdn.microsoft.com/library/windows/apps/dn279069) supports at least one region.</span></span> <span data-ttu-id="16cdb-184">Überprüfen Sie dann, ob die [**AutoExposureSupported**](https://msdn.microsoft.com/library/windows/apps/dn279065)-Eigenschaft oder die [**AutoFocusSupported**](https://msdn.microsoft.com/library/windows/apps/dn279066)-Eigenschaft den Wert „true“ aufweist.</span><span class="sxs-lookup"><span data-stu-id="16cdb-184">Then check to see if either [**AutoExposureSupported**](https://msdn.microsoft.com/library/windows/apps/dn279065) or [**AutoFocusSupported**](https://msdn.microsoft.com/library/windows/apps/dn279066) are true.</span></span> <span data-ttu-id="16cdb-185">Wenn diese Bedingungen erfüllt sind, kann das Gerät die Vorteile der Gesichtserkennung für eine verbesserte Aufnahme nutzen.</span><span class="sxs-lookup"><span data-stu-id="16cdb-185">If these conditions are met, then the device can take advantage of face detection to enhance capture.</span></span>

[!code-cs[<span data-ttu-id="16cdb-186">AreFaceFocusAndExposureSupported</span><span class="sxs-lookup"><span data-stu-id="16cdb-186">AreFaceFocusAndExposureSupported</span></span>](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetAreFaceFocusAndExposureSupported)]

## <a name="related-topics"></a><span data-ttu-id="16cdb-187">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="16cdb-187">Related topics</span></span>

* [<span data-ttu-id="16cdb-188">Kamera</span><span class="sxs-lookup"><span data-stu-id="16cdb-188">Camera</span></span>](camera.md)
* [<span data-ttu-id="16cdb-189">Allgemeine Foto-, Video- und Audioaufnahme mit „MediaCapture“</span><span class="sxs-lookup"><span data-stu-id="16cdb-189">Basic photo, video, and audio capture with MediaCapture</span></span>](basic-photo-video-and-audio-capture-with-MediaCapture.md)
 

 




