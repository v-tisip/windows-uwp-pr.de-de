---
author: laurenhughes
ms.assetid: 3FD2AA71-EF67-47B2-9332-3FFA5D3703EA
description: "In diesem Artikel wird das Laden und Speichern von Bilddateien mit BitmapDecoder und BitmapEncoder sowie das Verwenden des SoftwareBitmap-Objekts zum Darstellen von Bitmapbildern erläutert."
title: Erstellen, Bearbeiten und Speichern von Bitmapbildern
ms.author: lahugh
ms.date: 02/08/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows10, UWP
ms.openlocfilehash: 8679dfd073a3b756e37059a5b0bf35cc6b000e6a
ms.sourcegitcommit: bfa61aae632cca0c68dbfb0168424d38fd607f84
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/31/2017
---
# <a name="create-edit-and-save-bitmap-images"></a><span data-ttu-id="242c3-104">Erstellen, Bearbeiten und Speichern von Bitmapbildern</span><span class="sxs-lookup"><span data-stu-id="242c3-104">Create, edit, and save bitmap images</span></span>

<span data-ttu-id="242c3-105">\[ Aktualisiert für UWP-Apps unter Windows10.</span><span class="sxs-lookup"><span data-stu-id="242c3-105">\[ Updated for UWP apps on Windows 10.</span></span> <span data-ttu-id="242c3-106">Artikel zu Windows8.x finden Sie im [Archiv](http://go.microsoft.com/fwlink/p/?linkid=619132) \].</span><span class="sxs-lookup"><span data-stu-id="242c3-106">For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \]</span></span>


<span data-ttu-id="242c3-107">In diesem Artikel wird das Laden und Speichern von Bilddateien mit [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) und [**BitmapEncoder**](https://msdn.microsoft.com/library/windows/apps/br226206) sowie das Verwenden des [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358)-Objekts zum Darstellen von Bitmapbildern erläutert.</span><span class="sxs-lookup"><span data-stu-id="242c3-107">This article explains how to load and save image files using [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) and [**BitmapEncoder**](https://msdn.microsoft.com/library/windows/apps/br226206) and how to use the [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) object to represent bitmap images.</span></span>

<span data-ttu-id="242c3-108">Die **SoftwareBitmap**-Klasse ist eine vielseitige API, die aus mehreren Quellen, z.B. Bilddateien, [**WriteableBitmap**](https://msdn.microsoft.com/library/windows/apps/br243259)-Objekten, Direct3D-Oberflächen und Code erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="242c3-108">The **SoftwareBitmap** class is a versatile API that can be created from multiple sources including image files, [**WriteableBitmap**](https://msdn.microsoft.com/library/windows/apps/br243259) objects, Direct3D surfaces, and code.</span></span> <span data-ttu-id="242c3-109">**SoftwareBitmap** ermöglicht Ihnen die einfache Konvertierung zwischen verschiedenen Pixelformaten und Alphamodi und einen Zugriff auf niedriger Ebene auf Pixeldaten.</span><span class="sxs-lookup"><span data-stu-id="242c3-109">**SoftwareBitmap** allows you to easily convert between different pixel formats and alpha modes, and allows low-level access to pixel data.</span></span> <span data-ttu-id="242c3-110">**SoftwareBitmap** stellt des Weiteren eine gemeinsame Schnittstelle dar, die von mehreren Features von Windows verwendet wird, darunter:</span><span class="sxs-lookup"><span data-stu-id="242c3-110">Also, **SoftwareBitmap** is a common interface used by multiple features of Windows, including:</span></span>

-   <span data-ttu-id="242c3-111">[**CapturedFrame**](https://msdn.microsoft.com/library/windows/apps/dn278725) ermöglicht Ihnen das Abrufen von durch die Kamera erfassten Frames als **SoftwareBitmap**.</span><span class="sxs-lookup"><span data-stu-id="242c3-111">[**CapturedFrame**](https://msdn.microsoft.com/library/windows/apps/dn278725) allows you to get frames captured by the camera as a **SoftwareBitmap**.</span></span>

-   <span data-ttu-id="242c3-112">[**VideoFrame**](https://msdn.microsoft.com/library/windows/apps/dn930917) ermöglicht Ihnen das Abrufen einer **SoftwareBitmap**-Repräsentation eines **VideoFrame**.</span><span class="sxs-lookup"><span data-stu-id="242c3-112">[**VideoFrame**](https://msdn.microsoft.com/library/windows/apps/dn930917) allows you to get a **SoftwareBitmap** representation of a **VideoFrame**.</span></span>

-   <span data-ttu-id="242c3-113">[**FaceDetector**](https://msdn.microsoft.com/library/windows/apps/dn974129) ermöglicht Ihnen das Erkennen von Gesichtern in einer **SoftwareBitmap**.</span><span class="sxs-lookup"><span data-stu-id="242c3-113">[**FaceDetector**](https://msdn.microsoft.com/library/windows/apps/dn974129) allows you to detect faces in a **SoftwareBitmap**.</span></span>

<span data-ttu-id="242c3-114">Der Beispielcode in diesem Artikel verwendet APIs aus den folgenden Namespaces.</span><span class="sxs-lookup"><span data-stu-id="242c3-114">The sample code in this article uses APIs from the following namespaces.</span></span>

[!code-cs[<span data-ttu-id="242c3-115">Namespaces</span><span class="sxs-lookup"><span data-stu-id="242c3-115">Namespaces</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetNamespaces)]

## <a name="create-a-softwarebitmap-from-an-image-file-with-bitmapdecoder"></a><span data-ttu-id="242c3-116">Erstellen eines SoftwareBitmap-Objekts aus einer Bilddatei mit „BitmapDecoder“</span><span class="sxs-lookup"><span data-stu-id="242c3-116">Create a SoftwareBitmap from an image file with BitmapDecoder</span></span>

<span data-ttu-id="242c3-117">Rufen Sie zum Erstellen eines [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358)-Objekts aus einer Datei eine Instanz von [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) ab, die die Bilddaten enthält.</span><span class="sxs-lookup"><span data-stu-id="242c3-117">To create a [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) from a file, get an instance of [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) containing the image data.</span></span> <span data-ttu-id="242c3-118">In diesem Beispiel wird [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) verwendet, damit Benutzer eine Bilddatei auswählen können.</span><span class="sxs-lookup"><span data-stu-id="242c3-118">This example uses a [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) to allow the user to select an image file.</span></span>

[!code-cs[<span data-ttu-id="242c3-119">PickInputFile</span><span class="sxs-lookup"><span data-stu-id="242c3-119">PickInputFile</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetPickInputFile)]

<span data-ttu-id="242c3-120">Rufen Sie die [**OpenAsync**](https://msdn.microsoft.com/library/windows/apps/br227116)-Methode des **StorageFile**-Objekts auf, um einen Datenstrom mit wahlfreiem Zugriff mit den Bilddaten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="242c3-120">Call the [**OpenAsync**](https://msdn.microsoft.com/library/windows/apps/br227116) method of the **StorageFile** object to get a random access stream containing the image data.</span></span> <span data-ttu-id="242c3-121">Rufen Sie die statische [**BitmapDecoder.CreateAsync**](https://msdn.microsoft.com/library/windows/apps/br226182)-Methode auf, um eine Instanz der [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176)-Klasse für den angegebenen Datenstrom abzurufen.</span><span class="sxs-lookup"><span data-stu-id="242c3-121">Call the static method [**BitmapDecoder.CreateAsync**](https://msdn.microsoft.com/library/windows/apps/br226182) to get an instance of the [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) class for the specified stream.</span></span> <span data-ttu-id="242c3-122">Rufen Sie [**GetSoftwareBitmapAsync**](https://msdn.microsoft.com/library/windows/apps/dn887332) auf, um ein [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358)-Objekt mit dem Bild abzurufen.</span><span class="sxs-lookup"><span data-stu-id="242c3-122">Call [**GetSoftwareBitmapAsync**](https://msdn.microsoft.com/library/windows/apps/dn887332) to get a [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) object containing the image.</span></span>

[!code-cs[<span data-ttu-id="242c3-123">CreateSoftwareBitmapFromFile</span><span class="sxs-lookup"><span data-stu-id="242c3-123">CreateSoftwareBitmapFromFile</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetCreateSoftwareBitmapFromFile)]

## <a name="save-a-softwarebitmap-to-a-file-with-bitmapencoder"></a><span data-ttu-id="242c3-124">Speichern eines SoftwareBitmap-Objekts in einer Datei mit „BitmapEncoder“</span><span class="sxs-lookup"><span data-stu-id="242c3-124">Save a SoftwareBitmap to a file with BitmapEncoder</span></span>

<span data-ttu-id="242c3-125">Rufen Sie zum Speichern eines **SoftwareBitmap**-Objekts in einer Datei eine Instanz von **StorageFile** auf, in der das Bild gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="242c3-125">To save a **SoftwareBitmap** to a file, get an instance of **StorageFile** to which the image will be saved.</span></span> <span data-ttu-id="242c3-126">In diesem Beispiel wird [**FileSavePicker**](https://msdn.microsoft.com/library/windows/apps/br207871) verwendet, damit Benutzer eine Ausgabedatei auswählen können.</span><span class="sxs-lookup"><span data-stu-id="242c3-126">This example uses a [**FileSavePicker**](https://msdn.microsoft.com/library/windows/apps/br207871) to allow the user to select an output file.</span></span>

[!code-cs[<span data-ttu-id="242c3-127">PickOuputFile</span><span class="sxs-lookup"><span data-stu-id="242c3-127">PickOuputFile</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetPickOuputFile)]

<span data-ttu-id="242c3-128">Rufen Sie die [**OpenAsync**](https://msdn.microsoft.com/library/windows/apps/br227116)-Methode des **StorageFile**-Objekts auf, um einen Datenstrom mit wahlfreiem Zugriff abzurufen, in den das Bild geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="242c3-128">Call the [**OpenAsync**](https://msdn.microsoft.com/library/windows/apps/br227116) method of the **StorageFile** object to get a random access stream to which the image will be written.</span></span> <span data-ttu-id="242c3-129">Rufen Sie die statische [**BitmapEncoder.CreateAsync**](https://msdn.microsoft.com/library/windows/apps/br226211)-Methode auf, um eine Instanz der [**BitmapEncoder**](https://msdn.microsoft.com/library/windows/apps/br226206)-Klasse für den angegebenen Datenstrom abzurufen.</span><span class="sxs-lookup"><span data-stu-id="242c3-129">Call the static method [**BitmapEncoder.CreateAsync**](https://msdn.microsoft.com/library/windows/apps/br226211) to get an instance of the [**BitmapEncoder**](https://msdn.microsoft.com/library/windows/apps/br226206) class for the specified stream.</span></span> <span data-ttu-id="242c3-130">Der erste Parameter für **CreateAsync** ist eine GUID, die den zum Codieren des Bilds zu verwendenden Codec darstellt.</span><span class="sxs-lookup"><span data-stu-id="242c3-130">The first parameter to **CreateAsync** is a GUID representing the codec that should be used to encode the image.</span></span> <span data-ttu-id="242c3-131">Die **BitmapEncoder**-Klasse stellt eine Eigenschaft bereit, die die ID für jeden vom Encoder unterstützten Codec enthält, z.B. [**JpegEncoderId**](https://msdn.microsoft.com/library/windows/apps/br226226).</span><span class="sxs-lookup"><span data-stu-id="242c3-131">**BitmapEncoder** class exposes a property containing the ID for each codec supported by the encoder, such as [**JpegEncoderId**](https://msdn.microsoft.com/library/windows/apps/br226226).</span></span>

<span data-ttu-id="242c3-132">Verwenden Sie die [**SetSoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887337)-Methode zum Festlegen des Bilds, das codiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="242c3-132">Use the [**SetSoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887337) method to set the image that will be encoded.</span></span> <span data-ttu-id="242c3-133">Sie können auch Werte der [**BitmapTransform**](https://msdn.microsoft.com/library/windows/apps/br226254)-Eigenschaft festlegen, um grundlegende Transformationen auf das Bild anzuwenden, während es codiert wird.</span><span class="sxs-lookup"><span data-stu-id="242c3-133">You can set values of the [**BitmapTransform**](https://msdn.microsoft.com/library/windows/apps/br226254) property to apply basic transforms to the image while it is being encoded.</span></span> <span data-ttu-id="242c3-134">Die [**IsThumbnailGenerated**](https://msdn.microsoft.com/library/windows/apps/br226225)-Eigenschaft bestimmt, ob eine Miniaturansicht vom Encoder generiert wird.</span><span class="sxs-lookup"><span data-stu-id="242c3-134">The [**IsThumbnailGenerated**](https://msdn.microsoft.com/library/windows/apps/br226225) property determines whether a thumbnail is generated by the encoder.</span></span> <span data-ttu-id="242c3-135">Beachten Sie, dass nicht alle Dateiformate die Miniaturansicht unterstützen. Deshalb sollten Sie bei Verwendung dieses Features die Fehler zu nicht unterstützten Vorgängen auffangen, die ausgelöst werden, wenn die Miniaturansicht nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="242c3-135">Note that not all file formats support thumbnails, so if you use this feature, you should catch the unsupported operation error that will be thrown if thumbnails are not supported.</span></span>

<span data-ttu-id="242c3-136">Rufen Sie die [**FlushAsync**](https://msdn.microsoft.com/library/windows/apps/br226216)-Methode auf, damit der Encoder die Bilddaten in die angegebene Datei schreibt.</span><span class="sxs-lookup"><span data-stu-id="242c3-136">Call [**FlushAsync**](https://msdn.microsoft.com/library/windows/apps/br226216) to cause the encoder to write the image data to the specified file.</span></span>

[!code-cs[<span data-ttu-id="242c3-137">SaveSoftwareBitmapToFile</span><span class="sxs-lookup"><span data-stu-id="242c3-137">SaveSoftwareBitmapToFile</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetSaveSoftwareBitmapToFile)]

<span data-ttu-id="242c3-138">Sie können beim Erstellen von **BitmapEncoder** zusätzliche Codierungsoptionen angeben, indem Sie ein neues [**BitmapPropertySet**](https://msdn.microsoft.com/library/windows/apps/hh974338)-Objekt erstellen und dieses mit einem oder mehreren [**BitmapTypedValue**](https://msdn.microsoft.com/library/windows/apps/hh700687)-Objekten auffüllen, die die Encodereinstellungen darstellen.</span><span class="sxs-lookup"><span data-stu-id="242c3-138">You can specify additional encoding options when you create the **BitmapEncoder** by creating a new [**BitmapPropertySet**](https://msdn.microsoft.com/library/windows/apps/hh974338) object and populating it with one or more [**BitmapTypedValue**](https://msdn.microsoft.com/library/windows/apps/hh700687) objects representing the encoder settings.</span></span> <span data-ttu-id="242c3-139">Eine Liste der unterstützten Encoderoptionen finden Sie unter [Referenz zu BitmapEncoder-Optionen](bitmapencoder-options-reference.md).</span><span class="sxs-lookup"><span data-stu-id="242c3-139">For a list of supported encoder options, see [BitmapEncoder options reference](bitmapencoder-options-reference.md).</span></span>

[!code-cs[<span data-ttu-id="242c3-140">UseEncodingOptions</span><span class="sxs-lookup"><span data-stu-id="242c3-140">UseEncodingOptions</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetUseEncodingOptions)]

## <a name="use-softwarebitmap-with-a-xaml-image-control"></a><span data-ttu-id="242c3-141">Verwenden von „SoftwareBitmap“ mit einem XAML-Image-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="242c3-141">Use SoftwareBitmap with a XAML Image control</span></span>

<span data-ttu-id="242c3-142">Um ein Bild unter Verwendung des [**Image**](https://msdn.microsoft.com/library/windows/apps/br242752)-Steuerelements auf einer XAML-Seite anzuzeigen, definieren Sie zunächst ein **Image**-Steuerelement in der XAML-Seite.</span><span class="sxs-lookup"><span data-stu-id="242c3-142">To display an image within a XAML page using the [**Image**](https://msdn.microsoft.com/library/windows/apps/br242752) control, first define an **Image** control in your XAML page.</span></span>

[!code-xml[<span data-ttu-id="242c3-143">ImageControl</span><span class="sxs-lookup"><span data-stu-id="242c3-143">ImageControl</span></span>](./code/ImagingWin10/cs/MainPage.xaml#SnippetImageControl)]

<span data-ttu-id="242c3-144">Zurzeit unterstützt das Steuerelement **Image** nur Bilder, die BGRA8-Codierung und einen vormultiplizierten oder No-Alpha-Kanal verwenden.</span><span class="sxs-lookup"><span data-stu-id="242c3-144">Currently, the **Image** control only supports images that use BGRA8 encoding and pre-multiplied or no alpha channel.</span></span> <span data-ttu-id="242c3-145">Bevor Sie versuchen, ein Bild anzuzeigen, sollten Sie einen Test durchführen, um sicherzustellen, dass es das richtige Format hat. Wenn dies nicht der Fall ist, verwenden Sie die statische [**Convert**](https://msdn.microsoft.com/library/windows/apps/dn887362)-Methode von **SoftwareBitmap**, um das Bild in das unterstützte Format zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="242c3-145">Before attempting to display an image, test to make sure it has the correct format, and if not, use the **SoftwareBitmap** static [**Convert**](https://msdn.microsoft.com/library/windows/apps/dn887362) method to convert the image to the supported format.</span></span>

<span data-ttu-id="242c3-146">Erstellen Sie ein neues [**SoftwareBitmapSource**](https://msdn.microsoft.com/library/windows/apps/dn997854)-Objekt.</span><span class="sxs-lookup"><span data-stu-id="242c3-146">Create a new [**SoftwareBitmapSource**](https://msdn.microsoft.com/library/windows/apps/dn997854) object.</span></span> <span data-ttu-id="242c3-147">Legen Sie den Inhalt des Quellobjekts durch Aufrufen von [**SetBitmapAsync**](https://msdn.microsoft.com/library/windows/apps/dn997856) fest, und übergeben Sie dabei ein **SoftwareBitmap**-Objekt.</span><span class="sxs-lookup"><span data-stu-id="242c3-147">Set the contents of the source object by calling [**SetBitmapAsync**](https://msdn.microsoft.com/library/windows/apps/dn997856), passing in a **SoftwareBitmap**.</span></span> <span data-ttu-id="242c3-148">Anschließend können Sie die [**Source**](https://msdn.microsoft.com/library/windows/apps/br242760)-Eigenschaft des **Image**-Steuerelements auf das neu erstellte **SoftwareBitmapSource**-Objekt festlegen.</span><span class="sxs-lookup"><span data-stu-id="242c3-148">Then you can set the [**Source**](https://msdn.microsoft.com/library/windows/apps/br242760) property of the **Image** control to the newly created **SoftwareBitmapSource**.</span></span>

[!code-cs[<span data-ttu-id="242c3-149">SoftwareBitmapToWriteableBitmap</span><span class="sxs-lookup"><span data-stu-id="242c3-149">SoftwareBitmapToWriteableBitmap</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetSoftwareBitmapToWriteableBitmap)]

<span data-ttu-id="242c3-150">Sie können auch **SoftwareBitmapSource** verwenden, um für [**ImageBrush**](https://msdn.microsoft.com/library/windows/apps/br210101) ein **SoftwareBitmap**-Objekt als [**ImageSource**](https://msdn.microsoft.com/library/windows/apps/br210105) festzulegen.</span><span class="sxs-lookup"><span data-stu-id="242c3-150">You can also use **SoftwareBitmapSource** to set a **SoftwareBitmap** as the [**ImageSource**](https://msdn.microsoft.com/library/windows/apps/br210105) for an [**ImageBrush**](https://msdn.microsoft.com/library/windows/apps/br210101).</span></span>

## <a name="create-a-softwarebitmap-from-a-writeablebitmap"></a><span data-ttu-id="242c3-151">Erstellen eines SoftwareBitmap-Objekts aus „WriteableBitmap“</span><span class="sxs-lookup"><span data-stu-id="242c3-151">Create a SoftwareBitmap from a WriteableBitmap</span></span>

<span data-ttu-id="242c3-152">Sie können ein **SoftwareBitmap**-Objekt aus einem vorhandenen **WriteableBitmap**-Objekt erstellen, indem Sie die [**SoftwareBitmap.CreateCopyFromBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887370)-Methode aufrufen und die **PixelBuffer**-Eigenschaft des **WriteableBitmap**-Objekts zum Festlegen der Pixeldaten bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="242c3-152">You can create a **SoftwareBitmap** from an existing **WriteableBitmap** by calling [**SoftwareBitmap.CreateCopyFromBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887370) and supplying the **PixelBuffer** property of the **WriteableBitmap** to set the pixel data.</span></span> <span data-ttu-id="242c3-153">Mit dem zweiten Argument können Sie ein Pixelformat für das neu erstellte **WriteableBitmap**-Objekt anfordern.</span><span class="sxs-lookup"><span data-stu-id="242c3-153">The second argument allows you to request a pixel format for the newly created **WriteableBitmap**.</span></span> <span data-ttu-id="242c3-154">Sie können die [**PixelWidth**](https://msdn.microsoft.com/library/windows/apps/br243253)- und [**PixelHeight**](https://msdn.microsoft.com/library/windows/apps/br243251)-Eigenschaften des **WriteableBitmap**-Objekts zum Festlegen der Abmessungen des neuen Bilds verwenden.</span><span class="sxs-lookup"><span data-stu-id="242c3-154">You can use the [**PixelWidth**](https://msdn.microsoft.com/library/windows/apps/br243253) and [**PixelHeight**](https://msdn.microsoft.com/library/windows/apps/br243251) properties of the **WriteableBitmap** to specify the dimensions of the new image.</span></span>

[!code-cs[<span data-ttu-id="242c3-155">WriteableBitmapToSoftwareBitmap</span><span class="sxs-lookup"><span data-stu-id="242c3-155">WriteableBitmapToSoftwareBitmap</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetWriteableBitmapToSoftwareBitmap)]

## <a name="create-or-edit-a-softwarebitmap-programmatically"></a><span data-ttu-id="242c3-156">Programmgesteuertes Erstellen oder Bearbeiten eines SoftwareBitmap-Objekts</span><span class="sxs-lookup"><span data-stu-id="242c3-156">Create or edit a SoftwareBitmap programmatically</span></span>

<span data-ttu-id="242c3-157">Bisher wurde in diesem Thema das Arbeiten mit Bilddateien behandelt.</span><span class="sxs-lookup"><span data-stu-id="242c3-157">So far this topic has addressed working with image files.</span></span> <span data-ttu-id="242c3-158">Sie können ein neues **SoftwareBitmap**-Objekt auch programmgesteuert im Code erstellen und das gleiche Verfahren zum Zugreifen auf und Bearbeiten der Pixeldaten von **SoftwareBitmap** verwenden.</span><span class="sxs-lookup"><span data-stu-id="242c3-158">You can also create a new **SoftwareBitmap** programatically in code and use the same technique to access and modify the **SoftwareBitmap**'s pixel data.</span></span>

<span data-ttu-id="242c3-159">**SoftwareBitmap** verwendet COM-Interop, um den Rohdatenpuffer mit Pixeldaten zur Verfügung zu stellen.</span><span class="sxs-lookup"><span data-stu-id="242c3-159">**SoftwareBitmap** uses COM interop to expose the raw buffer containing the pixel data.</span></span>

<span data-ttu-id="242c3-160">Zur Verwendung von COM-Interop müssen Sie einen Verweis auf den **System.Runtime.InteropServices**-Namespace in Ihr Projekt einbeziehen.</span><span class="sxs-lookup"><span data-stu-id="242c3-160">To use COM interop, you must include a reference to the **System.Runtime.InteropServices** namespace in your project.</span></span>

[!code-cs[<span data-ttu-id="242c3-161">InteropNamespace</span><span class="sxs-lookup"><span data-stu-id="242c3-161">InteropNamespace</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetInteropNamespace)]

<span data-ttu-id="242c3-162">Initialisieren Sie die [**IMemoryBufferByteAccess**](https://msdn.microsoft.com/library/windows/desktop/mt297505)-COM-Schnittstelle, indem Sie Ihrem Namespace den folgenden Code hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="242c3-162">Initialize the [**IMemoryBufferByteAccess**](https://msdn.microsoft.com/library/windows/desktop/mt297505) COM interface by adding the following code within your namespace.</span></span>

[!code-cs[<span data-ttu-id="242c3-163">COMImport</span><span class="sxs-lookup"><span data-stu-id="242c3-163">COMImport</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetCOMImport)]

<span data-ttu-id="242c3-164">Erstellen Sie ein neues **SoftwareBitmap**-Objekt mit dem gewünschten Pixelformat und der gewünschten Größe.</span><span class="sxs-lookup"><span data-stu-id="242c3-164">Create a new **SoftwareBitmap** with pixel format and size you want.</span></span> <span data-ttu-id="242c3-165">Sie können auch ein vorhandenes **SoftwareBitmap**-Objekt verwenden, für das Sie die Pixeldaten bearbeiten möchten.</span><span class="sxs-lookup"><span data-stu-id="242c3-165">Or, use an existing **SoftwareBitmap** for which you want to edit the pixel data.</span></span> <span data-ttu-id="242c3-166">Rufen Sie die [**SoftwareBitmap.LockBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887380)-Methode zum Abrufen einer Instanz der [**BitmapBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887325)-Klasse auf, die den Pixeldatenpuffer darstellt.</span><span class="sxs-lookup"><span data-stu-id="242c3-166">Call [**SoftwareBitmap.LockBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887380) to obtain an instance of the [**BitmapBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887325) class representing the pixel data buffer.</span></span> <span data-ttu-id="242c3-167">Wandeln Sie **BitmapBuffer** in die **IMemoryBufferByteAccess**-COM-Schnittstelle um, und rufen Sie dann [**IMemoryBufferByteAccess.GetBuffer**](https://msdn.microsoft.com/library/windows/desktop/mt297506) auf, um ein Bytearray mit Daten aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="242c3-167">Cast the **BitmapBuffer** to the **IMemoryBufferByteAccess** COM interface and then call [**IMemoryBufferByteAccess.GetBuffer**](https://msdn.microsoft.com/library/windows/desktop/mt297506) to populate a byte array with data.</span></span> <span data-ttu-id="242c3-168">Verwenden Sie die [**BitmapBuffer.GetPlaneDescription**](https://msdn.microsoft.com/library/windows/apps/dn887330)-Methode zum Abrufen eines [**BitmapPlaneDescription**](https://msdn.microsoft.com/library/windows/apps/dn887342)-Objekts, mit dem Sie den Offset in den Puffer für jedes Pixel berechnen können.</span><span class="sxs-lookup"><span data-stu-id="242c3-168">Use the [**BitmapBuffer.GetPlaneDescription**](https://msdn.microsoft.com/library/windows/apps/dn887330) method to get a [**BitmapPlaneDescription**](https://msdn.microsoft.com/library/windows/apps/dn887342) object that will help you calculate the offset into the buffer for each pixel.</span></span>

[!code-cs[<span data-ttu-id="242c3-169">CreateNewSoftwareBitmap</span><span class="sxs-lookup"><span data-stu-id="242c3-169">CreateNewSoftwareBitmap</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetCreateNewSoftwareBitmap)]

<span data-ttu-id="242c3-170">Da diese Methode auf den Rohdatenpuffer zugreift, der Windows-Runtime-Typen zugrunde liegt, muss diese mithilfe des Schlüsselworts **unsafe** deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="242c3-170">Because this method accesses the raw buffer underlying the Windows Runtime types, it must be declared using the **unsafe** keyword.</span></span> <span data-ttu-id="242c3-171">Außerdem müssen Sie das Projekt in Microsoft Visual Studio so konfigurieren, dass die Kompilierung von unsicherem Code zugelassen wird, indem Sie die Seite **Eigenschaften** des Projekts öffnen, auf die Eigenschaftenseite **Build** klicken und das Kontrollkästchen **Unsicheren Code zulassen** aktivieren.</span><span class="sxs-lookup"><span data-stu-id="242c3-171">You must also configure your project in Microsoft Visual Studio to allow the compilation of unsafe code by opening the project's **Properties** page, clicking the **Build** property page, and selecting the **Allow Unsafe Code** checkbox.</span></span>

## <a name="create-a-softwarebitmap-from-a-direct3d-surface"></a><span data-ttu-id="242c3-172">Erstellen eines SoftwareBitmap-Objekts aus einer Direct3D-Oberfläche</span><span class="sxs-lookup"><span data-stu-id="242c3-172">Create a SoftwareBitmap from a Direct3D surface</span></span>

<span data-ttu-id="242c3-173">Zum Erstellen eines **SoftwareBitmap**-Objekts aus einer Direct3D-Oberfläche müssen Sie den [**Windows.Graphics.DirectX.Direct3D11**](https://msdn.microsoft.com/library/windows/apps/dn895104)-Namespace in Ihr Projekt einbeziehen.</span><span class="sxs-lookup"><span data-stu-id="242c3-173">To create a **SoftwareBitmap** object from a Direct3D surface, you must include the [**Windows.Graphics.DirectX.Direct3D11**](https://msdn.microsoft.com/library/windows/apps/dn895104) namespace in your project.</span></span>

[!code-cs[<span data-ttu-id="242c3-174">Direct3DNamespace</span><span class="sxs-lookup"><span data-stu-id="242c3-174">Direct3DNamespace</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetDirect3DNamespace)]

<span data-ttu-id="242c3-175">Rufen Sie die [**CreateCopyFromSurfaceAsync**](https://msdn.microsoft.com/library/windows/apps/dn887373)-Methode zum Erstellen eines neuen **SoftwareBitmap**-Objekts aus der Oberfläche auf.</span><span class="sxs-lookup"><span data-stu-id="242c3-175">Call [**CreateCopyFromSurfaceAsync**](https://msdn.microsoft.com/library/windows/apps/dn887373) to create a new **SoftwareBitmap** from the surface.</span></span> <span data-ttu-id="242c3-176">Wie der Name schon sagt, verfügt das neue **SoftwareBitmap**-Objekt über eine separate Kopie der Bilddaten.</span><span class="sxs-lookup"><span data-stu-id="242c3-176">As the name indicates, the new **SoftwareBitmap** has a separate copy of the image data.</span></span> <span data-ttu-id="242c3-177">Änderungen am **SoftwareBitmap**-Objekt haben keine Auswirkungen auf die Direct3D-Oberfläche.</span><span class="sxs-lookup"><span data-stu-id="242c3-177">Modifications to the **SoftwareBitmap** will not have any effect on the Direct3D surface.</span></span>

[!code-cs[<span data-ttu-id="242c3-178">CreateSoftwareBitmapFromSurface</span><span class="sxs-lookup"><span data-stu-id="242c3-178">CreateSoftwareBitmapFromSurface</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetCreateSoftwareBitmapFromSurface)]

## <a name="convert-a-softwarebitmap-to-a-different-pixel-format"></a><span data-ttu-id="242c3-179">Konvertieren eines SoftwareBitmap-Objekts in ein anderes Pixelformat</span><span class="sxs-lookup"><span data-stu-id="242c3-179">Convert a SoftwareBitmap to a different pixel format</span></span>

<span data-ttu-id="242c3-180">Die **SoftwareBitmap**-Klasse stellt die statische [**Convert**](https://msdn.microsoft.com/library/windows/apps/dn887362)-Methode dar, mit der Sie auf einfache Weise ein neues **SoftwareBitmap**-Objekt erstellen können, das Pixelformat und Alphamodus aus einem vorhandenen **SoftwareBitmap**-Objekt verwendet.</span><span class="sxs-lookup"><span data-stu-id="242c3-180">The **SoftwareBitmap** class provides the static method, [**Convert**](https://msdn.microsoft.com/library/windows/apps/dn887362), that allows you to easily create a new **SoftwareBitmap** that uses the pixel format and alpha mode you specify from an existing **SoftwareBitmap**.</span></span> <span data-ttu-id="242c3-181">Beachten Sie, dass die neu erstellte Bitmap eine separate Kopie der Bilddaten darstellt.</span><span class="sxs-lookup"><span data-stu-id="242c3-181">Note that the newly created bitmap has a separate copy of the image data.</span></span> <span data-ttu-id="242c3-182">Änderungen an der neuen Bitmap haben keine Auswirkungen auf die Quellbitmap.</span><span class="sxs-lookup"><span data-stu-id="242c3-182">Modifications to the new bitmap will not affect the source bitmap.</span></span>

[!code-cs[<span data-ttu-id="242c3-183">Konvertieren</span><span class="sxs-lookup"><span data-stu-id="242c3-183">Convert</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetConvert)]

## <a name="transcode-an-image-file"></a><span data-ttu-id="242c3-184">Transcodieren einer Bilddatei</span><span class="sxs-lookup"><span data-stu-id="242c3-184">Transcode an image file</span></span>

<span data-ttu-id="242c3-185">Sie können eine Bilddatei direkt von einem [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) in ein [**BitmapEncoder**](https://msdn.microsoft.com/library/windows/apps/br226206) transcodieren.</span><span class="sxs-lookup"><span data-stu-id="242c3-185">You can transcode an image file directly from a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) to a [**BitmapEncoder**](https://msdn.microsoft.com/library/windows/apps/br226206).</span></span> <span data-ttu-id="242c3-186">Erstellen Sie eine [**IRandomAccessStream**](https://msdn.microsoft.com/library/windows/apps/br241731)-Schnittstelle aus der Datei, die transcodiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="242c3-186">Create a [**IRandomAccessStream**](https://msdn.microsoft.com/library/windows/apps/br241731) from the file to be transcoded.</span></span> <span data-ttu-id="242c3-187">Erstellen Sie anhand des Eingabedatenstroms ein neues **BitmapDecoder**-Objekt.</span><span class="sxs-lookup"><span data-stu-id="242c3-187">Create a new **BitmapDecoder** from the input stream.</span></span> <span data-ttu-id="242c3-188">Erstellen Sie eine neue [**InMemoryRandomAccessStream**](https://msdn.microsoft.com/library/windows/apps/br241720)-Klasse für den Encoder zum Schreiben in und Aufrufen von [**BitmapEncoder.CreateForTranscodingAsync**](https://msdn.microsoft.com/library/windows/apps/br226214), indem Sie den In-Memory-Datenstrom und das Decoderobjekt übergeben.</span><span class="sxs-lookup"><span data-stu-id="242c3-188">Create a new [**InMemoryRandomAccessStream**](https://msdn.microsoft.com/library/windows/apps/br241720) for the encoder to write to and call [**BitmapEncoder.CreateForTranscodingAsync**](https://msdn.microsoft.com/library/windows/apps/br226214), passing in the in-memory stream and the decoder object.</span></span> <span data-ttu-id="242c3-189">Codierungsoptionen werden beim Transcodieren nicht unterstützt. Verwenden Sie stattdessen [**CreateAsync**](https://docs.microsoft.com/en-us/uwp/api/windows.graphics.imaging.bitmapencoder#Windows_Graphics_Imaging_BitmapEncoder_CreateAsync_System_Guid_Windows_Storage_Streams_IRandomAccessStream_Windows_Foundation_Collections_IIterable_Windows_Foundation_Collections_IKeyValuePair_System_String_Windows_Graphics_Imaging_BitmapTypedValue___).</span><span class="sxs-lookup"><span data-stu-id="242c3-189">Encode options are not supported when transcoding; instead you should use [**CreateAsync**](https://docs.microsoft.com/en-us/uwp/api/windows.graphics.imaging.bitmapencoder#Windows_Graphics_Imaging_BitmapEncoder_CreateAsync_System_Guid_Windows_Storage_Streams_IRandomAccessStream_Windows_Foundation_Collections_IIterable_Windows_Foundation_Collections_IKeyValuePair_System_String_Windows_Graphics_Imaging_BitmapTypedValue___).</span></span> <span data-ttu-id="242c3-190">Alle Eigenschaften in der Eingabebilddatei, die Sie nicht speziell für den Encoder festlegen, werden unverändert in die Ausgabedatei geschrieben.</span><span class="sxs-lookup"><span data-stu-id="242c3-190">Any properties in the input image file that you do not specifically set on the encoder, will be written to the output file unchanged.</span></span> <span data-ttu-id="242c3-191">Rufen Sie die [**FlushAsync**](https://msdn.microsoft.com/library/windows/apps/br226216)-Methode auf, damit der Encoder den In-Memory-Datenstrom codiert.</span><span class="sxs-lookup"><span data-stu-id="242c3-191">Call [**FlushAsync**](https://msdn.microsoft.com/library/windows/apps/br226216) to cause the encoder to encode to the in-memory stream.</span></span> <span data-ttu-id="242c3-192">Navigieren Sie schließlich zum Anfang des Dateidatenstroms und des In-Memory-Datenstroms, und rufen Sie die [**CopyAsync**](https://msdn.microsoft.com/library/windows/apps/hh701827)-Methode auf, um den In-Memory-Datenstrom in den Dateidatenstrom zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="242c3-192">Finally, seek the file stream and the in-memory stream to the beginning and call [**CopyAsync**](https://msdn.microsoft.com/library/windows/apps/hh701827) to write the in-memory stream out to the file stream.</span></span>

[!code-cs[<span data-ttu-id="242c3-193">TranscodeImageFile</span><span class="sxs-lookup"><span data-stu-id="242c3-193">TranscodeImageFile</span></span>](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetTranscodeImageFile)]

## <a name="related-topics"></a><span data-ttu-id="242c3-194">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="242c3-194">Related topics</span></span>

* [<span data-ttu-id="242c3-195">Referenz zu BitmapEncoder-Optionen</span><span class="sxs-lookup"><span data-stu-id="242c3-195">BitmapEncoder options reference</span></span>](bitmapencoder-options-reference.md)
* [<span data-ttu-id="242c3-196">Bildmetadaten</span><span class="sxs-lookup"><span data-stu-id="242c3-196">Image Metadata</span></span>](image-metadata.md)
 

 




