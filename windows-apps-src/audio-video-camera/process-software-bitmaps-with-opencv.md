---
author: laurenhughes
ms.assetid: ''
description: In diesem Artikel wird erläutert, wie Sie die SoftwareBitmap-Klasse mit der Open Source Computer Vision-Bibliothek (OpenCV) verwenden.
title: Prozess-Bitmaps mit OpenCV
ms.author: lahugh
ms.date: 03/19/2018
ms.topic: article
keywords: Windows10, UWP, Opencv, softwarebitmap
ms.localizationpriority: medium
ms.openlocfilehash: b9f1f2050590267d0a98779eba11bbe0b363da0c
ms.sourcegitcommit: e38b334edb82bf2b1474ba686990f4299b8f59c7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/14/2018
ms.locfileid: "6834670"
---
# <a name="process-bitmaps-with-opencv"></a><span data-ttu-id="dd29d-104">Prozess-Bitmaps mit OpenCV</span><span class="sxs-lookup"><span data-stu-id="dd29d-104">Process bitmaps with OpenCV</span></span>

<span data-ttu-id="dd29d-105">In diesem Artikel wird erläutert, wie Sie die **[SoftwareBitmap](https://docs.microsoft.com/uwp/api/Windows.Graphics.Imaging.SoftwareBitmap)**-Klasse verwenden, die von vielen verschiedenen UWP-APIs zur Darstellung von Bildern mit der Open Source Computer Vision-Bibliothek (OpenCV), Open-Source, der systemeigenen Code-Bibliothek verwendet wird, die eine Vielzahl von Algorithmen für die Bildverarbeitung bietet.</span><span class="sxs-lookup"><span data-stu-id="dd29d-105">This article explains how to use the **[SoftwareBitmap](https://docs.microsoft.com/uwp/api/Windows.Graphics.Imaging.SoftwareBitmap)** class, which is used by many different UWP APIs to represent images, with the Open Source Computer Vision Library (OpenCV), an open source, native code library that provides a wide variety of image processing algorithms.</span></span> 

<span data-ttu-id="dd29d-106">Die Beispiele in diesem Artikel erläutern das Erstellen eines systemeigenen der Komponente für Windows-Runtime, die von einer UWP-App, einschließlich Apps, die mit C# erstellt werden, verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="dd29d-106">The examples in this article walk you through creating a native code Windows Runtime Component that can be used from a UWP app, including apps that are created using C#.</span></span> <span data-ttu-id="dd29d-107">Diese Helferkomponente stellt eine einzelne Methode bereit, **Weichzeichner**, die die Weichzeichner-Verarbeitungsfunktion von OpenCVs verwenden.</span><span class="sxs-lookup"><span data-stu-id="dd29d-107">This helper component will expose a single method, **Blur**, which will use OpenCV's blur image processing function.</span></span> <span data-ttu-id="dd29d-108">Die Komponente implementiert private Methoden, die einen Zeiger auf den zugrunde liegenden Bilddatenpuffer abruft, der direkt von der OpenCV-Bibliothek verwendet werden kann. Dies vereinfacht das Erweitern der Helferkomponente, um andere OpenCV Verarbeitungsfeatures zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="dd29d-108">The component implements private methods that get a pointer to the underlying image data buffer which can be used directly by the OpenCV library, making it simple to extend the helper component to implement other OpenCV processing features.</span></span> 

* <span data-ttu-id="dd29d-109">Eine Einführung in die Verwendung von **SoftwareBitmap** finden Sie im Artikel [Erstellen, Bearbeiten und Speichern von Bitmapbildern](imaging.md).</span><span class="sxs-lookup"><span data-stu-id="dd29d-109">For an introduction to using **SoftwareBitmap**, see [Create, edit, and save bitmap images](imaging.md).</span></span> 
* <span data-ttu-id="dd29d-110">Informationen zum Verwenden der OpenCV-Bibliothek finden Sie unter [http://opencv.org](http://opencv.org).</span><span class="sxs-lookup"><span data-stu-id="dd29d-110">To learn how to use the OpenCV library, go to [http://opencv.org](http://opencv.org).</span></span>
* <span data-ttu-id="dd29d-111">Zur Verwendung der in diesem Artikel verwendeten OpenCV Helper-Komponente mit **[MediaFrameReader](https://docs.microsoft.com/uwp/api/windows.media.capture.frames.mediaframereader)** zum Implementieren der Echtzeit-Image-Verarbeitung von Frames von einer Kamera, lesen Sie [Verwenden von OpenCV mit MediaFrameReader](use-opencv-with-mediaframereader.md).</span><span class="sxs-lookup"><span data-stu-id="dd29d-111">To see how to use the OpenCV helper component shown in this article with **[MediaFrameReader](https://docs.microsoft.com/uwp/api/windows.media.capture.frames.mediaframereader)** to implement real-time image processing of frames from a camera, see [Use OpenCV with MediaFrameReader](use-opencv-with-mediaframereader.md).</span></span>
* <span data-ttu-id="dd29d-112">Ein vollständiges Codebeispiel mit unterschiedlichen implementierten Effekten finden Sie unter [Kamera-Frames + OpenCV – Beispiel](https://go.microsoft.com/fwlink/?linkid=854003) im GitHub-Repository für Beispiele für die Universelle Windows-Plattform.</span><span class="sxs-lookup"><span data-stu-id="dd29d-112">For a complete code example that implements some different effects, see the [Camera Frames + OpenCV Sample](https://go.microsoft.com/fwlink/?linkid=854003) in the Windows Universal Samples GitHub repo.</span></span>

> [!NOTE] 
> <span data-ttu-id="dd29d-113">Die Technik, die von der OpenCV-Helferkomponente verwendet wird und die in diesem Artikel ausführlich beschrieben ist, erfordert, dass sich die zu verarbeitenden Bilddaten im CPU-Speicher und nicht im GPU-Speicher befinden.</span><span class="sxs-lookup"><span data-stu-id="dd29d-113">The technique used by the OpenCVHelper component, described in detail in this article, requires that the image data to be processed resides in CPU memory, not GPU memory.</span></span> <span data-ttu-id="dd29d-114">Bei APIs, die es Ihnen ermöglichen, den Speicherort der Bilder anzufordern wie beispielsweise der **[MediaCapture](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture)**-Klasse, sollten Sie den CPU-Speicher angeben.</span><span class="sxs-lookup"><span data-stu-id="dd29d-114">So, for APIs that allow you to request the memory location of images, such as the **[MediaCapture](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture)** class, you should specify CPU memory.</span></span>

## <a name="create-a-helper-windows-runtime-component-for-opencv-interop"></a><span data-ttu-id="dd29d-115">Erstellen Sie eine Helferkomponente für Windows-Runtime für die Interoperabilität mit OpenCV</span><span class="sxs-lookup"><span data-stu-id="dd29d-115">Create a helper Windows Runtime Component for OpenCV interop</span></span>

### <a name="1-add-a-new-native-code-windows-runtime-component-project-to-your-solution"></a><span data-ttu-id="dd29d-116">1. Fügen Sie Ihrem Projekt einen systemeigenen Code für die Komponente für Windows-Runtime hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd29d-116">1. Add a new native code Windows Runtime Component project to your solution</span></span>

1. <span data-ttu-id="dd29d-117">Fügen Sie der Lösung in Visual Studio ein neues Projekt hinzu, indem Sie mit der rechten Maustaste auf den Projektmappen-Explorer klicken und **Hinzufügen -> Neues Projekt** auswählen.</span><span class="sxs-lookup"><span data-stu-id="dd29d-117">Add a new project to your solution in Visual Studio by right-clicking your solution in Solution Explorer and selecting **Add->New Project**.</span></span> 
2. <span data-ttu-id="dd29d-118">Wählen Sie in der Kategorie **Visual C++** **Komponente für Windows-Runtime (Universal Windows)** aus.</span><span class="sxs-lookup"><span data-stu-id="dd29d-118">Under the **Visual C++** category, select **Windows Runtime Component (Universal Windows)**.</span></span> <span data-ttu-id="dd29d-119">Geben Sie in diesem Beispiel den Namen "OpenCVBridge" ein und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-119">For this example, name the project "OpenCVBridge" and click **OK**.</span></span> 
3. <span data-ttu-id="dd29d-120">Wählen Sie im Dialogfeld **Neues universelles Windows-Projekt** das Ziel und die Mindestbetriebssystemversion für Ihre App aus und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-120">In the **New Windows Universal Project** dialog, select the target and minimum OS version for your app and click **OK**.</span></span>
4. <span data-ttu-id="dd29d-121">Klicken Sie mit der rechten Maustaste auf die automatisch erstellte Datei „Class1.cpp” im Projektmappen-Explorer, und wählen Sie **Entfernen**, wenn das Bestätigungsdialogfeld angezeigt wird. Wählen Sie anschließend **Löschen** aus.</span><span class="sxs-lookup"><span data-stu-id="dd29d-121">Right-click the autogerenated file Class1.cpp in Solution Explorer and select **Remove**, when the confirmation dialog pops up, choose **Delete**.</span></span> <span data-ttu-id="dd29d-122">Löschen Sie dann die Headerdatei "Class1.h".</span><span class="sxs-lookup"><span data-stu-id="dd29d-122">Then delete the Class1.h header file.</span></span>
5. <span data-ttu-id="dd29d-123">Klicken Sie mit der rechten Maustaste auf das Symbol für das OpenCVBridge-Projekt und wählen Sie \*\*Hinzufügen -> Klasse... \*\* aus. Geben Sie im Dialogfeld **Klasse hinzufügen** "OpenCVHelper" als **Klassennamen** ein, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-123">Right-click the OpenCVBridge project icon and select **Add->Class...**. In the **Add Class** dialog, input "OpenCVHelper" in the **Class Name** field and then click **OK**.</span></span> <span data-ttu-id="dd29d-124">Der Code wird der erstellten Klassendateien in einem späteren Schritt hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="dd29d-124">Code will be added to the created class files in a later step.</span></span>

### <a name="2-add-the-opencv-nuget-packages-to-your-component-project"></a><span data-ttu-id="dd29d-125">2. Fügen Sie Ihrem Komponentenprojekt das OpenCV NuGet-Pakete hinzu</span><span class="sxs-lookup"><span data-stu-id="dd29d-125">2. Add the OpenCV NuGet packages to your component project</span></span>

1. <span data-ttu-id="dd29d-126">Klicken Sie im Projektmappen-Explorer mit der rechten Maustaste auf das Projekt OpenCVBridge, und wählen Sie **NuGet-Pakete verwalten** aus.</span><span class="sxs-lookup"><span data-stu-id="dd29d-126">Right-click the OpenCVBridge project icon in Solution Explorer and select **Manage NuGet Packages...**</span></span>
2. <span data-ttu-id="dd29d-127">Wenn das Dialogfeld "NuGet-Paket-Manager" geöffnet wird, wählen Sie die Registerkarte **Durchsuchen** aus, und geben Sie "OpenCV.Win" in das Suchfeld ein.</span><span class="sxs-lookup"><span data-stu-id="dd29d-127">When the NuGet Package Manager dialog opens, select the **Browse** tab and type "OpenCV.Win" in the search box.</span></span>
3. <span data-ttu-id="dd29d-128">Wählen Sie "OpenCV.Win.Core" aus und klicken Sie auf **installieren**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-128">Select "OpenCV.Win.Core" and click **Install**.</span></span> <span data-ttu-id="dd29d-129">Klicken Sie im Dialogfeld **Vorschau** auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-129">In the **Preview** dialog, click **OK**.</span></span>
4. <span data-ttu-id="dd29d-130">Verwenden Sie das gleiche Verfahren zum Installieren des "OpenCV.Win.ImgProc"-Pakets.</span><span class="sxs-lookup"><span data-stu-id="dd29d-130">Use the same procedure to install the "OpenCV.Win.ImgProc" package.</span></span>

> [!NOTE]
> <span data-ttu-id="dd29d-131">OpenCV.Win.Core und OpenCV.Win. ImgProc werden nicht regelmäßig aktualisiert, werden jedoch weiterhin für das Erstellen von OpenCVHelper empfohlen, wie auf dieser Seite beschrieben.</span><span class="sxs-lookup"><span data-stu-id="dd29d-131">OpenCV.Win.Core and OpenCV.Win.ImgProc are not regularly updated, but are still recommended for creating an OpenCVHelper as described on this page.</span></span>

### <a name="3-implement-the-opencvhelper-class"></a><span data-ttu-id="dd29d-132">3. Implementieren Sie die OpenCVHelper-Klasse</span><span class="sxs-lookup"><span data-stu-id="dd29d-132">3. Implement the OpenCVHelper class</span></span>

<span data-ttu-id="dd29d-133">Fügen Sie der Headerdatei „OpenCVHelper.h” folgenden Code hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd29d-133">Paste the following code into the OpenCVHelper.h header file.</span></span> <span data-ttu-id="dd29d-134">Dieser Code enthält OpenCV-Headerdateien für die installierten *Core* und *ImgProc*-Pakete und deklariert drei Methoden, die in den folgenden Schritten erklärt werden.</span><span class="sxs-lookup"><span data-stu-id="dd29d-134">This code includes OpenCV header files for the *Core* and *ImgProc* packages we installed and declares three methods that will be shown in the following steps.</span></span>

[!code-cpp[OpenCVHelperHeader](./code/ImagingWin10/cs/OpenCVBridge/OpenCVHelper.h#SnippetOpenCVHelperHeader)]

<span data-ttu-id="dd29d-135">Löschen Sie den vorhandenen Inhalt der Datei „OpenCVHelper.cpp ”und fügen Sie die folgenden include-Direktiven hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd29d-135">Delete the existing contents of the OpenCVHelper.cpp file and then add the following include directives.</span></span> 

[!code-cpp[OpenCVHelperInclude](./code/ImagingWin10/cs/OpenCVBridge/OpenCVHelper.cpp#SnippetOpenCVHelperInclude)]

<span data-ttu-id="dd29d-136">Nach den Include-Direktiven, fügen Sie die folgenden **using**-Direktiven hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd29d-136">After the include directives, add the following **using** directives.</span></span> 

[!code-cpp[OpenCVHelperUsing](./code/ImagingWin10/cs/OpenCVBridge/OpenCVHelper.cpp#SnippetOpenCVHelperUsing)]

<span data-ttu-id="dd29d-137">Fügen Sie als nächstes zu OpenCVHelper.cpp die Methode **GetPointerToPixelData** hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd29d-137">Next, add the method **GetPointerToPixelData** to OpenCVHelper.cpp.</span></span> <span data-ttu-id="dd29d-138">Diese Methode akzeptiert ein **[SoftwareBitmap](https://docs.microsoft.com/uwp/api/Windows.Graphics.Imaging.SoftwareBitmap)** und ruft durch eine Reihe von Konvertierungen eine COM-Schnittstellendarstellung der Pixeldaten ab, mit deren Hilfe wir einen Zeiger auf den zugrunde liegenden Datenpuffer als **Zeichen**-Array abrufen.</span><span class="sxs-lookup"><span data-stu-id="dd29d-138">This method takes a **[SoftwareBitmap](https://docs.microsoft.com/uwp/api/Windows.Graphics.Imaging.SoftwareBitmap)** and, through a series of conversions, gets a COM interface representation of the pixel data through which we can get a pointer to the underlying data buffer as a **char** array.</span></span> 

<span data-ttu-id="dd29d-139">Als erstes wird ein **[BitmapBuffer](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.bitmapbuffer)** mit Pixeldaten abgerufen, der **[LockBuffer](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.softwarebitmap.lockbuffer)** aufruft und einen Lese-/Schreibzugriff zu Puffern anfordert, damit die OpenCV/Bibliothek die Pixeldaten bearbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="dd29d-139">First a **[BitmapBuffer](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.bitmapbuffer)** containing the pixel data is obtained by calling **[LockBuffer](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.softwarebitmap.lockbuffer)**, requesting a read/write buffer so that the OpenCV library can modify that pixel data.</span></span>  <span data-ttu-id="dd29d-140">**[CreateReference](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.bitmapbuffer.CreateReference)** wird zum Erstellen eines **[IMemoryBufferReference](https://docs.microsoft.com/uwp/api/windows.foundation.imemorybufferreference)**-Objekts aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="dd29d-140">**[CreateReference](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.bitmapbuffer.CreateReference)** is called to get an **[IMemoryBufferReference](https://docs.microsoft.com/uwp/api/windows.foundation.imemorybufferreference)** object.</span></span> <span data-ttu-id="dd29d-141">Als Nächstes wird die **IMemoryBufferByteAccess**-Schnittstelle in ein **IInspectable** umgewandelt, die Basisschnittstelle aller Windows-Runtime-Klassen, und **[QueryInterface ](https://msdn.microsoft.com/library/windows/desktop/ms682521(v=vs.85).aspx)** wird aufgerufen, um eine **[IMemoryBufferByteAccess](https://msdn.microsoft.com/library/mt297505(v=vs.85).aspx)**-COM-Schnittstelle aufzurufen, mit der wir den Pixeldatenpuffer als **Zeichen**-Array erhalten können.</span><span class="sxs-lookup"><span data-stu-id="dd29d-141">Next, the **IMemoryBufferByteAccess** interface is cast as an **IInspectable**, the base interface of all Windows Runtime classes, and **[QueryInterface](https://msdn.microsoft.com/library/windows/desktop/ms682521(v=vs.85).aspx)** is called to get an **[IMemoryBufferByteAccess](https://msdn.microsoft.com/library/mt297505(v=vs.85).aspx)** COM interface that will allow us to obtain the pixel data buffer as a **char** array.</span></span> <span data-ttu-id="dd29d-142">Füllen Sie anschließend das **Zeichen**-Array durch Aufrufen des **[IMemoryBufferByteAccess::GetBuffer](https://msdn.microsoft.com/library/mt297506(v=vs.85).aspx)**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-142">Finally, populate the **char** array by calling **[IMemoryBufferByteAccess::GetBuffer](https://msdn.microsoft.com/library/mt297506(v=vs.85).aspx)**.</span></span> <span data-ttu-id="dd29d-143">Wenn einer der Konvertierungsschritte in dieser Methode fehlschlägt, gibt die Methode **false** an, was bedeutet, dass eine weitere Verarbeitung nicht fortgesetzt werden kann.</span><span class="sxs-lookup"><span data-stu-id="dd29d-143">If any of the conversion steps in this method fail, the method returns **false**, indicating that further processing can't continue.</span></span>

[!code-cpp[OpenCVHelperGetPointerToPixelData](./code/ImagingWin10/cs/OpenCVBridge/OpenCVHelper.cpp#SnippetOpenCVHelperGetPointerToPixelData)]

<span data-ttu-id="dd29d-144">Fügen Sie als nächstes die unten aufgeführte Methode **TryConvert** hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd29d-144">Next, add the method **TryConvert** method shown below.</span></span> <span data-ttu-id="dd29d-145">Diese Methode akzeptiert ein **SoftwareBitmap** und versucht, es in ein **Mat**-Objekt zu konvertieren, das das von OpenCV verwendete Matrix-Objekt zur Darstellung von Bilddatenpuffern ist.</span><span class="sxs-lookup"><span data-stu-id="dd29d-145">This method takes a **SoftwareBitmap** and attempts to convert it to a **Mat** object, which is the matrix object OpenCV uses to represent image data buffers.</span></span> <span data-ttu-id="dd29d-146">Diese Methode ruft die oben aufgeführte **GetPointerToPixelData**-Methode auf, um eine **Zeichen**-Array-Darstellung des Pixeldatenpuffers zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="dd29d-146">This method calls the **GetPointerToPixelData** method defined above to get a **char** array representation of the pixel data buffer.</span></span> <span data-ttu-id="dd29d-147">Wenn dies erfolgreich ist, wird der Konstruktor für die **Mat**-Klasse aufgerufen und übergibt die Pixelbreite und -Höhe, die vom **SoftwareBitmap**-Quellobjekt erhalten wird.</span><span class="sxs-lookup"><span data-stu-id="dd29d-147">If this succeeds, the constructor for the **Mat** class is called, passing in the pixel width and height obtained from the source **SoftwareBitmap** object.</span></span> 

> [!NOTE] 
> <span data-ttu-id="dd29d-148">In diesem Beispiel gibt die Konstante CV_8UC4 das Pixelformat für das erstellte **Mat**-Objekt an.</span><span class="sxs-lookup"><span data-stu-id="dd29d-148">This example specifies the CV_8UC4 constant as the pixel format for the created **Mat** object.</span></span> <span data-ttu-id="dd29d-149">Dies bedeutet, dass die an die **SoftwareBitmap** übergebe Methode einen **[BitmapPixelFormat](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.softwarebitmap.BitmapPixelFormat)**-Eigenschaftswerte von **[BGRA8](https://docs.microsoft.com/uwp/api/Windows.Graphics.Imaging.BitmapPixelFormat)** mit vormultipliziertem Alpha haben muss, dem Äquivalent von CV_8UC4, damit dies in diesem Beispiel funktioniert.</span><span class="sxs-lookup"><span data-stu-id="dd29d-149">This means that the **SoftwareBitmap** passed into this method must have a **[BitmapPixelFormat](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.softwarebitmap.BitmapPixelFormat)** property value of  **[BGRA8](https://docs.microsoft.com/uwp/api/Windows.Graphics.Imaging.BitmapPixelFormat)** with premultiplied alpha, the equivalent of CV_8UC4, to work with this example.</span></span>

<span data-ttu-id="dd29d-150">Eine flache Kopie des erstellten **Mat**-Objekts wird von der Methode zurückgegeben, damit eine weitere Verarbeitung auf dem gleichen Daten-Pixeldatenpuffer verwendet wird, auf den die **SoftwareBitmap** verweist, und keine Kopie dieser Puffer.</span><span class="sxs-lookup"><span data-stu-id="dd29d-150">A shallow copy of the created **Mat** object is returned from the method so that further processing operates on the same data pixel data buffer referenced by the **SoftwareBitmap** and not a copy of this buffer.</span></span>

[!code-cpp[OpenCVHelperTryConvert](./code/ImagingWin10/cs/OpenCVBridge/OpenCVHelper.cpp#SnippetOpenCVHelperTryConvert)]

<span data-ttu-id="dd29d-151">Schließlich implementiert diese Beispielhilfsklasse eine einzelne Bildverarbeitungsmethode, **Weichzeichner**, die die **TryConvert**-Methode zum Abrufen des zuvor definierten **Mat**-Objekts verwendet, das die Quell-Bitmap und die Zielbitmap für den Weichzeichner-Vorgang darstellt und anschließend **Weichzeichner**-Methode aus der OpenCV ImgProc-Bibliothek abruft.</span><span class="sxs-lookup"><span data-stu-id="dd29d-151">Finally, this example helper class implements a single image processing method, **Blur**, which simply uses the **TryConvert** method defined above to retrieve a **Mat** object representing the source bitmap and the target bitmap for the blur operation, and then calls the **blur** method from the OpenCV ImgProc library.</span></span> <span data-ttu-id="dd29d-152">Der andere Parameter für **Weichzeichner** gibt die Größe des Weichzeichnereffekts in X- und Y-Richtungen an.</span><span class="sxs-lookup"><span data-stu-id="dd29d-152">The other parameter to **blur** specifies the size of the blur effect in the X and Y directions.</span></span>

[!code-cpp[OpenCVHelperBlur](./code/ImagingWin10/cs/OpenCVBridge/OpenCVHelper.cpp#SnippetOpenCVHelperBlur)]


## <a name="a-simple-softwarebitmap-opencv-example-using-the-helper-component"></a><span data-ttu-id="dd29d-153">Ein einfaches Beispiel für SoftwareBitmap OpenCV mit Helferkomponenten</span><span class="sxs-lookup"><span data-stu-id="dd29d-153">A simple SoftwareBitmap OpenCV example using the helper component</span></span>
<span data-ttu-id="dd29d-154">Nachdem die Komponente OpenCVBridge erstellt wurde, erstellen wir eine einfache C#-App, die die OpenCV-**Weichzeichner**-Methode zum Ändern einer **SoftwareBitmap** verwendet.</span><span class="sxs-lookup"><span data-stu-id="dd29d-154">Now that the OpenCVBridge component has been created, we can create a simple C# app that uses the OpenCV **blur** method to modify a **SoftwareBitmap**.</span></span> <span data-ttu-id="dd29d-155">Um auf die Komponente für Windows-Runtime von Ihrer UWP-App zuzugreifen, müssen Sie zunächst einen Verweis auf die Komponente hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="dd29d-155">To access the Windows Runtime Component from your UWP app, you must first add a reference to the component.</span></span> <span data-ttu-id="dd29d-156">Klicken Sie mit der rechten Maustaste im Projektmappen-Explorer auf den Knoten **Verweise** unter Ihrem UWP-App-Projekt und wählen Sie \*\*Verweis hinzufügen... \*\* aus. Wählen Sie im Dialogfeld "Verweis-Manager" **Solution-Projekte >** aus.</span><span class="sxs-lookup"><span data-stu-id="dd29d-156">In Solution Explorer, right-click the **References** node under your UWP app project and select **Add reference...**. In the Reference Manager dialog, select **Projects->Solution**.</span></span> <span data-ttu-id="dd29d-157">Aktivieren Sie das Kontrollkästchen neben dem OpenCVBridge-Projekt, und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="dd29d-157">Check the box next to the OpenCVBridge project and the click **OK**.</span></span>

<span data-ttu-id="dd29d-158">Der nachfolgende Beispielcode ermöglicht es dem Benutzer, eine Bilddatei auszuwählen und verwendet dann **[BitmapDecoder](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.bitmapencoder)** zum Erstellen einer **SoftwareBitmap** -Darstellung des Bilds.</span><span class="sxs-lookup"><span data-stu-id="dd29d-158">The example code below allows the user to select an image file and then uses **[BitmapDecoder](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.bitmapencoder)** to create a **SoftwareBitmap** representation of the image.</span></span> <span data-ttu-id="dd29d-159">Weitere Informationen zur Verwendung von **SoftwareBitmap** finden Sie im Artikel [Erstellen, Bearbeiten und Speichern von Bitmapbildern](https://docs.microsoft.com/windows/uwp/audio-video-camera/imaging).</span><span class="sxs-lookup"><span data-stu-id="dd29d-159">For more information on working with **SoftwareBitmap**, see [Create, edit, and save bitmap images](https://docs.microsoft.com/windows/uwp/audio-video-camera/imaging).</span></span>

<span data-ttu-id="dd29d-160">Wie zuvor in diesem Artikel erläutert erfordert die **OpenCVHelper** Klasse, dass alle bereitgestellten **SoftwareBitmap**-Bilder im Pixelformat BGRA8-Format mit vormultiplizierten Alphawerten codiert werden. Wenn das Image nicht bereits in diesem Format existiert, ruft der Beispielcode **[Konvertieren](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.softwarebitmap.BitmapAlphaMode)** auf, um das Bild in das entsprechende Format zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="dd29d-160">As discussed previously in this article, the **OpenCVHelper** class requires that all provided **SoftwareBitmap** images be encoded using the BGRA8 pixel format with premultiplied alpha values, so if the image is not already in this format, the example code calls **[Convert](https://docs.microsoft.com/uwp/api/windows.graphics.imaging.softwarebitmap.BitmapAlphaMode)** to convert the image into the expected format.</span></span>

<span data-ttu-id="dd29d-161">Als Nächstes wird ein **SoftwareBitmap** erstellt, um als Ziel für den Weichzeichnervorgang verwendet zu werden.</span><span class="sxs-lookup"><span data-stu-id="dd29d-161">Next, a **SoftwareBitmap** is created to be used as the target of the blur operation.</span></span> <span data-ttu-id="dd29d-162">Die Eingabe-Bildeigenschaften werden als Argumente für den Konstruktor verwendet, um eine Bitmap mit übereinstimmendem Format erstellen.</span><span class="sxs-lookup"><span data-stu-id="dd29d-162">The input image properties are used as arguments to the constructor to create a bitmap with matching format.</span></span>

<span data-ttu-id="dd29d-163">Es wird eine neue Instanz von **OpenCVHelper** erstellt, die **Weichzeichner**-Methode wird aufgerufen und übergibt die Quell- und Ziel-Bitmaps.</span><span class="sxs-lookup"><span data-stu-id="dd29d-163">A new instance of **OpenCVHelper** is created, and the **Blur** method is called, passing in the source and target bitmaps.</span></span> <span data-ttu-id="dd29d-164">Schließlich wird ein **SoftwareBitmapSource** erstellt, um dem Ausgabebild ein XAML **Bild**-Steuerelement zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="dd29d-164">Finally, a **SoftwareBitmapSource** is created to assign the output image to a XAML **Image** control.</span></span>


[!code-cs[OpenCVBlur](./code/ImagingWin10/cs/MainPage.OpenCV.xaml.cs#SnippetOpenCVBlur)]

## <a name="related-topics"></a><span data-ttu-id="dd29d-165">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="dd29d-165">Related topics</span></span>

* [<span data-ttu-id="dd29d-166">Referenz zu BitmapEncoder-Optionen</span><span class="sxs-lookup"><span data-stu-id="dd29d-166">BitmapEncoder options reference</span></span>](bitmapencoder-options-reference.md)
* [<span data-ttu-id="dd29d-167">Bildmetadaten</span><span class="sxs-lookup"><span data-stu-id="dd29d-167">Image Metadata</span></span>](image-metadata.md)
 

 




