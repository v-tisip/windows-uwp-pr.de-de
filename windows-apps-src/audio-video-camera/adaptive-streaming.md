---
author: drewbatgit
ms.assetid: AE98C22B-A071-4206-ABBB-C0F0FB7EF33C
description: In diesem Artikel wird beschrieben, wie Sie die Wiedergabe von Multimediainhalten für adaptives Streaming einer App für die Universelle Windows-Plattform (UWP) hinzufügen können. Dieses Feature unterstützt derzeit die Wiedergabe von Inhalten über HTTP Live Streaming(HLS) und Dynamic Streaming over HTTP(DASH).
title: Adaptives Streaming
ms.author: drewbat
ms.date: 02/08/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: ac00104917d41a48abda97c2d5d37c0ced3ab5e9
ms.sourcegitcommit: 91511d2d1dc8ab74b566aaeab3ef2139e7ed4945
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/30/2018
ms.locfileid: "1816645"
---
# <a name="adaptive-streaming"></a><span data-ttu-id="95167-105">Adaptives Streaming</span><span class="sxs-lookup"><span data-stu-id="95167-105">Adaptive streaming</span></span>


<span data-ttu-id="95167-106">In diesem Artikel wird beschrieben, wie Sie die Wiedergabe von Multimediainhalten für adaptives Streaming einer App für die Universelle Windows-Plattform (UWP) hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="95167-106">This article describes how to add playback of adaptive streaming multimedia content to a Universal Windows Platform (UWP) app.</span></span> <span data-ttu-id="95167-107">Dieses Feature unterstützt derzeit die Wiedergabe von Inhalten über HTTP Live Streaming(HLS) und Dynamic Streaming over HTTP(DASH).</span><span class="sxs-lookup"><span data-stu-id="95167-107">This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content.</span></span>

<span data-ttu-id="95167-108">Eine Liste der unterstützten HLS-Protokolltags finden Sie unter [Unterstützung von HLS-Tags](hls-tag-support.md).</span><span class="sxs-lookup"><span data-stu-id="95167-108">For a list of supported HLS protocol tags, see [HLS tag support](hls-tag-support.md).</span></span> 

<span data-ttu-id="95167-109">Eine Liste der unterstützten DASH-Profile finden Sie unter [DASH-Profilunterstützung](dash-profile-support.md).</span><span class="sxs-lookup"><span data-stu-id="95167-109">For a list of supported DASH profiles, see [DASH profile support](dash-profile-support.md).</span></span> 

> [!NOTE] 
> <span data-ttu-id="95167-110">Der Code in diesem Artikel wurde aus dem [Beispiel für adaptives Streaming](https://github.com/Microsoft/Windows-universal-samples/tree/dev/Samples/AdaptiveStreaming) für UWP übernommen und angepasst.</span><span class="sxs-lookup"><span data-stu-id="95167-110">The code in this article was adapted from the UWP [Adaptive streaming sample](https://github.com/Microsoft/Windows-universal-samples/tree/dev/Samples/AdaptiveStreaming).</span></span>

## <a name="simple-adaptive-streaming-with-mediaplayer-and-mediaplayerelement"></a><span data-ttu-id="95167-111">Einfaches adaptives Streaming mit MediaPlayer und MediaPlayerElement</span><span class="sxs-lookup"><span data-stu-id="95167-111">Simple adaptive streaming with MediaPlayer and MediaPlayerElement</span></span>

<span data-ttu-id="95167-112">Erstellen Sie ein **Uri**-Objekt, das auf eine DASH- oder HLS-Manifestdatei verweist, um Medien für adaptives Streaming in einer UWP-App wiederzugeben.</span><span class="sxs-lookup"><span data-stu-id="95167-112">To play adaptive streaming media in a UWP app, create a **Uri** object pointing to a DASH or HLS manifest file.</span></span> <span data-ttu-id="95167-113">Erstellen Sie eine Instanz der [**MediaPlayer**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Playback.MediaPlayer)-Klasse.</span><span class="sxs-lookup"><span data-stu-id="95167-113">Create an instance of the [**MediaPlayer**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Playback.MediaPlayer) class.</span></span> <span data-ttu-id="95167-114">Rufen Sie [**MediaSource.CreateFromUri**](https://msdn.microsoft.com/library/windows/apps/dn930912) auf, um ein neues **MediaSource**-Objekt zu erstellen, und legen Sie es dann auf die [**Source**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Playback.MediaPlayer.Source)-Eigenschaft von **MediaPlayer** fest.</span><span class="sxs-lookup"><span data-stu-id="95167-114">Call [**MediaSource.CreateFromUri**](https://msdn.microsoft.com/library/windows/apps/dn930912) to create a new **MediaSource** object and then set that to the [**Source**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Playback.MediaPlayer.Source) property of the **MediaPlayer**.</span></span> <span data-ttu-id="95167-115">Rufen Sie [**Play**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Playback.MediaPlayer.Play) auf, um die Wiedergabe des Medieninhalts zu starten.</span><span class="sxs-lookup"><span data-stu-id="95167-115">Call [**Play**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Playback.MediaPlayer.Play) to start playback of the media content.</span></span>

[!code-cs[DeclareMediaPlayer](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetDeclareMediaPlayer)]

[!code-cs[ManifestSourceNoUI](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetManifestSourceNoUI)]

<span data-ttu-id="95167-116">Im obigen Beispiel werden die Audiodaten des Medieninhalts wiedergegeben, aber der Inhalt wird nicht automatisch auf Ihrer Benutzeroberfläche gerendert.</span><span class="sxs-lookup"><span data-stu-id="95167-116">The above example will play the audio of the media content but it doesn't automatically render the content in your UI.</span></span> <span data-ttu-id="95167-117">Für die meisten Apps, mit denen Videoinhalte wiedergegeben werden, wird der Inhalt auf einer XAML-Seite gerendert.</span><span class="sxs-lookup"><span data-stu-id="95167-117">Most apps that play video content will want to render the content in a XAML page.</span></span>  <span data-ttu-id="95167-118">Fügen Sie der XAML-Seite hierzu ein [**MediaPlayerElement**](https://msdn.microsoft.com/library/windows/apps/Windows.UI.Xaml.Controls.MediaPlayerElement)-Steuerelement hinzu.</span><span class="sxs-lookup"><span data-stu-id="95167-118">To do this, add a [**MediaPlayerElement**](https://msdn.microsoft.com/library/windows/apps/Windows.UI.Xaml.Controls.MediaPlayerElement) control to your XAML page.</span></span>

[!code-xml[MediaPlayerElementXAML](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml#SnippetMediaPlayerElementXAML)]

<span data-ttu-id="95167-119">Rufen Sie [**MediaSource.CreateFromUri**](https://msdn.microsoft.com/library/windows/apps/dn930912) auf, um ein **MediaSource**-Element über den URI einer DASH- oder HLS-Manifestdatei zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="95167-119">Call [**MediaSource.CreateFromUri**](https://msdn.microsoft.com/library/windows/apps/dn930912) to create a **MediaSource** from the URI of a DASH or HLS manifest file.</span></span> <span data-ttu-id="95167-120">Legen Sie anschließend die [**Source**](https://msdn.microsoft.com/library/windows/apps/br227420)-Eigenschaft von **MediaPlayerElement** fest.</span><span class="sxs-lookup"><span data-stu-id="95167-120">Then set the [**Source**](https://msdn.microsoft.com/library/windows/apps/br227420) property of the **MediaPlayerElement**.</span></span> <span data-ttu-id="95167-121">**MediaPlayerElement** erstellt automatisch eine neues **MediaPlayer**-Objekt für den Inhalt.</span><span class="sxs-lookup"><span data-stu-id="95167-121">The **MediaPlayerElement** will automatically create a new **MediaPlayer** object for the content.</span></span> <span data-ttu-id="95167-122">Sie können **Play** für das **MediaPlayer**-Objekt aufrufen, um die Wiedergabe des Inhalts zu starten.</span><span class="sxs-lookup"><span data-stu-id="95167-122">You can call **Play** on the **MediaPlayer** to start playback of the content.</span></span>

[!code-cs[ManifestSource](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetManifestSource)]

> [!NOTE] 
> <span data-ttu-id="95167-123">Ab Windows10, Version1607, wird die Verwendung der **MediaPlayer**-Klasse zum Wiedergeben von Medienelementen empfohlen.</span><span class="sxs-lookup"><span data-stu-id="95167-123">Starting with Windows 10, version 1607, it is recommended that you use the **MediaPlayer** class to play media items.</span></span> <span data-ttu-id="95167-124">**MediaPlayerElement** ist ein einfaches XAML-Steuerelement, das zum Rendern des Inhalts eines **MediaPlayer**-Objekts auf einer XAML-Seite verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="95167-124">The **MediaPlayerElement** is a lightweight XAML control that is used to render the content of a **MediaPlayer** in a XAML page.</span></span> <span data-ttu-id="95167-125">Das **MediaElement**-Steuerelement wird aus Gründen der Abwärtskompatibilität weiterhin unterstützt.</span><span class="sxs-lookup"><span data-stu-id="95167-125">The **MediaElement** control continues to be supported for backwards compatibility.</span></span> <span data-ttu-id="95167-126">Weitere Informationen zur Verwendung von **MediaPlayer** und **MediaPlayerElement** zum Wiedergeben von Medieninhalten finden Sie unter [Wiedergeben von Audio- und Videoinhalten mit „MediaPlayer“](play-audio-and-video-with-mediaplayer.md).</span><span class="sxs-lookup"><span data-stu-id="95167-126">For more information about using **MediaPlayer** and **MediaPlayerElement** to play media content, see [Play audio and video with MediaPlayer](play-audio-and-video-with-mediaplayer.md).</span></span> <span data-ttu-id="95167-127">Informationen zur Verwendung von **MediaSource** und dazugehörigen APIs für die Arbeit mit Medieninhalten finden Sie unter [Medienelemente, Wiedergabelisten und Titel](media-playback-with-mediasource.md).</span><span class="sxs-lookup"><span data-stu-id="95167-127">For information about using **MediaSource** and related APIs to work with media content, see [Media items, playlists, and tracks](media-playback-with-mediasource.md).</span></span>

## <a name="adaptive-streaming-with-adaptivemediasource"></a><span data-ttu-id="95167-128">Adaptives Streaming mit AdaptiveMediaSource</span><span class="sxs-lookup"><span data-stu-id="95167-128">Adaptive streaming with AdaptiveMediaSource</span></span>

<span data-ttu-id="95167-129">Verwenden Sie das **[AdaptiveMediaSource](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource)**-Objekt, wenn Ihre App erweiterte adaptive Streamingfunktionen erfordert, z.B. das Bereitstellen von benutzerdefinierten HTTP-Headern, die Überwachung der aktuellen Download- und Wiedergabe-Bitraten oder das Anpassen der Verhältnisse, die bestimmen, wann das System Bitraten des adaptiven Datenstroms wechselt.</span><span class="sxs-lookup"><span data-stu-id="95167-129">If your app requires more advanced adaptive streaming features, such as providing custom HTTP headers, monitoring the current download and playback bitrates, or adjusting the ratios that determine when the system switches bitrates of the adaptive stream, use the **[AdaptiveMediaSource](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource)** object.</span></span>

<span data-ttu-id="95167-130">Die adaptiven Streaming-APIs befinden sich im [**Windows.Media.Streaming.Adaptive**](https://msdn.microsoft.com/library/windows/apps/dn931279)-Namespace.</span><span class="sxs-lookup"><span data-stu-id="95167-130">The adaptive streaming APIs are found in the [**Windows.Media.Streaming.Adaptive**](https://msdn.microsoft.com/library/windows/apps/dn931279) namespace.</span></span> <span data-ttu-id="95167-131">Die Beispiele in diesem Artikel verwenden APIs aus den folgenden Namespaces.</span><span class="sxs-lookup"><span data-stu-id="95167-131">The examples in this article use APIs from the following namespaces.</span></span>

[!code-cs[AdaptiveStreamingUsing](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetAdaptiveStreamingUsing)]

## <a name="initialize-an-adaptivemediasource-from-a-uri"></a><span data-ttu-id="95167-132">Initialisieren eines AdaptiveMediaSource-Objekts mit einem URI</span><span class="sxs-lookup"><span data-stu-id="95167-132">Initialize an AdaptiveMediaSource from a URI.</span></span>

<span data-ttu-id="95167-133">Initialisieren Sie **AdaptiveMediaSource** mit dem URI einer adaptiven Streaming-Manifestdatei durch Aufrufen von [**CreateFromUriAsync**](https://msdn.microsoft.com/library/windows/apps/dn931261).</span><span class="sxs-lookup"><span data-stu-id="95167-133">Initialize the **AdaptiveMediaSource** with the URI of an adaptive streaming manifest file by calling [**CreateFromUriAsync**](https://msdn.microsoft.com/library/windows/apps/dn931261).</span></span> <span data-ttu-id="95167-134">Der von dieser Methode zurückgegebene [**AdaptiveMediaSourceCreationStatus**](https://msdn.microsoft.com/library/windows/apps/dn946917)-Wert teilt Ihnen mit, ob die Medienquelle erfolgreich erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="95167-134">The [**AdaptiveMediaSourceCreationStatus**](https://msdn.microsoft.com/library/windows/apps/dn946917) value returned from this method lets you know if the media source was created successfully.</span></span> <span data-ttu-id="95167-135">In diesem Fall können Sie das Objekt als Datenstromquelle für Ihren **MediaPlayer** durch Erstellen eines **MediaSource**-Objekts festlegen, indem Sie [**MediaSource.CreateFromAdaptiveMediaSource**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaSource.AdaptiveMediaSource) aufrufen und dann der [**Quelle**](https://docs.microsoft.com/uwp/api/windows.media.playback.mediaplayer.Source)-Eigenschaft des Media-Players zuweisen.</span><span class="sxs-lookup"><span data-stu-id="95167-135">If so, you can set the object as the stream source for your **MediaPlayer** by creating a **MediaSource** object by calling  [**MediaSource.CreateFromAdaptiveMediaSource**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaSource.AdaptiveMediaSource), and then assigning it to the media player's [**Source**](https://docs.microsoft.com/uwp/api/windows.media.playback.mediaplayer.Source) property.</span></span> <span data-ttu-id="95167-136">In diesem Beispiel wird die [**AvailableBitrates**](https://msdn.microsoft.com/library/windows/apps/dn931257)-Eigenschaft abgefragt, um die maximal unterstützte Bitrate für diesen Datenstrom zu ermitteln. Anschließend wird dieser Wert als ursprüngliche Bitrate festgelegt.</span><span class="sxs-lookup"><span data-stu-id="95167-136">In this example, the [**AvailableBitrates**](https://msdn.microsoft.com/library/windows/apps/dn931257) property is queried to determine the maximum supported bitrate for this stream, and then that value is set as the inital bitrate.</span></span> <span data-ttu-id="95167-137">In diesem Beispiel werden auch Handler für mehrere **AdaptiveMediaSource**-Ereignisse registriert, die weiter unten in diesem Artikel erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="95167-137">This example also registers handlers for the several **AdaptiveMediaSource** events that are discussed later in this article.</span></span>

[!code-cs[InitializeAMS](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetInitializeAMS)]

## <a name="initialize-an-adaptivemediasource-using-httpclient"></a><span data-ttu-id="95167-138">Initialisieren eines AdaptiveMediaSource-Objekts mit HttpClient</span><span class="sxs-lookup"><span data-stu-id="95167-138">Initialize an AdaptiveMediaSource using HttpClient</span></span>

<span data-ttu-id="95167-139">Wenn Sie benutzerdefinierte HTTP-Header für das Abrufen der Manifestdatei festlegen müssen, können Sie ein [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639)-Objekt erstellen, die gewünschten Header festlegen und das Objekt an die Überladung von **CreateFromUriAsync** übergeben.</span><span class="sxs-lookup"><span data-stu-id="95167-139">If you need to set custom HTTP headers for getting the manifest file, you can create an [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639) object, set the desired headers, and then pass the object into the overload of **CreateFromUriAsync**.</span></span>

[!code-cs[InitializeAMSWithHttpClient](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetInitializeAMSWithHttpClient)]

<span data-ttu-id="95167-140">Das [**DownloadRequested**](https://msdn.microsoft.com/library/windows/apps/dn931272)-Ereignis wird ausgelöst, wenn das System eine Ressource vom Server abruft.</span><span class="sxs-lookup"><span data-stu-id="95167-140">The [**DownloadRequested**](https://msdn.microsoft.com/library/windows/apps/dn931272) event is raised when the system is about to retrieve a resource from the server.</span></span> <span data-ttu-id="95167-141">Die an den Ereignishandler übergebene [**AdaptiveMediaSourceDownloadRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn946935) macht Eigenschaften verfügbar, die Informationen über die angeforderte Ressource wie Typ und URI der Ressource bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="95167-141">The [**AdaptiveMediaSourceDownloadRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn946935) passed into the event handler exposes properties that provide information about the resource being requested such as the type and URI of the resource.</span></span>

## <a name="modify-resource-request-properties-using-the-downloadrequested-event"></a><span data-ttu-id="95167-142">Ändern der Eigenschaften der Ressourcenanforderung mit dem DownloadRequested-Ereignis</span><span class="sxs-lookup"><span data-stu-id="95167-142">Modify resource request properties using the DownloadRequested event</span></span>

<span data-ttu-id="95167-143">Sie können mit dem **DownloadRequested**-Ereignishandler die Ressourcenanforderung durch Aktualisieren der Eigenschaften des von den Ereignisargumenten bereitgestellten [**AdaptiveMediaSourceDownloadResult**](https://msdn.microsoft.com/library/windows/apps/dn946942)-Objekts ändern.</span><span class="sxs-lookup"><span data-stu-id="95167-143">You can use the **DownloadRequested** event handler to modify the resource request by updating the properties of the [**AdaptiveMediaSourceDownloadResult**](https://msdn.microsoft.com/library/windows/apps/dn946942) object provided by the event args.</span></span> <span data-ttu-id="95167-144">Im folgenden Beispiel wird der URI, aus dem die Ressource abgerufen wird, durch die Aktualisierung der [**ResourceUri**](https://msdn.microsoft.com/library/windows/apps/dn931250)-Eigenschaften des Ergebnisobjekts geändert.</span><span class="sxs-lookup"><span data-stu-id="95167-144">In the example below, the URI from which the resource will be retrieved is modified by updating the [**ResourceUri**](https://msdn.microsoft.com/library/windows/apps/dn931250) properties of the result object.</span></span> <span data-ttu-id="95167-145">Sie können auch den Bytebereichsoffset und die Länge für Mediensegmente umschreiben oder, wie im folgenden Beispiel gezeigt, den Ressourcen-URI ändern, um die vollständige Ressource herunterzuladen und das Bytebereichsoffset und die Länge auf null festzulegen.</span><span class="sxs-lookup"><span data-stu-id="95167-145">You can also rewrite the byte range offset and length for media segments or, as shown the example below, change the resource URI to download the full resource and set the byte range offset and length to null.</span></span>

<span data-ttu-id="95167-146">Sie können den Inhalt der angeforderten Ressource durch Festlegen der [**Buffer**](https://msdn.microsoft.com/library/windows/apps/dn946943)- oder [**InputStream**](https://msdn.microsoft.com/library/windows/apps/dn931249)-Eigenschaft des Ergebnisobjekts überschreiben.</span><span class="sxs-lookup"><span data-stu-id="95167-146">You can override the content of the requested resource by setting the [**Buffer**](https://msdn.microsoft.com/library/windows/apps/dn946943) or [**InputStream**](https://msdn.microsoft.com/library/windows/apps/dn931249) properties of the result object.</span></span> <span data-ttu-id="95167-147">Im folgenden Beispiel wird der Inhalt der Manifestressource durch Festlegen der **Buffer**-Eigenschaft ersetzt.</span><span class="sxs-lookup"><span data-stu-id="95167-147">In the example below, the contents of the manifest resource are replaced by setting the **Buffer** property.</span></span> <span data-ttu-id="95167-148">Wenn Sie die Ressourcenanforderung mit Daten aktualisieren, die asynchron abgerufen werden, z.B. durch Abrufen von Daten von einem Remoteserver oder asynchrone Benutzerauthentifizierung, müssen Sie [**AdaptiveMediaSourceDownloadRequestedEventArgs.GetDeferral**](https://msdn.microsoft.com/library/windows/apps/dn946936) aufrufen, um eine Verzögerung abzurufen. Anschließend bei Abschluss des Vorgangs rufen Sie dann [**Complete**](https://msdn.microsoft.com/library/windows/apps/dn946934) auf, um dem System zu signalisieren, dass der Downloadanforderungsvorgang fortgesetzt werden kann.</span><span class="sxs-lookup"><span data-stu-id="95167-148">Note that if you are updating the resource request with data that is obtained asynchronously, such as retrieving data from a remote server or asynchronous user authentication, you must call [**AdaptiveMediaSourceDownloadRequestedEventArgs.GetDeferral**](https://msdn.microsoft.com/library/windows/apps/dn946936) to get a deferral and then call [**Complete**](https://msdn.microsoft.com/library/windows/apps/dn946934) when the operation is complete to signal the system that the download request operation can continue.</span></span>

[!code-cs[AMSDownloadRequested](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetAMSDownloadRequested)]

## <a name="use-bitrate-events-to-manage-and-respond-to-bitrate-changes"></a><span data-ttu-id="95167-149">Verwenden von Bitratenereignissen zum Verwalten von und Reagieren auf Bitratenänderungen</span><span class="sxs-lookup"><span data-stu-id="95167-149">Use bitrate events to manage and respond to bitrate changes</span></span>

<span data-ttu-id="95167-150">Das **AdaptiveMediaSource**-Objekt stellt Ereignisse bereit, mit denen Sie reagieren können, wenn sich die Download- oder Wiedergabe-Bitraten ändern.</span><span class="sxs-lookup"><span data-stu-id="95167-150">The **AdaptiveMediaSource** object provides events that allow you to react when the download or playback bitrates change.</span></span> <span data-ttu-id="95167-151">In diesem Beispiel werden die aktuellen Bitraten einfach auf der Benutzeroberfläche aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="95167-151">In this example, the current bitrates are simply updated in the UI.</span></span> <span data-ttu-id="95167-152">Sie können die Verhältnisse ändern, die bestimmen, wann das System Bitraten des adaptiven Datenstroms wechselt.</span><span class="sxs-lookup"><span data-stu-id="95167-152">Note that you can modify the ratios that determine when the system switches bitrates of the adaptive stream.</span></span> <span data-ttu-id="95167-153">Weitere Informationen finden Sie unter der [**AdvancedSettings**](https://msdn.microsoft.com/library/windows/apps/mt628697)-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="95167-153">For more information, see the [**AdvancedSettings**](https://msdn.microsoft.com/library/windows/apps/mt628697) property.</span></span>

[!code-cs[AMSBitrateEvents](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetAMSBitrateEvents)]

## <a name="handle-download-completion-and-failure-events"></a><span data-ttu-id="95167-154">Behandeln von Downloadabschluss und Fehlerereignissen</span><span class="sxs-lookup"><span data-stu-id="95167-154">Handle download completion and failure events</span></span>
<span data-ttu-id="95167-155">Das **AdaptiveMediaSource**-Objekt löst das [**DownloadFailed**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource.DownloadFailed)-Ereignis aus, wenn der Download einer angeforderten Ressource fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="95167-155">The **AdaptiveMediaSource** object raises the [**DownloadFailed**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource.DownloadFailed) event when the download of a requested resource fails.</span></span> <span data-ttu-id="95167-156">Sie können mit diesem Ereignis die UI als Reaktion auf den Fehler aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="95167-156">You can use this event to update your UI in response to the failure.</span></span> <span data-ttu-id="95167-157">Sie können das Ereignis auch verwenden, um statistische Informationen über den Downloadvorgang und den Fehler zu protokollieren.</span><span class="sxs-lookup"><span data-stu-id="95167-157">You can also use the event to log statistical information about the download operation and the failure.</span></span> 

<span data-ttu-id="95167-158">Das an den Ereignishandler übergebene [**AdaptiveMediaSourceDownloadFailedEventArgs**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSourceDownloadFailedEventArgs)-Objekt enthält Metadaten über den Fehler beim Herunterladen der Ressource, z.B. den Ressourcentyp, den URI der Ressource und die Position im Stream, an der der Fehler aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="95167-158">The [**AdaptiveMediaSourceDownloadFailedEventArgs**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSourceDownloadFailedEventArgs) object passed into the event handler contains metadata about the failed resource download, such as the resource type, the URI of the resource, and the position within the stream where the failure occurred.</span></span> <span data-ttu-id="95167-159">Die [**RequestId**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSourceDownloadFailedEventArgs.RequestId)-Eigenschaft erhält einen vom System generierter eindeutigen Bezeichner für die Anforderung, der zum Korrelieren von Statusinformationen über eine einzelne Anforderung für mehrere Ereignisse verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="95167-159">The [**RequestId**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSourceDownloadFailedEventArgs.RequestId) gets a system-generated unique identifier for the request that can be use to correlate status information about an individual request across multiple events.</span></span>

<span data-ttu-id="95167-160">Die [**Statistics**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSourceDownloadFailedEventArgs.Statistics)-Eigenschaft gibt ein [**AdaptiveMediaSourceDownloadStatistics**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcedownloadstatistics)-Objekt zurück, das ausführliche Informationen über die Anzahl der zum Zeitpunkt des Ereignisses empfangenen Bytes und über den zeitlichen Ablauf der verschiedenen Meilensteine im Downloadvorgang enthält.</span><span class="sxs-lookup"><span data-stu-id="95167-160">The [**Statistics**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSourceDownloadFailedEventArgs.Statistics) property returns a [**AdaptiveMediaSourceDownloadStatistics**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcedownloadstatistics) object which provides detailed information about the number of bytes received at the time of the event and the timing of various milestones in the download operation.</span></span> <span data-ttu-id="95167-161">Sie können diese Informationen protokollieren, um Leistungsprobleme in Ihrer Implementierung des adaptiven Streaming zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="95167-161">You can log this information in order identify perfomance issues in your adaptive streaming implementation.</span></span>

[!code-cs[AMSDownloadFailed](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetAMSDownloadFailed)]


<span data-ttu-id="95167-162">Das  [**DownloadCompleted**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource.DownloadCompleted)-Ereignis tritt auf, wenn ein Ressourcendownload abgeschlossen ist und für das **DownloadFailed**-Ereignis ähnliche Daten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="95167-162">The  [**DownloadCompleted**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource.DownloadCompleted) event occurs when a resource download completes and provdes similar data to the **DownloadFailed** event.</span></span> <span data-ttu-id="95167-163">Es wird wieder eine **RequestId** bereitgestellt, um Ereignisse für eine einzige Anforderung zu korrelieren.</span><span class="sxs-lookup"><span data-stu-id="95167-163">Once again, a **RequestId** is provided for correlating events for a single request.</span></span> <span data-ttu-id="95167-164">Darüber hinaus wird ein **AdaptiveMediaSourceDownloadStatistics**-Objekt bereitgestellt, um das Protokollieren der Downloadstatistiken zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="95167-164">Also, an **AdaptiveMediaSourceDownloadStatistics** object is provided to enable logging of download stats.</span></span>

[!code-cs[AMSDownloadCompleted](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetAMSDownloadCompleted)]

## <a name="gather-adaptive-streaming-telemetry-data-with-adaptivemediasourcediagnostics"></a><span data-ttu-id="95167-165">Erfassen von adaptiven Streaming-Telemetriedaten mit AdaptiveMediaSourceDiagnostics</span><span class="sxs-lookup"><span data-stu-id="95167-165">Gather adaptive streaming telemetry data with AdaptiveMediaSourceDiagnostics</span></span>
<span data-ttu-id="95167-166">Das **AdaptiveMediaSource**-Objekt stell die [**Diagnostics**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource?branch=master.Diagnostics)-Eigenschaft bereit, die ein [**AdaptiveMediaSourceDiagnostics**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnostics)-Objekt zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="95167-166">The **AdaptiveMediaSource** exposes a [**Diagnostics**](https://docs.microsoft.com/uwp/api/Windows.Media.Streaming.Adaptive.AdaptiveMediaSource?branch=master.Diagnostics) property which returns an [**AdaptiveMediaSourceDiagnostics**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnostics) object.</span></span> <span data-ttu-id="95167-167">Verwenden Sie dieses Objekt, um eine Registrierung für das [**DiagnosticAvailable**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnostics.DiagnosticAvailable)-Ereignis auszuführen.</span><span class="sxs-lookup"><span data-stu-id="95167-167">Use this object to register for the [**DiagnosticAvailable**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnostics.DiagnosticAvailable) event.</span></span> <span data-ttu-id="95167-168">Dieses Ereignis ist für die Telemetriesammlung vorgesehen und sollte nicht verwendet werden, um das Verhalten der App zur Laufzeit zu ändern.</span><span class="sxs-lookup"><span data-stu-id="95167-168">This event is intended to be used for telemetry collection and should not be used to modify app behavior at runtime.</span></span> <span data-ttu-id="95167-169">Dieses Diagnoseereignis wird aus vielen verschiedenen Gründen ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="95167-169">This diagnostic event is raised for many different reasons.</span></span> <span data-ttu-id="95167-170">Überprüfen Sie die [**DiagnosticType**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnosticavailableeventargs.DiagnosticType)-Eigenschaft des an das Ereignis übergebenen [**AdaptiveMediaSourceDiagnosticAvailableEventArgs**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnosticavailableeventargs)-Objekts, um zu ermitteln, ob das Ereignis ausgelöst wurde.</span><span class="sxs-lookup"><span data-stu-id="95167-170">Check the [**DiagnosticType**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnosticavailableeventargs.DiagnosticType) property of the [**AdaptiveMediaSourceDiagnosticAvailableEventArgs**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnosticavailableeventargs) object passed into the event to determine the reason that the event was raised.</span></span> <span data-ttu-id="95167-171">Zu den möglichen Gründen zählen Fehler beim Zugriff auf die angeforderte Ressource und Fehler beim Analysieren der Streaming-Manifestdatei.</span><span class="sxs-lookup"><span data-stu-id="95167-171">Potential reasons include errors accessing the requested resource and errors parsing the streaming manifest file.</span></span> <span data-ttu-id="95167-172">Eine Liste der Situationen, in denen ein Diagnoseereignis ausgelöst werden kann, finden Sie unter [**AdaptiveMediaSourceDiagnosticType**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnostictype).</span><span class="sxs-lookup"><span data-stu-id="95167-172">For a list of situations that can trigger a diagnostic event, see [**AdaptiveMediaSourceDiagnosticType**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasourcediagnostictype).</span></span> <span data-ttu-id="95167-173">Wie die Argumente für andere adaptive Streaming-Ereignisse stellt auch **AdaptiveMediaSourceDiagnosticAvailableEventArgs** eine **RequestId**-Eigenschaft zum Korrelieren von Anforderungsinformationen zwischen verschiedenen Ereignissen bereit.</span><span class="sxs-lookup"><span data-stu-id="95167-173">Like the arguments for other adaptive streaming events, the **AdaptiveMediaSourceDiagnosticAvailableEventArgs** provides a **RequestId** propery for correlating request information between different events.</span></span>

[!code-cs[AMSDiagnosticAvailable](./code/AdaptiveStreaming_RS1/cs/MainPage.xaml.cs#SnippetAMSDiagnosticAvailable)]

## <a name="defer-binding-of-adaptive-streaming-content-for-items-in-a-playback-list-by-using-mediabinder"></a><span data-ttu-id="95167-174">Verzögern der Bindung adaptiver Streaming-Inhalte für Elemente in einer Wiedergabeliste mit MediaBinder</span><span class="sxs-lookup"><span data-stu-id="95167-174">Defer binding of adaptive streaming content for items in a playback list by using MediaBinder</span></span>
<span data-ttu-id="95167-175">Die [**MediaBinder**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaBinder)-Klasse ermöglicht das Verzögern der Bindung von Medieninhalten in einer [**MediaPlaybackList**](https://msdn.microsoft.com/library/windows/apps/dn930955).</span><span class="sxs-lookup"><span data-stu-id="95167-175">The [**MediaBinder**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaBinder) class allows you to defer binding of media content in a [**MediaPlaybackList**](https://msdn.microsoft.com/library/windows/apps/dn930955).</span></span> <span data-ttu-id="95167-176">Ab Windows10, Version1703, können Sie eine [**AdaptiveMediaSource**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasource) als gebundenen Inhalt angeben.</span><span class="sxs-lookup"><span data-stu-id="95167-176">Starting with Windows 10, version 1703, you can supply an [**AdaptiveMediaSource**](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasource) as bound content.</span></span> <span data-ttu-id="95167-177">Der Prozess für die verzögerte Bindung einer adaptiven Medienquelle entspricht größtenteils dem Binden anderer Medientypen, was in [Medienelemente, Wiedergabelisten und Titel](media-playback-with-mediasource.md) beschrieben ist.</span><span class="sxs-lookup"><span data-stu-id="95167-177">The process for deferred binding of an adaptive media source is largely the same as binding other types of media, which is described in [Media items, playlists, and tracks](media-playback-with-mediasource.md).</span></span> 

<span data-ttu-id="95167-178">Erstellen Sie eine **MediaBinder**-Instanz, legen Sie eine App-definierte [**Token**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaBinder.Token)-Zeichenfolge fest, um den zu bindenden Inhalt zu identifizieren, und führen Sie eine Registrierung für das [**Binding**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaBinder.Binding)-Ereignis durch.</span><span class="sxs-lookup"><span data-stu-id="95167-178">Create a **MediaBinder** instance, set an app-defined [**Token**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaBinder.Token) string to identify the content to be bound, and register for the [**Binding**](https://docs.microsoft.com/uwp/api/Windows.Media.Core.MediaBinder.Binding) event.</span></span> <span data-ttu-id="95167-179">Erstellen Sie eine **MediaSource** aus dem **Binder**, indem Sie [**MediaSource.CreateFromMediaBinder**](https://docs.microsoft.com/uwp/api/windows.media.core.mediasource.createfrommediabinder) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="95167-179">Create a **MediaSource** from the **Binder** by calling [**MediaSource.CreateFromMediaBinder**](https://docs.microsoft.com/uwp/api/windows.media.core.mediasource.createfrommediabinder).</span></span> <span data-ttu-id="95167-180">Erstellen Sie anschließend ein **MediaPlaybackItem** aus der **MediaSource**, und fügen Sie es der Wiedergabeliste hinzu.</span><span class="sxs-lookup"><span data-stu-id="95167-180">Then, create a **MediaPlaybackItem** from the **MediaSource** and add it to the playback list.</span></span>

[!code-cs[InitMediaBinder](./code/MediaSource_RS1/cs/MainPage.xaml.cs#SnippetInitMediaBinder)]

<span data-ttu-id="95167-181">Verwenden Sie im **Bindung**-Ereignishandler die Tokenzeichenfolge zum Identifizieren des zu bindenden Inhalts, und erstellen Sie dann die adaptive Medienquelle, indem Sie eine der Überladungen von **[CreateFromStreamAsync](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasource.createfromstreamasync)** oder **[CreateFromUriAsync](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasource.createfromuriasync)** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="95167-181">In the **Binding** event handler, use the token string to identify the content to be bound and then create the adaptive media source by calling one of the overloads of **[CreateFromStreamAsync](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasource.createfromstreamasync)** or **[CreateFromUriAsync](https://docs.microsoft.com/uwp/api/windows.media.streaming.adaptive.adaptivemediasource.createfromuriasync)**.</span></span> <span data-ttu-id="95167-182">Da es sich dabei um asynchrone Methoden handelt, sollten Sie zuerst die [**MediaBindingEventArgs.GetDeferral**](https://docs.microsoft.com/uwp/api/windows.media.core.mediabindingeventargs.GetDeferral)-Methode aufrufen, um das System anzuweisen, auf den Abschluss des Vorgangs zu warten.</span><span class="sxs-lookup"><span data-stu-id="95167-182">Because these are asynchronous methods, you should first call the [**MediaBindingEventArgs.GetDeferral**](https://docs.microsoft.com/uwp/api/windows.media.core.mediabindingeventargs.GetDeferral) method to instruct the system to wait for your operation to complete before continuing.</span></span>  <span data-ttu-id="95167-183">Legen Sie die adaptive Medienquelle als gebundenen Inhalt fest, indem Sie **[SetAdaptiveMediaSource](https://docs.microsoft.com/uwp/api/windows.media.core.mediabindingeventargs.setadaptivemediasource)** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="95167-183">Set the adaptive media source as the bound content by calling **[SetAdaptiveMediaSource](https://docs.microsoft.com/uwp/api/windows.media.core.mediabindingeventargs.setadaptivemediasource)**.</span></span> <span data-ttu-id="95167-184">Rufen Sie nach Abschluss des Vorgangs [**Deferral.Complete**](https://docs.microsoft.com/uwp/api/windows.foundation.deferral.Complete) auf, um dem System mitzuteilen, dass es fortsetzen kann.</span><span class="sxs-lookup"><span data-stu-id="95167-184">Finally, call [**Deferral.Complete**](https://docs.microsoft.com/uwp/api/windows.foundation.deferral.Complete) after your operation is complete to instruct the system to continue.</span></span>

[!code-cs[BinderBindingAMS](./code/MediaSource_RS1/cs/MainPage.xaml.cs#SnippetBinderBindingAMS)]

<span data-ttu-id="95167-185">Wenn Sie Ereignishandler für die gebundene adaptive Medienquelle registrieren möchten, können Sie dies im Handler für das [**CurrentItemChanged**](https://docs.microsoft.com/uwp/api/windows.media.playback.mediaplaybacklist.CurrentItemChanged)-Ereignis der **MediaPlaybackList** durchführen.</span><span class="sxs-lookup"><span data-stu-id="95167-185">If you want to register event handlers for the bound adaptive media source, you can do this in the handler for the [**CurrentItemChanged**](https://docs.microsoft.com/uwp/api/windows.media.playback.mediaplaybacklist.CurrentItemChanged) event of the **MediaPlaybackList**.</span></span> <span data-ttu-id="95167-186">Die [**CurrentMediaPlaybackItemChangedEventArgs.NewItem**](https://docs.microsoft.com/uwp/api/windows.media.playback.currentmediaplaybackitemchangedeventargs.NewItem)-Eigenschaft enthält das neue, aktuell wiedergegebene **MediaPlaybackItem** in der Liste.</span><span class="sxs-lookup"><span data-stu-id="95167-186">The [**CurrentMediaPlaybackItemChangedEventArgs.NewItem**](https://docs.microsoft.com/uwp/api/windows.media.playback.currentmediaplaybackitemchangedeventargs.NewItem) property contains the new currently playing **MediaPlaybackItem** in the list.</span></span> <span data-ttu-id="95167-187">Rufen Sie eine Instanz der **AdaptiveMediaSource** ab, die das neue Element darstellt, indem Sie auf die [**Source**](https://docs.microsoft.com/uwp/api/Windows.Media.Playback.MediaPlaybackItem.Source)-Eigenschaft des **MediaPlaybackItem** und dann auf die [**AdaptiveMediaSource**](https://docs.microsoft.com/uwp/api/windows.media.core.mediasource.AdaptiveMediaSource) Eigenschaft der Medienquelle zugreifen.</span><span class="sxs-lookup"><span data-stu-id="95167-187">Get an instance of the **AdaptiveMediaSource** representing the new item by accessing the [**Source**](https://docs.microsoft.com/uwp/api/Windows.Media.Playback.MediaPlaybackItem.Source) property of the **MediaPlaybackItem** and then the [**AdaptiveMediaSource**](https://docs.microsoft.com/uwp/api/windows.media.core.mediasource.AdaptiveMediaSource) property of the media source.</span></span> <span data-ttu-id="95167-188">Diese Eigenschaft ist null, wenn das neue Wiedergabeelement kein **AdaptiveMediaSource** ist. Sie sollten daher auf null testen, bevor Sie versuchen, Handler für die Ereignisse des Objekts zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="95167-188">This property will be null if the new playback item is not an **AdaptiveMediaSource**, so you should test for null before attempting to register handlers for any of the object's events.</span></span>

[!code-cs[AMSBindingCurrentItemChanged](./code/MediaSource_RS1/cs/MainPage.xaml.cs#SnippetAMSBindingCurrentItemChanged)]

## <a name="related-topics"></a><span data-ttu-id="95167-189">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="95167-189">Related topics</span></span>
* [<span data-ttu-id="95167-190">Medienwiedergabe</span><span class="sxs-lookup"><span data-stu-id="95167-190">Media playback</span></span>](media-playback.md)
* [<span data-ttu-id="95167-191">Unterstützung von HLS-Tags</span><span class="sxs-lookup"><span data-stu-id="95167-191">HLS tag support</span></span>](hls-tag-support.md) 
* [<span data-ttu-id="95167-192">DASH-Profilunterstützung</span><span class="sxs-lookup"><span data-stu-id="95167-192">Dash profile support</span></span>](dash-profile-support.md) 
* [<span data-ttu-id="95167-193">Wiedergeben von Audio- und Videoinhalten mit „MediaPlayer“</span><span class="sxs-lookup"><span data-stu-id="95167-193">Play audio and video with MediaPlayer</span></span>](play-audio-and-video-with-mediaplayer.md)
* [<span data-ttu-id="95167-194">Wiedergeben von Medien im Hintergrund</span><span class="sxs-lookup"><span data-stu-id="95167-194">Play media in the background</span></span>](background-audio.md) 





