---
Description: This article describes how to create a Windows Runtime component that implements the IBasicVideoEffect interface to allow you to create custom effects for video streams.
MS-HAID: dev\_audio\_vid\_camera.custom\_video\_effects
MSHAttr: PreferredLib:/library/windows/apps
Search.Product: eADQiWindows 10XVcnh
title: Benutzerdefinierte Videoeffekte
ms.date: 02/08/2017
ms.topic: article
keywords: Windows10, UWP
ms.assetid: 40a6bd32-a756-400f-ba34-2c5f507262c0
ms.localizationpriority: medium
ms.openlocfilehash: a9e796eee76025e7697c08669e6942e0d69206f7
ms.sourcegitcommit: 8921a9cc0dd3e5665345ae8eca7ab7aeb83ccc6f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/10/2018
ms.locfileid: "8900377"
---
# <a name="custom-video-effects"></a><span data-ttu-id="81aee-103">Benutzerdefinierte Videoeffekte</span><span class="sxs-lookup"><span data-stu-id="81aee-103">Custom video effects</span></span>




<span data-ttu-id="81aee-104">In diesem Artikel wird beschrieben, wie Sie eine Komponente für Windows-Runtime erstellen, die die [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788)-Schnittstelle implementiert, mit der Sie benutzerdefinierte Effekte für Videostreams erstellen können.</span><span class="sxs-lookup"><span data-stu-id="81aee-104">This article describes how to create a Windows Runtime component that implements the [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788) interface to create custom effects for video streams.</span></span> <span data-ttu-id="81aee-105">Benutzerdefinierte Effekte können mit verschiedenen Windows-Runtime-APIs verwendet werden, z.B. [MediaCapture](https://msdn.microsoft.com/library/windows/apps/br241124), die den Zugriff auf die Kamera eines Gerätes ermöglicht, sowie [**MediaComposition**](https://msdn.microsoft.com/library/windows/apps/dn652646), mit der Sie komplexe Kompositionen aus Medienclips erstellen können.</span><span class="sxs-lookup"><span data-stu-id="81aee-105">Custom effects can be used with several different Windows Runtime APIs including [MediaCapture](https://msdn.microsoft.com/library/windows/apps/br241124), which provides access to a device's camera, and [**MediaComposition**](https://msdn.microsoft.com/library/windows/apps/dn652646), which allows you to create complex compositions out of media clips.</span></span>

## <a name="add-a-custom-effect-to-your-app"></a><span data-ttu-id="81aee-106">Hinzufügen eines benutzerdefinierten Effekts zu Ihrer App</span><span class="sxs-lookup"><span data-stu-id="81aee-106">Add a custom effect to your app</span></span>


<span data-ttu-id="81aee-107">Sie definieren einen benutzerdefinierte Videoefekt in einer Klasse, die die [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788)-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="81aee-107">A custom video effect is defined in a class that implements the [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788) interface.</span></span> <span data-ttu-id="81aee-108">Diese Klasse kann nicht direkt in Ihr App-Projekt integriert werden.</span><span class="sxs-lookup"><span data-stu-id="81aee-108">This class can't be included directly in your app's project.</span></span> <span data-ttu-id="81aee-109">Stattdessen müssen Sie eine Windows-Runtime-Komponente verwenden, um Ihre Videoeffektklasse zu hosten.</span><span class="sxs-lookup"><span data-stu-id="81aee-109">Instead, you must use a Windows Runtime component to host your video effect class.</span></span>

**<span data-ttu-id="81aee-110">Hinzufügen einer Windows-Runtime-Komponente für den Videoeffekt</span><span class="sxs-lookup"><span data-stu-id="81aee-110">Add a Windows Runtime component for your video effect</span></span>**

1.  <span data-ttu-id="81aee-111">Wechseln Sie in Microsoft Visual Studio bei geöffneter Projektmappe zum Menü **Datei**, und wählen Sie **Hinzufügen-&gt;Neues Projekt** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-111">In Microsoft Visual Studio, with your solution open, go to the **File** menu and select **Add-&gt;New Project**.</span></span>
2.  <span data-ttu-id="81aee-112">Wählen Sie den Projekttyp **Komponente für Windows-Runtime (Universal Windows)** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-112">Select the **Windows Runtime Component (Universal Windows)** project type.</span></span>
3.  <span data-ttu-id="81aee-113">Nennen Sie das Projekt in diesem Beispiel *VideoEffectComponent*.</span><span class="sxs-lookup"><span data-stu-id="81aee-113">For this example, name the project *VideoEffectComponent*.</span></span> <span data-ttu-id="81aee-114">Auf diesen Namen wird später im Code verwiesen.</span><span class="sxs-lookup"><span data-stu-id="81aee-114">This name will be referenced in code later.</span></span>
4.  <span data-ttu-id="81aee-115">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="81aee-115">Click **OK**.</span></span>
5.  <span data-ttu-id="81aee-116">Die Projektvorlage erstellt eine Klasse namens „Class1.cs“.</span><span class="sxs-lookup"><span data-stu-id="81aee-116">The project template creates a class called Class1.cs.</span></span> <span data-ttu-id="81aee-117">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf das Symbol für „Class1.cs“, und wählen Sie **Umbenennen** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-117">In **Solution Explorer**, right-click the icon for Class1.cs and select **Rename**.</span></span>
6.  <span data-ttu-id="81aee-118">Benennen Sie die Datei in *ExampleVideoEffect.cs* um.</span><span class="sxs-lookup"><span data-stu-id="81aee-118">Rename the file to *ExampleVideoEffect.cs*.</span></span> <span data-ttu-id="81aee-119">Visual Studio zeigt eine Eingabeaufforderung an, in der Sie gefragt werden, ob Sie alle Verweise mit dem neuen Namen aktualisieren möchten.</span><span class="sxs-lookup"><span data-stu-id="81aee-119">Visual Studio will show a prompt asking if you want to update all references to the new name.</span></span> <span data-ttu-id="81aee-120">Klicken Sie auf **Ja**.</span><span class="sxs-lookup"><span data-stu-id="81aee-120">Click **Yes**.</span></span>
7.  <span data-ttu-id="81aee-121">Öffnen Sie **ExampleVideoEffect.cs**, und aktualisieren Sie die Definition der Klasse, um die [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788)-Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="81aee-121">Open **ExampleVideoEffect.cs** and update the class definition to implement the [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788) interface.</span></span>

[!code-cs[ImplementIBasicVideoEffect](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetImplementIBasicVideoEffect)]


<span data-ttu-id="81aee-122">Sie müssen die folgenden Namespaces in Ihre Effektklassendatei aufnehmen, um auf alle Typen, die in den Beispielen in diesem Artikel verwendet werden, zugreifen zu können.</span><span class="sxs-lookup"><span data-stu-id="81aee-122">You need to include the following namespaces in your effect class file in order to access all of the types used in the examples in this article.</span></span>

[!code-cs[EffectUsing](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetEffectUsing)]


## <a name="implement-the-ibasicvideoeffect-interface-using-software-processing"></a><span data-ttu-id="81aee-123">Implementieren der IBasicVideoEffect-Schnittstelle mit Softwareverarbeitung</span><span class="sxs-lookup"><span data-stu-id="81aee-123">Implement the IBasicVideoEffect interface using software processing</span></span>


<span data-ttu-id="81aee-124">Der Videoeffekt muss alle Methoden und Eigenschaften der [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788)-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="81aee-124">Your video effect must implement all of the methods and properties of the [**IBasicVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn764788) interface.</span></span> <span data-ttu-id="81aee-125">In diesem Abschnitt wird der Prozess einer einfachen Implementierung der Schnittstelle erläutert, bei dem die Softwareverarbeitung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-125">This section walks you through a simple implementation of this interface that uses software processing.</span></span>

### <a name="close-method"></a><span data-ttu-id="81aee-126">Close-Methode</span><span class="sxs-lookup"><span data-stu-id="81aee-126">Close method</span></span>

<span data-ttu-id="81aee-127">Das System ruft die [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764789)-Methode für die Klasse auf, wenn der Effekt beendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="81aee-127">The system will call the [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764789) method on your class when the effect should shut down.</span></span> <span data-ttu-id="81aee-128">Sie sollten diese Methode verwenden, um alle Ressourcen, die Sie erstellt haben, zu löschen.</span><span class="sxs-lookup"><span data-stu-id="81aee-128">You should use this method to dispose of any resources you have created.</span></span> <span data-ttu-id="81aee-129">Das Argument der Methode ist ein [**MediaEffectClosedReason**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.MediaEffectClosedReason), der Ihnen mitteilt, ob der Effekt normal geschlossen wurde, ob ein Fehler aufgetreten ist oder ob der Effekt das erforderliche Codierungsformat nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="81aee-129">The argument to the method is a [**MediaEffectClosedReason**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.MediaEffectClosedReason) that lets you know whether the effect was closed normally, if an error occurred, or if the effect does not support the required encoding format.</span></span>

[!code-cs[Close](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetClose)]


### <a name="discardqueuedframes-method"></a><span data-ttu-id="81aee-130">DiscardQueuedFrames-Methode</span><span class="sxs-lookup"><span data-stu-id="81aee-130">DiscardQueuedFrames method</span></span>

<span data-ttu-id="81aee-131">Die [**DiscardQueuedFrames**](https://msdn.microsoft.com/library/windows/apps/dn764790)-Methode wird aufgerufen, wenn der Effekt zurückgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="81aee-131">The [**DiscardQueuedFrames**](https://msdn.microsoft.com/library/windows/apps/dn764790) method is called when your effect should reset.</span></span> <span data-ttu-id="81aee-132">Ein typisches Szenario hierfür ist, wenn der Effekt zuvor verarbeitete Frames zum Verarbeiten des aktuellen Frames speichert.</span><span class="sxs-lookup"><span data-stu-id="81aee-132">A typical scenario for this is if your effect stores previously processed frames to use in processing the current frame.</span></span> <span data-ttu-id="81aee-133">Wenn diese Methode aufgerufen wird, sollten Sie die zuvor gespeicherten Frames löschen.</span><span class="sxs-lookup"><span data-stu-id="81aee-133">When this method is called, you should dispose of the set of previous frames you saved.</span></span> <span data-ttu-id="81aee-134">Diese Methode kann verwendet werden, um alle Zustände im Zusammenhang mit den vorherigen Frames zurückzusetzen, nicht nur Videoframes, die sich angesammelt haben.</span><span class="sxs-lookup"><span data-stu-id="81aee-134">This method can be used to reset any state related to previous frames, not only accumulated video frames.</span></span>


[!code-cs[DiscardQueuedFrames](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetDiscardQueuedFrames)]



### <a name="isreadonly-property"></a><span data-ttu-id="81aee-135">IsReadOnly-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="81aee-135">IsReadOnly property</span></span>

<span data-ttu-id="81aee-136">Die [**IsReadOnly**](https://msdn.microsoft.com/library/windows/apps/dn764792)-Eigenschaft teilt dem System mit, ob Ihr Effekt in die Ausgabe des Effekts schreibt.</span><span class="sxs-lookup"><span data-stu-id="81aee-136">The [**IsReadOnly**](https://msdn.microsoft.com/library/windows/apps/dn764792) property lets the system know if your effect will write to the output of the effect.</span></span> <span data-ttu-id="81aee-137">Wenn Ihre App die Videoframes nicht ändert (z.B. ein Effekt, der nur eine Analyse der Videoframes durchführt), sollten Sie diese Eigenschaft auf „true“ festlegen. Dann kopiert das System für Sie die Frameeingabe in die Frameausgabe.</span><span class="sxs-lookup"><span data-stu-id="81aee-137">If your app does not modify the video frames (for example, an effect that only performs analysis of the video frames), you should set this property to true, which will cause the system to efficiently copy the frame input to the frame output for you.</span></span>

> [!TIP]
> <span data-ttu-id="81aee-138">Wenn die [**IsReadOnly**](https://msdn.microsoft.com/library/windows/apps/dn764792)-Eigenschaft auf „true“ festgelegt ist, kopiert das System den Eingabeframe in den Ausgabeframe, bevor [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-138">When the [**IsReadOnly**](https://msdn.microsoft.com/library/windows/apps/dn764792) property is set to true, the system copies the input frame to the output frame before [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794) is called.</span></span> <span data-ttu-id="81aee-139">Das Festlegen der **IsReadOnly**-Eigenschaft auf „true“ schränkt Sie nicht darin ein, in die Ausgabeframes in **ProcessFrame** zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="81aee-139">Setting the **IsReadOnly** property to true does not restrict you from writing to the effect's output frames in **ProcessFrame**.</span></span>


[!code-cs[IsReadOnly](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetIsReadOnly)]

### <a name="setencodingproperties-method"></a><span data-ttu-id="81aee-140">SetEncodingProperties-Methode</span><span class="sxs-lookup"><span data-stu-id="81aee-140">SetEncodingProperties method</span></span>

<span data-ttu-id="81aee-141">Das System ruft [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884) für den Effekt auf, um Ihnen die Codierungseigenschaften für den Videostream mitzuteilen, für den der Effekt gilt.</span><span class="sxs-lookup"><span data-stu-id="81aee-141">The system calls [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884) on your effect to let you know the encoding properties for the video stream upon which the effect is operating.</span></span> <span data-ttu-id="81aee-142">Diese Methode bietet auch einen Verweis auf das Direct3D-Gerät, welches für das Hardwarerendering verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-142">This method also provides a reference to the Direct3D device used for hardware rendering.</span></span> <span data-ttu-id="81aee-143">Die Verwendung dieses Geräts wird im Beispiel zur Hardwareverarbeitung weiter unten in diesem Artikel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="81aee-143">The usage of this device is shown in the hardware processing example later in this article.</span></span>

[!code-cs[SetEncodingProperties](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetSetEncodingProperties)]


### <a name="supportedencodingproperties-property"></a><span data-ttu-id="81aee-144">SupportedEncodingProperties-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="81aee-144">SupportedEncodingProperties property</span></span>

<span data-ttu-id="81aee-145">Das System überprüft die [**SupportedEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn764799) Eigenschaft, um festzustellen, welche Codierungseigenschaften von dem Effekt unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="81aee-145">The system checks the [**SupportedEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn764799) property to determine which encoding properties are supported by your effect.</span></span> <span data-ttu-id="81aee-146">Beachten Sie Folgendes: Wenn der Nutzer Ihres Effekts das Video mit den von Ihnen angegebenen Eigenschaften nicht codieren kann, wird [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764789) für den Effekt aufgerufen und er wird aus der Videopipeline entfernt.</span><span class="sxs-lookup"><span data-stu-id="81aee-146">Note that if the consumer of your effect can't encode video using the properties you specify, it will call [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764789) on your effect and will remove your effect from the video pipeline.</span></span>


[!code-cs[SupportedEncodingProperties](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetSupportedEncodingProperties)]


> [!NOTE] 
> <span data-ttu-id="81aee-147">Wenn Sie eine leere Liste mit [**VideoEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701217)-Objekten von **SupportedEncodingProperties** zurückgeben, verwendet das System standardmäßig die ARGB32-Codierung.</span><span class="sxs-lookup"><span data-stu-id="81aee-147">If you return an empty list of [**VideoEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701217) objects from **SupportedEncodingProperties**, the system will default to ARGB32 encoding.</span></span>

 

### <a name="supportedmemorytypes-property"></a><span data-ttu-id="81aee-148">SupportedMemoryTypes-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="81aee-148">SupportedMemoryTypes property</span></span>

<span data-ttu-id="81aee-149">Das System überprüft die [**SupportedMemoryTypes**](https://msdn.microsoft.com/library/windows/apps/dn764801) Eigenschaft, um festzustellen, ob der Effekt auf Videoframes im Softwarespeicher oder im Hardwarearbeitsspeicher (GPU) zugreift.</span><span class="sxs-lookup"><span data-stu-id="81aee-149">The system checks the [**SupportedMemoryTypes**](https://msdn.microsoft.com/library/windows/apps/dn764801) property to determine whether your effect will access video frames in software memory or in hardware (GPU) memory.</span></span> <span data-ttu-id="81aee-150">Wenn Sie [**MediaMemoryTypes.Cpu**](https://msdn.microsoft.com/library/windows/apps/dn764822) zurückgeben, werden an Ihren Effekt Ein- und Ausgabeframes übergeben, die Bilddaten in [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358)-Objekten enthalten.</span><span class="sxs-lookup"><span data-stu-id="81aee-150">If you return [**MediaMemoryTypes.Cpu**](https://msdn.microsoft.com/library/windows/apps/dn764822), your effect will be passed input and output frames that contain image data in [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) objects.</span></span> <span data-ttu-id="81aee-151">Wenn Sie **MediaMemoryTypes.Gpu** zurückgeben, werden an Ihren Effekt Ein- und Ausgabeframes übergeben, die Bilddaten in [**IDirect3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn965505)-Objekten enthalten.</span><span class="sxs-lookup"><span data-stu-id="81aee-151">If you return **MediaMemoryTypes.Gpu**, your effect will be passed input and output frames that contain image data in [**IDirect3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn965505) objects.</span></span>

[!code-cs[SupportedMemoryTypes](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetSupportedMemoryTypes)]


> [!NOTE]
> <span data-ttu-id="81aee-152">Wenn Sie [**MediaMemoryTypes.GpuAndCpu**](https://msdn.microsoft.com/library/windows/apps/dn764822) angeben, verwendet das System entweder den GPU- oder Systemarbeitsspeicher, je nachdem, welcher für die Pipeline effizienter ist.</span><span class="sxs-lookup"><span data-stu-id="81aee-152">If you specify [**MediaMemoryTypes.GpuAndCpu**](https://msdn.microsoft.com/library/windows/apps/dn764822), the system will use either GPU or system memory, whichever is more efficient for the pipeline.</span></span> <span data-ttu-id="81aee-153">Wenn Sie diesen Wert verwenden, müssen Sie in der [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794)-Methode prüfen, ob [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) oder [**IDirect3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn965505), das an die Methode übergeben wird, Daten enthält, und den Frame dann entsprechend verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="81aee-153">When using this value, you must check in the [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794) method to see whether the [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) or [**IDirect3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn965505) passed into the method contains data, and then process the frame accordingly.</span></span>

 

### <a name="timeindependent-property"></a><span data-ttu-id="81aee-154">TimeIndependent-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="81aee-154">TimeIndependent property</span></span>

<span data-ttu-id="81aee-155">Die [**TimeIndependent**](https://msdn.microsoft.com/library/windows/apps/dn764803)-Eigenschaft teilt dem System mit, dass der Effekt kein einheitliches Timing erfordert.</span><span class="sxs-lookup"><span data-stu-id="81aee-155">The [**TimeIndependent**](https://msdn.microsoft.com/library/windows/apps/dn764803) property lets the system know if your effect does not require uniform timing.</span></span> <span data-ttu-id="81aee-156">Bei Festlegung auf „true“ kann das System Optimierungen verwenden, die die Leistung des Effekts verbessern.</span><span class="sxs-lookup"><span data-stu-id="81aee-156">When set to true, the system can use optimizations that enhance effect performance.</span></span>

[!code-cs[TimeIndependent](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetTimeIndependent)]

### <a name="setproperties-method"></a><span data-ttu-id="81aee-157">SetProperties-Methode</span><span class="sxs-lookup"><span data-stu-id="81aee-157">SetProperties method</span></span>

<span data-ttu-id="81aee-158">Die [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986)-Methode ermöglicht es der App, die Ihren Effekt verwendet, die Effektparameter anzupassen.</span><span class="sxs-lookup"><span data-stu-id="81aee-158">The [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986) method allows the app that is using your effect to adjust effect parameters.</span></span> <span data-ttu-id="81aee-159">Die Eigenschaften werden als [**IPropertySet**](https://msdn.microsoft.com/library/windows/apps/br226054)-Zuordnung von Eigenschaftsnamen und -werten übergeben.</span><span class="sxs-lookup"><span data-stu-id="81aee-159">Properties are passed as an [**IPropertySet**](https://msdn.microsoft.com/library/windows/apps/br226054) map of property names and values.</span></span>


[!code-cs[SetProperties](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetSetProperties)]


<span data-ttu-id="81aee-160">In diesem einfachen Beispiel werden die Pixel in jedem Videoframe entsprechend einem angegebenen Wert abgeblendet.</span><span class="sxs-lookup"><span data-stu-id="81aee-160">This simple example will dim the pixels in each video frame according to a specified value.</span></span> <span data-ttu-id="81aee-161">Eine Eigenschaft wird deklariert, und „TryGetValue“ wird verwendet, um den von der aufrufenden App festgelegten Wert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="81aee-161">A property is declared and TryGetValue is used to get the value set by the calling app.</span></span> <span data-ttu-id="81aee-162">Wenn kein Wert festgelegt wurde, wird der Standardwert 0,5 verwendet.</span><span class="sxs-lookup"><span data-stu-id="81aee-162">If no value was set, a default value of .5 is used.</span></span>

[!code-cs[FadeValue](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetFadeValue)]


### <a name="processframe-method"></a><span data-ttu-id="81aee-163">ProcessFrame-Methode</span><span class="sxs-lookup"><span data-stu-id="81aee-163">ProcessFrame method</span></span>

<span data-ttu-id="81aee-164">Die [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794)-Methode ist die Stelle, an der Ihr Effekt die Bilddaten des Videos ändert.</span><span class="sxs-lookup"><span data-stu-id="81aee-164">The [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794) method is where your effect modifies the image data of the video.</span></span> <span data-ttu-id="81aee-165">Die Methode wird einmal pro Frame aufgerufen, und ihr wird ein [**ProcessVideoFrameContext**](https://msdn.microsoft.com/library/windows/apps/dn764826)-Objekt übergeben.</span><span class="sxs-lookup"><span data-stu-id="81aee-165">The method is called once per frame and is passed a [**ProcessVideoFrameContext**](https://msdn.microsoft.com/library/windows/apps/dn764826) object.</span></span> <span data-ttu-id="81aee-166">Dieses Objekt enthält ein [**VideoFrame**](https://msdn.microsoft.com/library/windows/apps/dn930917)-Eingabeobjekt, das den eingehenden Frame umfasst, der verarbeitet werden soll, und ein **VideoFrame**-Ausgabeobjekt, in das Sie Bilddaten schreiben, die dem Rest der Videopipeline übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="81aee-166">This object contains an input [**VideoFrame**](https://msdn.microsoft.com/library/windows/apps/dn930917) object that contains the incoming frame to be processed and an output **VideoFrame** object to which you write image data that will be passed on to rest of the video pipeline.</span></span> <span data-ttu-id="81aee-167">Jedes dieser **VideoFrame**-Objekte verfügt über eine [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn930926)-Eigenschaft und eine [**Direct3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn930920)-Eigenschaft. Welche aber verwendet werden kann, wird von dem Wert bestimmt, den Sie von der [**SupportedMemoryTypes**](https://msdn.microsoft.com/library/windows/apps/dn764801)-Eigenschaft zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="81aee-167">Each of these **VideoFrame** objects has a [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn930926) property and a [**Direct3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn930920) property, but which of these can be used is determined by the value you returned from the [**SupportedMemoryTypes**](https://msdn.microsoft.com/library/windows/apps/dn764801) property.</span></span>

<span data-ttu-id="81aee-168">Dieses Beispiel zeigt eine einfache Implementierung der **ProcessFrame**-Methode mit Softwareverarbeitung.</span><span class="sxs-lookup"><span data-stu-id="81aee-168">This example shows a simple implementation of the **ProcessFrame** method using software processing.</span></span> <span data-ttu-id="81aee-169">Weitere Informationen zum Arbeiten mit [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358)-Objekten finden Sie unter [Bildverarbeitung](imaging.md).</span><span class="sxs-lookup"><span data-stu-id="81aee-169">For more information about working with [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) objects, see [Imaging](imaging.md).</span></span> <span data-ttu-id="81aee-170">Ein Beispiel für die **ProcessFrame**-Implementierung mit Hardwareverarbeitung wird später in diesem Artikel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="81aee-170">An example **ProcessFrame** implementation using hardware processing is shown later in this article.</span></span>

<span data-ttu-id="81aee-171">Für den Zugriff auf den Datenpuffer einer **SoftwareBitmap** ist COM-Interoperabilität erforderlich. Daher sollten Sie den Namespace **System.Runtime.InteropServices** in Ihre Effektklassendatei aufnehmen.</span><span class="sxs-lookup"><span data-stu-id="81aee-171">Accessing the data buffer of a **SoftwareBitmap** requires COM interop, so you should include the **System.Runtime.InteropServices** namespace in your effect class file.</span></span>

[!code-cs[COMUsing](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetCOMUsing)]


<span data-ttu-id="81aee-172">Fügen Sie den folgenden Code in den Namespace für den Effekt ein, um die Schnittstelle für den Zugriff auf den Bildpuffer zu importieren.</span><span class="sxs-lookup"><span data-stu-id="81aee-172">Add the following code inside the namespace for your effect to import the interface for accessing the image buffer.</span></span>

[!code-cs[COMImport](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetCOMImport)]


> [!NOTE]
> <span data-ttu-id="81aee-173">Da diese Technik auf einen systemeigenen, nicht verwalteten Bildpuffer zugreift, müssen Sie Ihr Projekt konfigurieren, um unsicheren Code zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="81aee-173">Because this technique accesses a native, unmanaged image buffer, you will need to configure your project to allow unsafe code.</span></span>
> 1.  <span data-ttu-id="81aee-174">Klicken Sie im Projektmappen-Explorer mit der rechten Maustaste auf das Projekt „VideoEffectComponent“, und wählen Sie **Eigenschaften** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-174">In Solution Explorer, right-click the VideoEffectComponent project and select **Properties**.</span></span>
> 2.  <span data-ttu-id="81aee-175">Wählen Sie die Registerkarte **Erstellen** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-175">Select the **Build** tab.</span></span>
> 3.  <span data-ttu-id="81aee-176">Aktivieren Sie das Kontrollkästchen **Unsicheren Code zulassen**.</span><span class="sxs-lookup"><span data-stu-id="81aee-176">Select the **Allow unsafe code** check box.</span></span>

 

<span data-ttu-id="81aee-177">Sie können nun die **ProcessFrame**-Methodenimplementierung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="81aee-177">Now you can add the **ProcessFrame** method implementation.</span></span> <span data-ttu-id="81aee-178">Zunächst erhält diese Methode ein [**BitmapBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887325)-Objekt aus den Ein- und Ausgabesoftwarebitmaps.</span><span class="sxs-lookup"><span data-stu-id="81aee-178">First, this method obtains a [**BitmapBuffer**](https://msdn.microsoft.com/library/windows/apps/dn887325) object from both the input and output software bitmaps.</span></span> <span data-ttu-id="81aee-179">Beachten Sie, dass der Ausgabeframe zum Schreiben und die Eingabe zum Lesen geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-179">Note that the output frame is opened for writing and the input for reading.</span></span> <span data-ttu-id="81aee-180">Als Nächstes wird ein [**IMemoryBufferReference**](https://msdn.microsoft.com/library/windows/apps/dn921671)-Objekt für jeden Puffer durch Aufrufen von [**CreateReference**](https://msdn.microsoft.com/library/windows/apps/dn949046) abgerufen.</span><span class="sxs-lookup"><span data-stu-id="81aee-180">Next, an [**IMemoryBufferReference**](https://msdn.microsoft.com/library/windows/apps/dn921671) is obtained for each buffer by calling [**CreateReference**](https://msdn.microsoft.com/library/windows/apps/dn949046).</span></span> <span data-ttu-id="81aee-181">Danach wird der tatsächliche Datenpuffer durch Umwandeln der **IMemoryBufferReference**-Objekte wie die oben definierte COMInterop-Schnittstelle, **IMemoryByteAccess**, und anschließendes Aufrufen von **GetBuffer** abgerufen.</span><span class="sxs-lookup"><span data-stu-id="81aee-181">Then, the actual data buffer is obtained by casting the **IMemoryBufferReference** objects as the COM interop interface defined above, **IMemoryByteAccess**, and then calling **GetBuffer**.</span></span>

<span data-ttu-id="81aee-182">Nun, da die Datenpuffer abgerufen wurden, können Sie aus dem Eingabepuffer lesen und in den Ausgabepuffer schreiben.</span><span class="sxs-lookup"><span data-stu-id="81aee-182">Now that the data buffers have been obtained, you can read from the input buffer and write to the output buffer.</span></span> <span data-ttu-id="81aee-183">Das Layout des Puffers wird durch Aufrufen von [**GetPlaneDescription**](https://msdn.microsoft.com/library/windows/apps/dn887330) abgerufen, das Informationen über die Breite und den anfänglichen Versatz des Puffers bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="81aee-183">The layout of the buffer is obtained by calling [**GetPlaneDescription**](https://msdn.microsoft.com/library/windows/apps/dn887330), which provides information on the width, stride, and initial offset of the buffer.</span></span> <span data-ttu-id="81aee-184">Die Bits pro Pixel werden durch die Codierungseigenschaften bestimmt, die zuvor mit der [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884)-Methode festgelegt wurden.</span><span class="sxs-lookup"><span data-stu-id="81aee-184">The bits per pixel is determined by the encoding properties set previously with the [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884) method.</span></span> <span data-ttu-id="81aee-185">Anhand der Informationen zum Pufferformat wird der Index im Puffer für jedes Pixel gefunden.</span><span class="sxs-lookup"><span data-stu-id="81aee-185">The buffer format information is used to find the index into the buffer for each pixel.</span></span> <span data-ttu-id="81aee-186">Der Pixelwert aus dem Quellpuffer wird in den Zielpuffer kopiert, wobei die Farbwerte mit der FadeValue-Eigenschaft multipliziert werden, die für diesen Effekt definiert ist, um sie um den angegebenen Wert abzublenden.</span><span class="sxs-lookup"><span data-stu-id="81aee-186">The pixel value from the source buffer is copied into the target buffer, with the color values being multiplied by the FadeValue property defined for this effect to dim them by the specified amount.</span></span>

[!code-cs[ProcessFrameSoftwareBitmap](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffect.cs#SnippetProcessFrameSoftwareBitmap)]


## <a name="implement-the-ibasicvideoeffect-interface-using-hardware-processing"></a><span data-ttu-id="81aee-187">Implementieren der IBasicVideoEffect-Schnittstelle mit Hardwareverarbeitung</span><span class="sxs-lookup"><span data-stu-id="81aee-187">Implement the IBasicVideoEffect interface using hardware processing</span></span>


<span data-ttu-id="81aee-188">Das Erstellen eines benutzerdefinierten Videoeffekts mit der Hardwareverarbeitung (GPU) ist nahezu identisch mit der oben beschriebenen Verfahrensweise mit Softwareverarbeitung.</span><span class="sxs-lookup"><span data-stu-id="81aee-188">Creating a custom video effect by using hardware (GPU) processing is almost identical to using software processing as described above.</span></span> <span data-ttu-id="81aee-189">In diesem Abschnitt werden die wenigen Unterschiede in einem Effekt erläutert, bei dem die Hardwareverarbeitung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-189">This section will show the few differences in an effect that uses hardware processing.</span></span> <span data-ttu-id="81aee-190">In diesem Beispiel wird die Win2D-Windows-Runtime-API verwendet.</span><span class="sxs-lookup"><span data-stu-id="81aee-190">This example uses the Win2D Windows Runtime API.</span></span> <span data-ttu-id="81aee-191">Weitere Informationen zur Verwendung von Win2D finden Sie in der [Win2D-Dokumentation](http://go.microsoft.com/fwlink/?LinkId=519078).</span><span class="sxs-lookup"><span data-stu-id="81aee-191">For more information about using Win2D, see the [Win2D documentation](http://go.microsoft.com/fwlink/?LinkId=519078).</span></span>

<span data-ttu-id="81aee-192">Führen Sie die folgenden Schritte aus, um das Win2D-NuGet-Paket zu dem Projekt hinzuzufügen, das Sie wie im Abschnitt **Hinzufügen eines benutzerdefinierten Effekts zu Ihrer App** zu Beginn dieses Artikels beschrieben erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="81aee-192">Use the following steps to add the Win2D NuGet package to the project you created as described in the **Add a custom effect to your app** section at the beginning of this article.</span></span>

**<span data-ttu-id="81aee-193">So fügen Sie das Win2D-NuGet-Paket zum Effektprojekt hinzu</span><span class="sxs-lookup"><span data-stu-id="81aee-193">To add the Win2D NuGet package to your effect project</span></span>**

1.  <span data-ttu-id="81aee-194">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf das Projekt **VideoEffectComponent**, und wählen Sie **NuGet-Pakete verwalten** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-194">In **Solution Explorer**, right-click the **VideoEffectComponent** project and select **Manage NuGet Packages**.</span></span>
2.  <span data-ttu-id="81aee-195">Wählen Sie oben im Fenster die Registerkarte **Durchsuchen** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-195">At the top of the window, select the **Browse** tab.</span></span>
3.  <span data-ttu-id="81aee-196">Geben Sie im Suchfeld **Win2D** ein.</span><span class="sxs-lookup"><span data-stu-id="81aee-196">In the search box, enter **Win2D**.</span></span>
4.  <span data-ttu-id="81aee-197">Wählen Sie **Win2D.uwp** und anschließend im rechten Bereich **Installieren** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-197">Select **Win2D.uwp**, and then select **Install** in the right pane.</span></span>
5.  <span data-ttu-id="81aee-198">Im Dialogfeld **Änderungen überprüfen** wird das zu installierende Paket angezeigt.</span><span class="sxs-lookup"><span data-stu-id="81aee-198">The **Review Changes** dialog shows you the package to be installed.</span></span> <span data-ttu-id="81aee-199">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="81aee-199">Click **OK**.</span></span>
6.  <span data-ttu-id="81aee-200">Akzeptieren Sie die Paketlizenz.</span><span class="sxs-lookup"><span data-stu-id="81aee-200">Accept the package license.</span></span>

<span data-ttu-id="81aee-201">Zusätzlich zu den Namespaces, die bei der grundlegenden Einrichtung des Projekts verwendet wurden, müssen Sie die folgenden von Win2D bereitgestellten Namespaces hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="81aee-201">In addition to the namespaces included in the basic project setup, you will need to include the following namespaces provided by Win2D.</span></span>

[!code-cs[UsingWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetUsingWin2D)]


<span data-ttu-id="81aee-202">Da dieser Effekt GPU-Speicher für die Aktionen mit den Bilddaten verwendet, sollten Sie [**MediaMemoryTypes.Gpu**](https://msdn.microsoft.com/library/windows/apps/dn764822) aus der [**SupportedMemoryTypes**](https://msdn.microsoft.com/library/windows/apps/dn764801)-Eigenschaft zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="81aee-202">Because this effect will use GPU memory for operating on the image data, you should return [**MediaMemoryTypes.Gpu**](https://msdn.microsoft.com/library/windows/apps/dn764822) from the [**SupportedMemoryTypes**](https://msdn.microsoft.com/library/windows/apps/dn764801) property.</span></span>

[!code-cs[SupportedMemoryTypesWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetSupportedMemoryTypesWin2D)]


<span data-ttu-id="81aee-203">Legen Sie die Codierungseigenschaften, die vom Effekt unterstützt werden sollen, mit der [**SupportedEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn764799)-Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="81aee-203">Set the encoding properties that your effect will support with the [**SupportedEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn764799) property.</span></span> <span data-ttu-id="81aee-204">Wenn Sie mit Win2D arbeiten, müssen Sie die ARGB32-Codierung verwenden.</span><span class="sxs-lookup"><span data-stu-id="81aee-204">When working with Win2D, you must use ARGB32 encoding.</span></span>

[!code-cs[SupportedEncodingPropertiesWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetSupportedEncodingPropertiesWin2D)]


<span data-ttu-id="81aee-205">Verwenden Sie die [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884)-Methode, um ein neues Win2D-**CanvasDevice**-Objekt vom [**IDirect3DDevice**](https://msdn.microsoft.com/library/windows/apps/dn895092) zu erstellen, das an die Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-205">Use the [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884) method to create a new Win2D **CanvasDevice** object from the [**IDirect3DDevice**](https://msdn.microsoft.com/library/windows/apps/dn895092) passed into the method.</span></span>

[!code-cs[SetEncodingPropertiesWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetSetEncodingPropertiesWin2D)]


<span data-ttu-id="81aee-206">Die Implementierung von [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986) ist mit dem vorherigen Beispiel zur Softwareverarbeitung identisch.</span><span class="sxs-lookup"><span data-stu-id="81aee-206">The [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986) implementation is identical to the previous software processing example.</span></span> <span data-ttu-id="81aee-207">Bei diesem Beispiel wird eine **BlurAmount**-Eigenschaft verwendet, um einen Win2D-Weichzeichnereffekt zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="81aee-207">This example uses a **BlurAmount** property to configure a Win2D blur effect.</span></span>

[!code-cs[SetPropertiesWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetSetPropertiesWin2D)]

[!code-cs[BlurAmountWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetBlurAmountWin2D)]


<span data-ttu-id="81aee-208">Der letzte Schritt besteht darin, die [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794)-Methode zu implementieren, die die Bilddaten tatsächlich verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="81aee-208">The last step is to implement the [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764794) method that actually processes the image data.</span></span>

<span data-ttu-id="81aee-209">Unter Verwendung von Win2D-APIs wird eine **CanvasBitmap** von der [**Direct3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn930920)-Eigenschaft des Eingabeframes erstellt.</span><span class="sxs-lookup"><span data-stu-id="81aee-209">Using Win2D APIs, a **CanvasBitmap** is created from the input frame's [**Direct3DSurface**](https://msdn.microsoft.com/library/windows/apps/dn930920) property.</span></span> <span data-ttu-id="81aee-210">Ein **CanvasRenderTarget** wird von der **Direct3DSurface** des Ausgabeframes und eine **CanvasDrawingSession** von diesem Renderziel erstellt.</span><span class="sxs-lookup"><span data-stu-id="81aee-210">A **CanvasRenderTarget** is created from the output frame's **Direct3DSurface** and a **CanvasDrawingSession** is created from this render target.</span></span> <span data-ttu-id="81aee-211">Es wird ein neuer Win2D-**GaussianBlurEffect** initialisiert. Mithilfe der **BlurAmount**-Eigenschaft wird der Effekt über [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986) bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="81aee-211">A new Win2D **GaussianBlurEffect** is initialized, using the **BlurAmount** property our effect exposes via [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986).</span></span> <span data-ttu-id="81aee-212">Schließlich wird die **CanvasDrawingSession.DrawImage**-Methode aufgerufen, um die Eingabebitmap mithilfe des Weichzeichnereffekts in das Renderziel zu ziehen.</span><span class="sxs-lookup"><span data-stu-id="81aee-212">Finally, the **CanvasDrawingSession.DrawImage** method is called to draw the input bitmap to the render target using the blur effect.</span></span>

[!code-cs[ProcessFrameWin2D](./code/VideoEffect_Win10/cs/VideoEffectComponent/ExampleVideoEffectWin2D.cs#SnippetProcessFrameWin2D)]


## <a name="adding-your-custom-effect-to-your-app"></a><span data-ttu-id="81aee-213">Hinzufügen des benutzerdefinierten Effekts zu Ihrer App</span><span class="sxs-lookup"><span data-stu-id="81aee-213">Adding your custom effect to your app</span></span>


<span data-ttu-id="81aee-214">Um den Videoeffekt aus Ihrer App zu verwenden, müssen Sie einen Verweis zum Effektprojekt zu Ihrer App hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="81aee-214">To use your video effect from your app, you must add a reference to the effect project to your app.</span></span>

1.  <span data-ttu-id="81aee-215">Klicken Sie im Projektmappen-Explorer unter Ihrem App-Projekt mit der rechten Maustaste auf **Verweise**, und wählen Sie **Verweis hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="81aee-215">In Solution Explorer, under your app project, right-click **References** and select **Add reference**.</span></span>
2.  <span data-ttu-id="81aee-216">Erweitern Sie die Registerkarte **Projekte**, wählen Sie **Projektmappe** aus, und aktivieren Sie das Kontrollkästchen für den Projektnamen des Effekts.</span><span class="sxs-lookup"><span data-stu-id="81aee-216">Expand the **Projects** tab, select **Solution**, and then select the check box for your effect project name.</span></span> <span data-ttu-id="81aee-217">In diesem Beispiel heißt das Projekt *VideoEffectComponent*.</span><span class="sxs-lookup"><span data-stu-id="81aee-217">For this example, the name is *VideoEffectComponent*.</span></span>
3.  <span data-ttu-id="81aee-218">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="81aee-218">Click **OK**.</span></span>

### <a name="add-your-custom-effect-to-a-camera-video-stream"></a><span data-ttu-id="81aee-219">Hinzufügen Ihres benutzerdefinierten Effekts zu einem Kameravideostream</span><span class="sxs-lookup"><span data-stu-id="81aee-219">Add your custom effect to a camera video stream</span></span>

<span data-ttu-id="81aee-220">Sie können einen einfachen Vorschaustream von der Kamera einrichten, indem Sie die Schritte im Artikel [Einfacher Zugriff auf die Kameravorschau](simple-camera-preview-access.md) ausführen.</span><span class="sxs-lookup"><span data-stu-id="81aee-220">You can set up a simple preview stream from the camera by following the steps in the article [Simple camera preview access](simple-camera-preview-access.md).</span></span> <span data-ttu-id="81aee-221">Wenn Sie diese Schritte ausführen, erhalten Sie ein initialisiertes [**MediaCapture**](https://msdn.microsoft.com/library/windows/apps/br241124)-Objekt, das für den Zugriff auf den Videostream der Kamera verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-221">Following those steps will provide you with an initialized [**MediaCapture**](https://msdn.microsoft.com/library/windows/apps/br241124) object that is used to access the camera's video stream.</span></span>

<span data-ttu-id="81aee-222">Um Ihren benutzerdefinierten Videoeffekt einem Kamerastream hinzuzufügen, erstellen Sie zuerst ein neues [**VideoEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn608055)-Objekt, wobei der Namespace und der Klassenname für Ihren Effekt übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-222">To add your custom video effect to a camera stream, first create a new [**VideoEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn608055) object, passing in the namespace and class name for your effect.</span></span> <span data-ttu-id="81aee-223">Rufen Sie anschließend die [**AddVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn878035)-Methode des **MediaCapture**-Objekts auf, um den Effekt dem angegebenen Stream hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="81aee-223">Next, call the **MediaCapture** object's [**AddVideoEffect**](https://msdn.microsoft.com/library/windows/apps/dn878035) method to add your effect to the specified stream.</span></span> <span data-ttu-id="81aee-224">In diesem Beispiel wird der [**MediaStreamType.VideoPreview**](https://msdn.microsoft.com/library/windows/apps/br226640)-Wert verwendet, um anzugeben, dass der Effekt dem Vorschaustream hinzugefügt werden sollte.</span><span class="sxs-lookup"><span data-stu-id="81aee-224">This example uses the [**MediaStreamType.VideoPreview**](https://msdn.microsoft.com/library/windows/apps/br226640) value to specify that the effect should be added to the preview stream.</span></span> <span data-ttu-id="81aee-225">Wenn Ihre App die Videoaufnahme unterstützt, könnten Sie auch **MediaStreamType.VideoRecord** verwenden, um den Effekt zum Aufnahmestream hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="81aee-225">If your app supports video capture, you could also use **MediaStreamType.VideoRecord** to add the effect to the capture stream.</span></span> <span data-ttu-id="81aee-226">**AddVideoEffect** gibt ein [**IMediaExtension**](https://msdn.microsoft.com/library/windows/apps/br240985)-Objekt zurück, das Ihren benutzerdefinierten Effekt darstellt.</span><span class="sxs-lookup"><span data-stu-id="81aee-226">**AddVideoEffect** returns an [**IMediaExtension**](https://msdn.microsoft.com/library/windows/apps/br240985) object representing your custom effect.</span></span> <span data-ttu-id="81aee-227">Mit der SetProperties-Methode können Sie die Konfiguration für den Effekt festlegen.</span><span class="sxs-lookup"><span data-stu-id="81aee-227">You can use the SetProperties method to set the configuration for your effect.</span></span>

<span data-ttu-id="81aee-228">Nachdem der Effekt hinzugefügt wurde, wird [**StartPreviewAsync**](https://msdn.microsoft.com/library/windows/apps/br226613) aufgerufen, um den Vorschaustream zu starten.</span><span class="sxs-lookup"><span data-stu-id="81aee-228">After the effect has been added, [**StartPreviewAsync**](https://msdn.microsoft.com/library/windows/apps/br226613) is called to start the preview stream.</span></span>

[!code-cs[AddVideoEffectAsync](./code/VideoEffect_Win10/cs/VideoEffect_Win10/MainPage.xaml.cs#SnippetAddVideoEffectAsync)]



### <a name="add-your-custom-effect-to-a-clip-in-a-mediacomposition"></a><span data-ttu-id="81aee-229">Hinzufügen Ihres benutzerdefinierten Effekts zu einem Clip in einer Medienkomposition</span><span class="sxs-lookup"><span data-stu-id="81aee-229">Add your custom effect to a clip in a MediaComposition</span></span>

<span data-ttu-id="81aee-230">Allgemeine Informationen zum Erstellen von Medienkompositionen aus Videoclips finden Sie unter [Medienkompositionen und -bearbeitung](media-compositions-and-editing.md).</span><span class="sxs-lookup"><span data-stu-id="81aee-230">For general guidance for creating media compositions from video clips, see [Media compositions and editing](media-compositions-and-editing.md).</span></span> <span data-ttu-id="81aee-231">Der folgende Codeausschnitt zeigt das Erstellen einer einfachen Medienkomposition, die einen benutzerdefinierten Videoeffekt verwendet.</span><span class="sxs-lookup"><span data-stu-id="81aee-231">The following code snippet shows the creation of a simple media composition that uses a custom video effect.</span></span> <span data-ttu-id="81aee-232">Durch Aufruf von [**CreateFromFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn652607) wird ein [**MediaClip**](https://msdn.microsoft.com/library/windows/apps/dn652596)-Objekt erstellt. Dabei wird eine Videodatei übergeben, die von dem Benutzer mit einer [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) ausgewählt wurde, und der Clip wird zu einer neuen [**MediaComposition**](https://msdn.microsoft.com/library/windows/apps/dn652646) hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="81aee-232">A [**MediaClip**](https://msdn.microsoft.com/library/windows/apps/dn652596) object is created by calling [**CreateFromFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn652607), passing in a video file that was selected by the user with a [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847), and the clip is added to a new [**MediaComposition**](https://msdn.microsoft.com/library/windows/apps/dn652646).</span></span> <span data-ttu-id="81aee-233">Als Nächstes wird ein neues [**VideoEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn608055)-Objekt erstellt, wobei der Namespace und der Klassenname für Ihren Effekt an den Konstruktor übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="81aee-233">Next a new [**VideoEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/dn608055) object is created, passing in the namespace and class name for your effect to the constructor.</span></span> <span data-ttu-id="81aee-234">Schließlich wird die Effektdefinition zur [**VideoEffectDefinitions**](https://msdn.microsoft.com/library/windows/apps/dn652643)-Sammlung des **MediaClip**-Objekts hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="81aee-234">Finally, the effect definition is added to the [**VideoEffectDefinitions**](https://msdn.microsoft.com/library/windows/apps/dn652643) collection of the **MediaClip** object.</span></span>


[!code-cs[AddEffectToComposition](./code/VideoEffect_Win10/cs/VideoEffect_Win10/MainPage.xaml.cs#SnippetAddEffectToComposition)]


## <a name="related-topics"></a><span data-ttu-id="81aee-235">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="81aee-235">Related topics</span></span>
* [<span data-ttu-id="81aee-236">Einfacher Zugriff auf die Kameravorschau</span><span class="sxs-lookup"><span data-stu-id="81aee-236">Simple camera preview access</span></span>](simple-camera-preview-access.md)
* [<span data-ttu-id="81aee-237">Medienkompositionen und -bearbeitung</span><span class="sxs-lookup"><span data-stu-id="81aee-237">Media compositions and editing</span></span>](media-compositions-and-editing.md)
* [<span data-ttu-id="81aee-238">Win2D-Dokumentation</span><span class="sxs-lookup"><span data-stu-id="81aee-238">Win2D documentation</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=519078)
* [<span data-ttu-id="81aee-239">Medienwiedergabe</span><span class="sxs-lookup"><span data-stu-id="81aee-239">Media playback</span></span>](media-playback.md)