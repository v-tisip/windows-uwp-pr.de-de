---
author: drewbatgit
Description: This article describes how to create a Windows Runtime component that implements the IBasicAudioEffect interface to allow you to create custom effects for audio streams.
title: Benutzerdefinierte Audioeffekte
ms.author: drewbat
ms.date: 02/08/2017
ms.topic: article
keywords: Windows10, UWP
ms.assetid: 360faf3f-7e73-4db4-8324-3391f801d827
ms.localizationpriority: medium
ms.openlocfilehash: a9c62dac489be07a08acc4ad17ecb79bcc54f57a
ms.sourcegitcommit: 71e8eae5c077a7740e5606298951bb78fc42b22c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/13/2018
ms.locfileid: "6660620"
---
# <a name="custom-audio-effects"></a><span data-ttu-id="f40e8-103">Benutzerdefinierte Audioeffekte</span><span class="sxs-lookup"><span data-stu-id="f40e8-103">Custom audio effects</span></span>

<span data-ttu-id="f40e8-104">In diesem Artikel wird beschrieben, wie Sie eine Windows-Runtime-Komponente erstellen, die die [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect)-Schnittstelle implementiert, mit der Sie benutzerdefinierte Effekte für Audiostreams erstellen können.</span><span class="sxs-lookup"><span data-stu-id="f40e8-104">This article describes how to create a Windows Runtime component that implements the [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect) interface to create custom effects for audio streams.</span></span> <span data-ttu-id="f40e8-105">Benutzerdefinierte Effekte können mit mehreren unterschiedlichen Windows-Runtime-APIs erstellt werden, darunter [MediaCapture](https://msdn.microsoft.com/library/windows/apps/br241124), die den Zugriff auf die Kamera eines Geräts ermöglicht, [**MediaComposition**](https://msdn.microsoft.com/library/windows/apps/dn652646), die die Erstellung komplexer Kompositionen aus Medienclips erlaubt, oder [**AudioGraph**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Audio.AudioGraph), mit deren Hilfe Sie schnell ein Diagramm aus verschiedenen Audioeingabe/-ausgabe- sowie Submix-Knoten erstellen können.</span><span class="sxs-lookup"><span data-stu-id="f40e8-105">Custom effects can be used with several different Windows Runtime APIs including [MediaCapture](https://msdn.microsoft.com/library/windows/apps/br241124), which provides access to a device's camera, [**MediaComposition**](https://msdn.microsoft.com/library/windows/apps/dn652646), which allows you to create complex compositions out of media clips, and [**AudioGraph**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Audio.AudioGraph) which allows you to quickly assemble a graph of various audio input, output, and submix nodes.</span></span>

## <a name="add-a-custom-effect-to-your-app"></a><span data-ttu-id="f40e8-106">Hinzufügen eines benutzerdefinierten Effekts zu Ihrer App</span><span class="sxs-lookup"><span data-stu-id="f40e8-106">Add a custom effect to your app</span></span>


<span data-ttu-id="f40e8-107">Sie definieren einen benutzerdefinierte Audioeffekt in einer Klasse, die die [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect)-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="f40e8-107">A custom audio effect is defined in a class that implements the [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect) interface.</span></span> <span data-ttu-id="f40e8-108">Diese Klasse kann nicht direkt in Ihr App-Projekt integriert werden.</span><span class="sxs-lookup"><span data-stu-id="f40e8-108">This class can't be included directly in your app's project.</span></span> <span data-ttu-id="f40e8-109">Stattdessen müssen Sie eine Windows-Runtime-Komponente verwenden, um Ihre Audioeffektklasse zu hosten.</span><span class="sxs-lookup"><span data-stu-id="f40e8-109">Instead, you must use a Windows Runtime component to host your audio effect class.</span></span>

**<span data-ttu-id="f40e8-110">Hinzufügen einer Windows-Runtime-Komponente für den Audioeffekt</span><span class="sxs-lookup"><span data-stu-id="f40e8-110">Add a Windows Runtime component for your audio effect</span></span>**

1.  <span data-ttu-id="f40e8-111">Wechseln Sie in Microsoft Visual Studio bei geöffneter Projektmappe zum Menü **Datei**, und wählen Sie **Hinzufügen-&gt;Neues Projekt** aus.</span><span class="sxs-lookup"><span data-stu-id="f40e8-111">In Microsoft Visual Studio, with your solution open, go to the **File** menu and select **Add-&gt;New Project**.</span></span>
2.  <span data-ttu-id="f40e8-112">Wählen Sie den Projekttyp **Komponente für Windows-Runtime (Universal Windows)** aus.</span><span class="sxs-lookup"><span data-stu-id="f40e8-112">Select the **Windows Runtime Component (Universal Windows)** project type.</span></span>
3.  <span data-ttu-id="f40e8-113">Nennen Sie das Projekt in diesem Beispiel *AudioEffectComponent*.</span><span class="sxs-lookup"><span data-stu-id="f40e8-113">For this example, name the project *AudioEffectComponent*.</span></span> <span data-ttu-id="f40e8-114">Auf diesen Namen wird später im Code verwiesen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-114">This name will be referenced in code later.</span></span>
4.  <span data-ttu-id="f40e8-115">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="f40e8-115">Click **OK**.</span></span>
5.  <span data-ttu-id="f40e8-116">Die Projektvorlage erstellt eine Klasse namens „Class1.cs“.</span><span class="sxs-lookup"><span data-stu-id="f40e8-116">The project template creates a class called Class1.cs.</span></span> <span data-ttu-id="f40e8-117">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf das Symbol für „Class1.cs“, und wählen Sie **Umbenennen** aus.</span><span class="sxs-lookup"><span data-stu-id="f40e8-117">In **Solution Explorer**, right-click the icon for Class1.cs and select **Rename**.</span></span>
6.  <span data-ttu-id="f40e8-118">Benennen Sie die Datei in *ExampleAudioEffect.cs* um.</span><span class="sxs-lookup"><span data-stu-id="f40e8-118">Rename the file to *ExampleAudioEffect.cs*.</span></span> <span data-ttu-id="f40e8-119">Visual Studio zeigt eine Eingabeaufforderung an, in der Sie gefragt werden, ob Sie alle Verweise mit dem neuen Namen aktualisieren möchten.</span><span class="sxs-lookup"><span data-stu-id="f40e8-119">Visual Studio will show a prompt asking if you want to update all references to the new name.</span></span> <span data-ttu-id="f40e8-120">Klicken Sie auf **Ja**.</span><span class="sxs-lookup"><span data-stu-id="f40e8-120">Click **Yes**.</span></span>
7.  <span data-ttu-id="f40e8-121">Öffnen Sie **ExampleAudioEffect.cs**, und aktualisieren Sie die Definition der Klasse, um die [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect)-Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="f40e8-121">Open **ExampleAudioEffect.cs** and update the class definition to implement the [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect) interface.</span></span>


[!code-cs[ImplementIBasicAudioEffect](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetImplementIBasicAudioEffect)]

<span data-ttu-id="f40e8-122">Sie müssen die folgenden Namespaces in Ihre Effektklassendatei aufnehmen, um auf alle Typen, die in den Beispielen in diesem Artikel verwendet werden, zugreifen zu können.</span><span class="sxs-lookup"><span data-stu-id="f40e8-122">You need to include the following namespaces in your effect class file in order to access all of the types used in the examples in this article.</span></span>

[!code-cs[EffectUsing](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetEffectUsing)]

## <a name="implement-the-ibasicaudioeffect-interface"></a><span data-ttu-id="f40e8-123">Implementieren Sie die IBasicAudioEffect-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="f40e8-123">Implement the IBasicAudioEffect interface</span></span>

<span data-ttu-id="f40e8-124">Der Audioeffekt muss alle Methoden und Eigenschaften der [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect)-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="f40e8-124">Your audio effect must implement all of the methods and properties of the [**IBasicAudioEffect**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect) interface.</span></span> <span data-ttu-id="f40e8-125">Dieser Abschnitt führt Sie durch eine einfache Implementierung dieser Schnittstelle zum Erstellen eines einfachen Echoeffekts.</span><span class="sxs-lookup"><span data-stu-id="f40e8-125">This section walks you through a simple implementation of this interface to create a basic echo effect.</span></span>

### <a name="supportedencodingproperties-property"></a><span data-ttu-id="f40e8-126">SupportedEncodingProperties-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="f40e8-126">SupportedEncodingProperties property</span></span>

<span data-ttu-id="f40e8-127">Das System überprüft die [**SupportedEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect.SupportedEncodingProperties)-Eigenschaft, um festzustellen, welche Codierungseigenschaften von dem Effekt unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="f40e8-127">The system checks the [**SupportedEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect.SupportedEncodingProperties) property to determine which encoding properties are supported by your effect.</span></span> <span data-ttu-id="f40e8-128">Beachten Sie Folgendes: Wenn der Nutzer Ihres Effekts das Audio mit den von Ihnen angegebenen Eigenschaften nicht codieren kann, ruft das System [**Schließen**](https://msdn.microsoft.com/library/windows/apps/dn764782) für den Effekt auf, worauf dieser aus der Audiopipeline entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="f40e8-128">Note that if the consumer of your effect can't encode audio using the properties you specify, the system will call [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764782) on your effect and will remove your effect from the audio pipeline.</span></span> <span data-ttu-id="f40e8-129">In diesem Beispiel werden [**AudioEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.MediaProperties.AudioEncodingProperties)-Objekte erstellt und der Ausgabeliste hinzugefügt, um die 32-Bit-Float-Mono-Codierung mit 44,1kHz und 48kHz zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-129">In this example,  [**AudioEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.MediaProperties.AudioEncodingProperties) objects are created and added to the returned list to support 44.1 kHz and 48 kHz, 32-bit float, mono encoding.</span></span>

[!code-cs[SupportedEncodingProperties](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetSupportedEncodingProperties)]

### <a name="setencodingproperties-method"></a><span data-ttu-id="f40e8-130">SetEncodingProperties-Methode</span><span class="sxs-lookup"><span data-stu-id="f40e8-130">SetEncodingProperties method</span></span>

<span data-ttu-id="f40e8-131">Das System ruft [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884) für den Effekt auf, um Ihnen die Codierungseigenschaften für den Audiostream mitzuteilen, für den der Effekt gilt.</span><span class="sxs-lookup"><span data-stu-id="f40e8-131">The system calls [**SetEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/dn919884) on your effect to let you know the encoding properties for the audio stream upon which the effect is operating.</span></span> <span data-ttu-id="f40e8-132">In diesem Beispiel wird für die Implementierung eines Echoeffekts ein Puffer zur Speicherung von Audiodaten mit einer Sekunde Dauer verwendet.</span><span class="sxs-lookup"><span data-stu-id="f40e8-132">In order to implement an echo effect, this example uses a buffer to store one second of audio data.</span></span> <span data-ttu-id="f40e8-133">Diese Methode bietet die Möglichkeit, die Größe des Puffers für die Anzahl der Samples in einer Sekunde Audiodaten zu initialisieren, basierend auf der Samplingrate der Aufzeichnung.</span><span class="sxs-lookup"><span data-stu-id="f40e8-133">This method provides the opportunity to initialize the size of the buffer to the number of samples in one second of audio, based on the sample rate in which the audio is encoded.</span></span> <span data-ttu-id="f40e8-134">Der Verzögerungseffekt verwendet auch einen Ganzzahlzähler, um die aktuelle Position im Verzögerungspuffer nachzuverfolgen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-134">The delay effect also uses an integer counter to keep track of the current position in the delay buffer.</span></span> <span data-ttu-id="f40e8-135">Da **SetEncodingProperties** immer dann aufgerufen wird, wenn der Effekt der Audio-Pipeline hinzugefügt wird, ist dies ein guter Zeitpunkt für die Initialisierung dieses Werts auf 0.</span><span class="sxs-lookup"><span data-stu-id="f40e8-135">Since **SetEncodingProperties** is called whenever the effect is added to the audio pipeline, this is a good time to initialize that value to 0.</span></span> <span data-ttu-id="f40e8-136">Sie können auch das an diese Methode übergebene **AudioEncodingProperties**-Objekt zur Verwendung an anderen Stellen Ihres Effekts erfassen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-136">You may also want to capture the **AudioEncodingProperties** object passed into this method to use elsewhere in your effect.</span></span>

[!code-cs[DeclareEchoBuffer](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetDeclareEchoBuffer)]
[!code-cs[SetEncodingProperties](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetSetEncodingProperties)]


### <a name="setproperties-method"></a><span data-ttu-id="f40e8-137">SetProperties-Methode</span><span class="sxs-lookup"><span data-stu-id="f40e8-137">SetProperties method</span></span>

<span data-ttu-id="f40e8-138">Die [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986)-Methode ermöglicht es der App, die Ihren Effekt verwendet, die Effektparameter anzupassen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-138">The [**SetProperties**](https://msdn.microsoft.com/library/windows/apps/br240986) method allows the app that is using your effect to adjust effect parameters.</span></span> <span data-ttu-id="f40e8-139">Die Eigenschaften werden als [**IPropertySet**](https://msdn.microsoft.com/library/windows/apps/br226054)-Zuordnung von Eigenschaftsnamen und -werten übergeben.</span><span class="sxs-lookup"><span data-stu-id="f40e8-139">Properties are passed as an [**IPropertySet**](https://msdn.microsoft.com/library/windows/apps/br226054) map of property names and values.</span></span>

[!code-cs[SetProperties](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetSetProperties)]

<span data-ttu-id="f40e8-140">In diesem einfachen Beispiel wird das aktuelle Audiosample mit einem Wert aus dem Verzögerungspuffer gemäß dem Wert der Eigenschaft **Mix** gemischt.</span><span class="sxs-lookup"><span data-stu-id="f40e8-140">This simple example will mix the current audio sample with a value from the delay buffer according the value of the **Mix** property.</span></span> <span data-ttu-id="f40e8-141">Eine Eigenschaft wird deklariert, und „TryGetValue“ wird verwendet, um den von der aufrufenden App festgelegten Wert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-141">A property is declared and TryGetValue is used to get the value set by the calling app.</span></span> <span data-ttu-id="f40e8-142">Wenn kein Wert festgelegt wurde, wird der Standardwert 0,5 verwendet.</span><span class="sxs-lookup"><span data-stu-id="f40e8-142">If no value was set, a default value of .5 is used.</span></span> <span data-ttu-id="f40e8-143">Beachten Sie, dass diese Eigenschaft schreibgeschützt ist.</span><span class="sxs-lookup"><span data-stu-id="f40e8-143">Note that this property is read-only.</span></span> <span data-ttu-id="f40e8-144">Der Wert der Eigenschaft muss mit **SetProperties** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="f40e8-144">The property value must be set using **SetProperties**.</span></span>

[!code-cs[MixProperty](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetMixProperty)]

### <a name="processframe-method"></a><span data-ttu-id="f40e8-145">ProcessFrame-Methode</span><span class="sxs-lookup"><span data-stu-id="f40e8-145">ProcessFrame method</span></span>

<span data-ttu-id="f40e8-146">Die [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764784)-Methode ist die Stelle, an der Ihr Effekt die Audiodaten des Streams ändert.</span><span class="sxs-lookup"><span data-stu-id="f40e8-146">The [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764784) method is where your effect modifies the audio data of the stream.</span></span> <span data-ttu-id="f40e8-147">Die Methode wird einmal pro Frame aufgerufen, und es wird ihr ein [**ProcessAudioFrameContext**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext)-Objekt übergeben.</span><span class="sxs-lookup"><span data-stu-id="f40e8-147">The method is called once per frame and is passed a [**ProcessAudioFrameContext**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext) object.</span></span> <span data-ttu-id="f40e8-148">Dieses Objekt enthält ein [**AudioFrame**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.AudioFrame)-Eingabeobjekt, das den eingehenden Frame umfasst, der verarbeitet werden soll, und ein **AudioFrame**-Ausgabeobjekt, in das Sie Audiodaten schreiben, die dem Rest der Audiopipeline übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="f40e8-148">This object contains an input [**AudioFrame**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.AudioFrame) object that contains the incoming frame to be processed and an output **AudioFrame** object to which you write audio data that will be passed on to rest of the audio pipeline.</span></span> <span data-ttu-id="f40e8-149">Ein Audioframe ist ein Puffer von Audiosamples, die einen kurzen Slice von Audiodaten repräsentieren.</span><span class="sxs-lookup"><span data-stu-id="f40e8-149">An audio frame is a buffer of audio samples representing a short slice of audio data.</span></span>

<span data-ttu-id="f40e8-150">Der Zugriff auf den Datenpuffers eines **AudioFrame** erfordert COM-Interoperabilität. Sie sollten daher den **System.Runtime.InteropServices**-Namespace in Ihre Effektklassendatei einschließen und dann den folgenden Code in den Namespace aufnehmen, damit Ihr Effekt die Schnittstelle für den Zugriff auf den Audiopuffer importiert.</span><span class="sxs-lookup"><span data-stu-id="f40e8-150">Accessing the data buffer of a **AudioFrame** requires COM interop, so you should include the **System.Runtime.InteropServices** namespace in your effect class file and then add the following code inside the namespace for your effect to import the interface for accessing the audio buffer.</span></span>

[!code-cs[ComImport](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetComImport)]

> [!NOTE]
> <span data-ttu-id="f40e8-151">Da diese Technik auf einen systemeigenen, nicht verwalteten Bildpuffer zugreift, müssen Sie Ihr Projekt konfigurieren, um unsicheren Code zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-151">Because this technique accesses a native, unmanaged image buffer, you will need to configure your project to allow unsafe code.</span></span>
> 1.  <span data-ttu-id="f40e8-152">Klicken Sie im Projektmappen-Explorer mit der rechten Maustaste auf das Projekt „AudioEffectComponent“, und wählen Sie **Eigenschaften** aus.</span><span class="sxs-lookup"><span data-stu-id="f40e8-152">In Solution Explorer, right-click the AudioEffectComponent project and select **Properties**.</span></span>
> 2.  <span data-ttu-id="f40e8-153">Wählen Sie die Registerkarte **Erstellen** aus.</span><span class="sxs-lookup"><span data-stu-id="f40e8-153">Select the **Build** tab.</span></span>
> 3.  <span data-ttu-id="f40e8-154">Aktivieren Sie das Kontrollkästchen **Unsicheren Code zulassen**.</span><span class="sxs-lookup"><span data-stu-id="f40e8-154">Select the **Allow unsafe code** check box.</span></span>

 

<span data-ttu-id="f40e8-155">Sie können nun Ihrem Effekt die **ProcessFrame**-Methodenimplementierung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-155">Now you can add the **ProcessFrame** method implementation to your effect.</span></span> <span data-ttu-id="f40e8-156">Zunächst erhält diese Methode ein [**AudioBuffer**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.AudioBuffer)-Objekt aus den Ein- und Ausgabe-Audioframes.</span><span class="sxs-lookup"><span data-stu-id="f40e8-156">First, this method obtains a [**AudioBuffer**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.AudioBuffer) object from both the input and output audio frames.</span></span> <span data-ttu-id="f40e8-157">Beachten Sie, dass der Ausgabeframe zum Schreiben und die Eingabe zum Lesen geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="f40e8-157">Note that the output frame is opened for writing and the input for reading.</span></span> <span data-ttu-id="f40e8-158">Als Nächstes wird ein [**IMemoryBufferReference**](https://msdn.microsoft.com/library/windows/apps/dn921671)-Objekt für jeden Puffer durch Aufrufen von [**CreateReference**](https://msdn.microsoft.com/library/windows/apps/dn949046) abgerufen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-158">Next, an [**IMemoryBufferReference**](https://msdn.microsoft.com/library/windows/apps/dn921671) is obtained for each buffer by calling [**CreateReference**](https://msdn.microsoft.com/library/windows/apps/dn949046).</span></span> <span data-ttu-id="f40e8-159">Danach wird der tatsächliche Datenpuffer durch Umwandeln der **IMemoryBufferReference**-Objekte wie die oben definierte COMInterop-Schnittstelle, **IMemoryByteAccess**, und anschließendes Aufrufen von **GetBuffer** abgerufen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-159">Then, the actual data buffer is obtained by casting the **IMemoryBufferReference** objects as the COM interop interface defined above, **IMemoryByteAccess**, and then calling **GetBuffer**.</span></span>

<span data-ttu-id="f40e8-160">Nun, da die Datenpuffer abgerufen wurden, können Sie aus dem Eingabepuffer lesen und in den Ausgabepuffer schreiben.</span><span class="sxs-lookup"><span data-stu-id="f40e8-160">Now that the data buffers have been obtained, you can read from the input buffer and write to the output buffer.</span></span> <span data-ttu-id="f40e8-161">Für jedes Sample im Eingabepuffer wird der Wert abgerufen und mit 1 - **Mix** multipliziert, um den „trockenen“ Signalwert des Effekts festzulegen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-161">For each sample in the inputbuffer, the value is obtained and multiplied by 1 - **Mix** to set the dry signal value of the effect.</span></span> <span data-ttu-id="f40e8-162">Anschließend wird ein Sample aus seiner aktuellen Position im Echopuffer abgerufen und mit **Mix** multipliziert, um den „nassen“ Wert des Effekts einzurichten.</span><span class="sxs-lookup"><span data-stu-id="f40e8-162">Next, a sample is retrieved from the current position in the echo buffer and multiplied by **Mix** to set the wet value of the effect.</span></span> <span data-ttu-id="f40e8-163">Das Ausgabesample wird auf die Summe des „trockenen“ und des „nassen“ Werts gesetzt.</span><span class="sxs-lookup"><span data-stu-id="f40e8-163">The output sample is set to the sum of the dry and wet values.</span></span> <span data-ttu-id="f40e8-164">Schließlich wird jedes Eingabesample im Echopuffer gespeichert, und der aktuelle Sample-Index wird erhöht.</span><span class="sxs-lookup"><span data-stu-id="f40e8-164">Finally, each input sample is stored in the echo buffer and the current sample index is incremented.</span></span>

[!code-cs[ProcessFrame](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetProcessFrame)]



### <a name="close-method"></a><span data-ttu-id="f40e8-165">Close-Methode</span><span class="sxs-lookup"><span data-stu-id="f40e8-165">Close method</span></span>

<span data-ttu-id="f40e8-166">Das System ruft die [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764782) [**Schließen**](https://msdn.microsoft.com/library/windows/apps/dn764782)-Methode für die Klasse auf, wenn der Effekt ausgeschaltet werden soll.</span><span class="sxs-lookup"><span data-stu-id="f40e8-166">The system will call the [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764782) [**Close**](https://msdn.microsoft.com/library/windows/apps/dn764782) method on your class when the effect should shut down.</span></span> <span data-ttu-id="f40e8-167">Sie sollten diese Methode verwenden, um alle Ressourcen, die Sie erstellt haben, zu löschen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-167">You should use this method to dispose of any resources you have created.</span></span> <span data-ttu-id="f40e8-168">Das Argument der Methode ist ein [**MediaEffectClosedReason**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.MediaEffectClosedReason), der Ihnen mitteilt, ob der Effekt normal geschlossen wurde, ob ein Fehler aufgetreten ist oder ob der Effekt das erforderliche Codierungsformat nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="f40e8-168">The argument to the method is a [**MediaEffectClosedReason**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.MediaEffectClosedReason) that lets you know whether the effect was closed normally, if an error occurred, or if the effect does not support the required encoding format.</span></span>

[!code-cs[Close](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetClose)]

### <a name="discardqueuedframes-method"></a><span data-ttu-id="f40e8-169">DiscardQueuedFrames-Methode</span><span class="sxs-lookup"><span data-stu-id="f40e8-169">DiscardQueuedFrames method</span></span>

<span data-ttu-id="f40e8-170">Die [**DiscardQueuedFrames**](https://msdn.microsoft.com/library/windows/apps/dn764790)-Methode wird aufgerufen, wenn der Effekt zurückgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="f40e8-170">The [**DiscardQueuedFrames**](https://msdn.microsoft.com/library/windows/apps/dn764790) method is called when your effect should reset.</span></span> <span data-ttu-id="f40e8-171">Ein typisches Szenario hierfür ist, wenn der Effekt zuvor verarbeitete Frames zum Verarbeiten des aktuellen Frames speichert.</span><span class="sxs-lookup"><span data-stu-id="f40e8-171">A typical scenario for this is if your effect stores previously processed frames to use in processing the current frame.</span></span> <span data-ttu-id="f40e8-172">Wenn diese Methode aufgerufen wird, sollten Sie die zuvor gespeicherten Frames löschen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-172">When this method is called, you should dispose of the set of previous frames you saved.</span></span> <span data-ttu-id="f40e8-173">Diese Methode kann verwendet werden, um alle Zustände im Zusammenhang mit den vorherigen Frames zurückzusetzen, nicht nur Audioframes, die sich angesammelt haben.</span><span class="sxs-lookup"><span data-stu-id="f40e8-173">This method can be used to reset any state related to previous frames, not only accumulated audio frames.</span></span>

[!code-cs[DiscardQueuedFrames](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetDiscardQueuedFrames)]

### <a name="timeindependent-property"></a><span data-ttu-id="f40e8-174">TimeIndependent-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="f40e8-174">TimeIndependent property</span></span>

<span data-ttu-id="f40e8-175">Die [**TimeIndependent**](https://msdn.microsoft.com/library/windows/apps/dn764803)-Eigenschaft teilt dem System mit, dass der Effekt kein einheitliches Timing erfordert.</span><span class="sxs-lookup"><span data-stu-id="f40e8-175">The TimeIndependent [**TimeIndependent**](https://msdn.microsoft.com/library/windows/apps/dn764803) property lets the system know if your effect does not require uniform timing.</span></span> <span data-ttu-id="f40e8-176">Bei Festlegung auf „true“ kann das System Optimierungen verwenden, die die Leistung des Effekts verbessern.</span><span class="sxs-lookup"><span data-stu-id="f40e8-176">When set to true, the system can use optimizations that enhance effect performance.</span></span>

[!code-cs[TimeIndependent](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetTimeIndependent)]

### <a name="useinputframeforoutput-property"></a><span data-ttu-id="f40e8-177">UseInputFrameForOutput-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="f40e8-177">UseInputFrameForOutput property</span></span>

<span data-ttu-id="f40e8-178">Legen Sie die [**UseInputFrameForOutput**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect.UseInputFrameForOutput)-Eigenschaft auf **true** fest, um dem System mitzuteilen, dass Ihr Effekt seine Ausgabe in den Audiopuffer des [**InputFrame**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext.InputFrame) des [**ProcessAudioFrameContext**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext) schreibt, der an [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764784) übergeben wurde, anstatt in den [**OutputFrame**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext.OutputFrame).</span><span class="sxs-lookup"><span data-stu-id="f40e8-178">Set the [**UseInputFrameForOutput**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.IBasicAudioEffect.UseInputFrameForOutput) property to **true** to tell the system that your effect will write its output to the audio buffer of the  [**InputFrame**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext.InputFrame) of the [**ProcessAudioFrameContext**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext) passed into [**ProcessFrame**](https://msdn.microsoft.com/library/windows/apps/dn764784) instead of writing to the [**OutputFrame**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.ProcessAudioFrameContext.OutputFrame).</span></span> 

[!code-cs[UseInputFrameForOutput](./code/AudioGraph/AudioEffectComponent/ExampleAudioEffect.cs#SnippetUseInputFrameForOutput)]


## <a name="adding-your-custom-effect-to-your-app"></a><span data-ttu-id="f40e8-179">Hinzufügen des benutzerdefinierten Effekts zu Ihrer App</span><span class="sxs-lookup"><span data-stu-id="f40e8-179">Adding your custom effect to your app</span></span>


<span data-ttu-id="f40e8-180">Um den Audioeffekt aus Ihrer App zu verwenden, müssen Sie Ihrer App einen Verweis auf den Effektprojekt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f40e8-180">To use your audio effect from your app, you must add a reference to the effect project to your app.</span></span>

1.  <span data-ttu-id="f40e8-181">Klicken Sie im Projektmappen-Explorer unter Ihrem App-Projekt mit der rechten Maustaste auf **Verweise**, und wählen Sie **Verweis hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="f40e8-181">In Solution Explorer, under your app project, right-click **References** and select **Add reference**.</span></span>
2.  <span data-ttu-id="f40e8-182">Erweitern Sie die Registerkarte **Projekte**, wählen Sie **Projektmappe** aus, und aktivieren Sie das Kontrollkästchen für den Projektnamen des Effekts.</span><span class="sxs-lookup"><span data-stu-id="f40e8-182">Expand the **Projects** tab, select **Solution**, and then select the check box for your effect project name.</span></span> <span data-ttu-id="f40e8-183">In diesem Beispiel heißt das Projekt *AudioEffectComponent*.</span><span class="sxs-lookup"><span data-stu-id="f40e8-183">For this example, the name is *AudioEffectComponent*.</span></span>
3.  <span data-ttu-id="f40e8-184">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="f40e8-184">Click **OK**</span></span>

<span data-ttu-id="f40e8-185">Wenn Ihre Audioeffektklasse in einem anderen Namespace deklariert ist, nehmen Sie diesen Namespace in Ihre Codedatei auf.</span><span class="sxs-lookup"><span data-stu-id="f40e8-185">If your audio effect class is declared is a different namespace, be sure to include that namespace in your code file.</span></span>

[!code-cs[UsingAudioEffectComponent](./code/AudioGraph/cs/MainPage.xaml.cs#SnippetUsingAudioEffectComponent)]

### <a name="add-your-custom-effect-to-an-audiograph-node"></a><span data-ttu-id="f40e8-186">Fügen Sie Ihren benutzerdefinierten Effekt einem AudioGraph-Knoten hinzu</span><span class="sxs-lookup"><span data-stu-id="f40e8-186">Add your custom effect to an AudioGraph node</span></span>
<span data-ttu-id="f40e8-187">Allgemeine Informationen zur Verwendung von Audiodiagrammen finden Sie unter [Audio Graphs](audio-graphs.md).</span><span class="sxs-lookup"><span data-stu-id="f40e8-187">For general information about using audio graphs, see [Audio garphs](audio-graphs.md).</span></span> <span data-ttu-id="f40e8-188">Der folgende Codeausschnitt veranschaulicht, wie der in diesem Artikel vorgestellte Beispielechoeffekt einem Audiodiagrammknoten hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="f40e8-188">The following code snippet shows you how to add the example echoe effect shown in this article to an audio graph node.</span></span> <span data-ttu-id="f40e8-189">Zuerst wird ein [**PropertySet**](https://msdn.microsoft.com/library/windows/apps/Windows.Foundation.Collections.PropertySet) erstellt und ein von dem Effekt definierter Wert für die **Mix**-Eigenschaft festgelegt.</span><span class="sxs-lookup"><span data-stu-id="f40e8-189">First, a [**PropertySet**](https://msdn.microsoft.com/library/windows/apps/Windows.Foundation.Collections.PropertySet) is created and a value for the **Mix** property, defined by the effect, is set.</span></span> <span data-ttu-id="f40e8-190">Anschließend wird der [**AudioEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.AudioEffectDefinition)-Konstruktor aufgerufen, der den vollständigen Klassennamen des benutzerdefinierten Effekttyps und den Eigenschaftensatz übergibt.</span><span class="sxs-lookup"><span data-stu-id="f40e8-190">Next, the [**AudioEffectDefinition**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Effects.AudioEffectDefinition) constructor is called, passing in the full class name of the custom effect type and the property set.</span></span> <span data-ttu-id="f40e8-191">Schließlich wird die Effektdefinition der [**EffectDefinitions**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Audio.AudioFileInputNode.EffectDefinitions)-Eigenschaft eines [**FileInputNode**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Audio.CreateAudioFileInputNodeResult.FileInputNode) hinzugefügt, wodurch der ausgegebene Audioinhalt vom benutzerdefinierten Effekt verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="f40e8-191">Finally, the effect definition is added to the [**EffectDefinitions**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Audio.AudioFileInputNode.EffectDefinitions) property of an existing [**FileInputNode**](https://msdn.microsoft.com/library/windows/apps/Windows.Media.Audio.CreateAudioFileInputNodeResult.FileInputNode), causing the audio emitted to be processed by the custom effect.</span></span> 

[!code-cs[AddCustomEffect](./code/AudioGraph/cs/MainPage.xaml.cs#SnippetAddCustomEffect)]

<span data-ttu-id="f40e8-192">Nachdem er einem Knoten hinzugefügt wurde, kann der benutzerdefinierte Effekt durch den Aufruf von [**DisableEffectsByDefinition**](https://msdn.microsoft.com/library/windows/apps/dn958480) und die Übergabe des **AudioEffectDefinition**-Objekts deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="f40e8-192">After it has been added to a node, the custom effect can be disabled by calling [**DisableEffectsByDefinition**](https://msdn.microsoft.com/library/windows/apps/dn958480) and passing in the **AudioEffectDefinition** object.</span></span> <span data-ttu-id="f40e8-193">Weitere Informationen zur Verwendung von Audiodiagrammen in Ihrer App finden Sie unter [AudioGraph](audio-graphs.md).</span><span class="sxs-lookup"><span data-stu-id="f40e8-193">For more information about using audio graphs in your app, see [AudioGraph](audio-graphs.md).</span></span>

### <a name="add-your-custom-effect-to-a-clip-in-a-mediacomposition"></a><span data-ttu-id="f40e8-194">Hinzufügen Ihres benutzerdefinierten Effekts zu einem Clip in einer MediaComposition</span><span class="sxs-lookup"><span data-stu-id="f40e8-194">Add your custom effect to a clip in a MediaComposition</span></span>

<span data-ttu-id="f40e8-195">Der folgende Codeausschnitt veranschaulicht das Hinzufügen des benutzerdefinierten Audioeffekts zu einem Videoclip und einer Hintergrund-Audiospur in einer Medienkomposition.</span><span class="sxs-lookup"><span data-stu-id="f40e8-195">The following code snippet demonstrates adding the custom audio effect to a video clip and a background audio track in a media composition.</span></span> <span data-ttu-id="f40e8-196">Allgemeine Informationen zum Erstellen von Medienkompositionen aus Videoclips und zum Hinzufügen von Hintergrund-Audiospuren finden Sie unter [Medienkompositionen und -bearbeitung](media-compositions-and-editing.md).</span><span class="sxs-lookup"><span data-stu-id="f40e8-196">For general guidance for creating media compositions from video clips and adding background audio tracks, see [Media compositions and editing](media-compositions-and-editing.md).</span></span>

[!code-cs[AddCustomAudioEffect](./code/MediaEditing/cs/MainPage.xaml.cs#SnippetAddCustomAudioEffect)]



## <a name="related-topics"></a><span data-ttu-id="f40e8-197">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="f40e8-197">Related topics</span></span>
* [<span data-ttu-id="f40e8-198">Einfacher Zugriff auf die Kameravorschau</span><span class="sxs-lookup"><span data-stu-id="f40e8-198">Simple camera preview access</span></span>](simple-camera-preview-access.md)
* [<span data-ttu-id="f40e8-199">Medienkompositionen und -bearbeitung</span><span class="sxs-lookup"><span data-stu-id="f40e8-199">Media compositions and editing</span></span>](media-compositions-and-editing.md)
* [<span data-ttu-id="f40e8-200">Win2D-Dokumentation</span><span class="sxs-lookup"><span data-stu-id="f40e8-200">Win2D documentation</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=519078)
* [<span data-ttu-id="f40e8-201">Medienwiedergabe</span><span class="sxs-lookup"><span data-stu-id="f40e8-201">Media playback</span></span>](media-playback.md)

 



