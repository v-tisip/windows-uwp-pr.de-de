---
title: Tiefenpuffer
description: Ein Tiefenpuffer oder Z-Puffer speichert Tiefeninformationen. Diese steuern, welche Bereiche von Polygonen dargestellt werden.
ms.assetid: BE83A1D7-D43D-4013-8817-EFD2B24DC58E
keywords:
- Tiefenpuffer
author: michaelfromredmond
ms.author: mithom
ms.date: 02/08/2017
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: fb7ff4b23f9735347ce75e2e565c1b420ec936d6
ms.sourcegitcommit: 6cc275f2151f78db40c11ace381ee2d35f0155f9
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/25/2018
ms.locfileid: "5547744"
---
# <a name="depth-buffers"></a><span data-ttu-id="3502a-104">Tiefenpuffer</span><span class="sxs-lookup"><span data-stu-id="3502a-104">Depth buffers</span></span>


<span data-ttu-id="3502a-105">Ein *Tiefenpuffer* oder *Z-Puffer* speichert Tiefeninformationen. Diese steuern, welche Bereiche von Polygonen dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="3502a-105">A *depth buffer*, or *z-buffer*, stores depth information to control which areas of polygons are rendered rather than hidden from view.</span></span>

## <a name="span-idoverviewspanspan-idoverviewspanspan-idoverviewspanoverview"></a><span data-ttu-id="3502a-106"><span id="Overview"></span><span id="overview"></span><span id="OVERVIEW"></span>Übersicht</span><span class="sxs-lookup"><span data-stu-id="3502a-106"><span id="Overview"></span><span id="overview"></span><span id="OVERVIEW"></span>Overview</span></span>


<span data-ttu-id="3502a-107">Ein Tiefenpuffer oder auch Z-Puffer bzw. W-Puffer ist ein Element des Geräts, das Tiefeninformationen für die Nutzung durch Direct3D speichert.</span><span class="sxs-lookup"><span data-stu-id="3502a-107">A depth buffer, often called a z-buffer or a w-buffer, is a property of the device that stores depth information to be used by Direct3D.</span></span> <span data-ttu-id="3502a-108">Beim Rendern einer Szene auf eine Zieloberfläche durch Direct3D kann der Speicher für den einer Oberfläche zugeordneten Tiefenpuffer als Arbeitsbereich zur Bestimmung der Überlagerung der gerasterten Pixel von Polygonen genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="3502a-108">When Direct3D renders a scene to a target surface, it can use the memory in an associated depth-buffer surface as a workspace to determine how the pixels of rasterized polygons occlude one another.</span></span> <span data-ttu-id="3502a-109">Direct3D verwendet eine Direct3D-Oberfläche außerhalb des Bildschirms als Ziel zum Schreiben der endgültigen Farbwerte.</span><span class="sxs-lookup"><span data-stu-id="3502a-109">Direct3D uses an off-screen Direct3D surface as the target to which final color values are written.</span></span> <span data-ttu-id="3502a-110">Die Tiefenpufferoberfläche, die der Renderzieloberfläche zugeordnet ist, wird verwendet, um Tiefeninformationen zu speichern. Diese zeigen Direct3D, wie tief jedes sichtbare Pixel in der Szene angeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="3502a-110">The depth-buffer surface that is associated with the render-target surface is used to store depth information that tells Direct3D how deep each visible pixel is in the scene.</span></span>

<span data-ttu-id="3502a-111">Wenn eine Szene mit aktivierter Tiefenpufferung gerastert wird, wird jeder Punkt auf der Renderingoberfläche getestet.</span><span class="sxs-lookup"><span data-stu-id="3502a-111">When a scene is rasterized with depth buffering enabled, each point on the rendering surface is tested.</span></span> <span data-ttu-id="3502a-112">Bei den Werten im Tiefenpuffer kann es sich um die Z-Koordinate des Punkts oder dessen homogene W-Koordinate (aus der X, Y, Z, W-Position des Punktes im Projektionsbereich) handeln.</span><span class="sxs-lookup"><span data-stu-id="3502a-112">The values in the depth buffer can be a point's z-coordinate or its homogeneous w-coordinate - from the point's (x,y,z,w) location in projection space.</span></span> <span data-ttu-id="3502a-113">Ein Tiefenpuffer, der Z-Werte verwendet, wird häufig als Z-Puffer bezeichnet. Ein Puffer, der W-Werte verwendet, wird W-Puffer genannt.</span><span class="sxs-lookup"><span data-stu-id="3502a-113">A depth buffer that uses z values is often called a z-buffer, and one that uses w values is called a w-buffer.</span></span> <span data-ttu-id="3502a-114">Jede Art von Tiefenpuffer hat Vor- und Nachteile. Diese werden später erläutert.</span><span class="sxs-lookup"><span data-stu-id="3502a-114">Each type of depth buffer has advantages and disadvantages, which are discussed later.</span></span>

<span data-ttu-id="3502a-115">Am Anfang des Tests, wird der Wert für die Tiefe im Tiefenpuffer auf den größten Wert für die Szene festgelegt.</span><span class="sxs-lookup"><span data-stu-id="3502a-115">At the beginning of the test, the depth value in the depth buffer is set to the largest possible value for the scene.</span></span> <span data-ttu-id="3502a-116">Der Farbwert auf der Renderingoberfläche wird entweder auf den Wert der Hintergrundfarbe oder den Farbwert der Hintergrundtextur an diesem Punkt festgelegt.</span><span class="sxs-lookup"><span data-stu-id="3502a-116">The color value on the rendering surface is set to either the background color value or the color value of the background texture at that point.</span></span> <span data-ttu-id="3502a-117">Jedes Polygon in der Szene wird getestet. So wird festgestellt, ob er sich mit der aktuellen Koordinate (x, y) auf der Renderingoberfläche überschneidet.</span><span class="sxs-lookup"><span data-stu-id="3502a-117">Each polygon in the scene is tested to see if it intersects with the current coordinate (x,y) on the rendering surface.</span></span>

<span data-ttu-id="3502a-118">Wenn er sich überschneidet, wird der Tiefenwert (die Z-Koordinate in einem Z-Puffer oder die W-Koordinate in einem W-Puffer) am aktuellen Punkt getestet, um festzustellen, ob dieser kleiner als der im Tiefenpuffer gespeicherte Tiefenwert ist.</span><span class="sxs-lookup"><span data-stu-id="3502a-118">If it does intersect, the depth value - which will be the z coordinate in a z-buffer, and the w coordinate in a w-buffer - at the current point is tested to see if it is smaller than the depth value stored in the depth buffer.</span></span> <span data-ttu-id="3502a-119">Wenn der Tiefenwert des Polygons kleiner ist, wird dieser im Tiefenpuffer gespeichert. Der Farbwert des Polygons wird in den aktuellen Punkt auf der Renderingoberfläche geschrieben.</span><span class="sxs-lookup"><span data-stu-id="3502a-119">If the depth of the polygon value is smaller, it is stored in the depth buffer and the color value from the polygon is written to the current point on the rendering surface.</span></span> <span data-ttu-id="3502a-120">Wenn der Tiefenwert des Polygons an diesem Punkt größer ist, wird die nächste Polygon in der Liste getestet.</span><span class="sxs-lookup"><span data-stu-id="3502a-120">If the depth value of the polygon at that point is larger, the next polygon in the list is tested.</span></span> <span data-ttu-id="3502a-121">Dieser Prozess wird im folgenden Diagramm dargestellt.</span><span class="sxs-lookup"><span data-stu-id="3502a-121">This process is shown in the following diagram.</span></span>

![Diagramm zum Testen von Tiefenwerten](images/zbuffer.png)

## <a name="span-idbufferingtechniquesspanspan-idbufferingtechniquesspanspan-idbufferingtechniquesspanbuffering-techniques"></a><span data-ttu-id="3502a-123"><span id="Buffering_techniques"></span><span id="buffering_techniques"></span><span id="BUFFERING_TECHNIQUES"></span>Pufferungs-Techniken</span><span class="sxs-lookup"><span data-stu-id="3502a-123"><span id="Buffering_techniques"></span><span id="buffering_techniques"></span><span id="BUFFERING_TECHNIQUES"></span>Buffering techniques</span></span>


<span data-ttu-id="3502a-124">Obwohl die meisten Anwendungen dieses Feature nicht verwenden, ist es möglich, den von Direct3D zur Bestimmung der in den Tiefenpuffer und in die Renderzieloberfläche zu schreibenden Werte verwendeten Vergleich zu ändern.</span><span class="sxs-lookup"><span data-stu-id="3502a-124">Although most applications don't use this feature, you can change the comparison that Direct3D uses to determine which values are placed in the depth buffer and subsequently the render-target surface.</span></span> <span data-ttu-id="3502a-125">Auf bestimmter Hardware ist es möglich, das die Änderung der Vergleichsfunktion das Testen von hierarchischen Z-Werten deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="3502a-125">On some hardware, changing the compare function may disable hierarchical z testing.</span></span>

<span data-ttu-id="3502a-126">Fast alle im Markt verfügbaren Hardwarebeschleuniger unterstützten die Z-Pufferung. Die Z-Pufferung ist daher heute der am häufigsten verwendeten Tiefenpuffer-Typ.</span><span class="sxs-lookup"><span data-stu-id="3502a-126">Nearly all accelerators on the market support z-buffering, making z-buffers the most common type of depth buffer today.</span></span> <span data-ttu-id="3502a-127">Trotz ihrer breitflächigen Nutzung haben Z-Puffer Nachteile.</span><span class="sxs-lookup"><span data-stu-id="3502a-127">However ubiquitous, z-buffers have their drawbacks.</span></span> <span data-ttu-id="3502a-128">Aufgrund der erforderlichen Berechnungen tendieren die generierten Z-Werte in einem Z-Puffer zu einer ungleichmäßigen Verteilung auf den Z-Puffer-Bereich (in der Regel zwischen 0,0 und 1,0 – einschließlich dieser beiden Randwerte).</span><span class="sxs-lookup"><span data-stu-id="3502a-128">Due to the mathematics involved, the generated z values in a z-buffer tend not to be distributed evenly across the z-buffer range (typically 0.0 to 1.0, inclusive).</span></span>

<span data-ttu-id="3502a-129">Besonders das Verhältnis zwischen den entfernten und nahen Clippingebenen wirkt sich stark auf die ungleichmäßige Verteilung der Z-Werte aus.</span><span class="sxs-lookup"><span data-stu-id="3502a-129">Specifically, the ratio between the far and near clipping planes strongly affects how unevenly z values are distributed.</span></span> <span data-ttu-id="3502a-130">Mit einem Distanzverhältnis von 100 zwischen entfernter Ebene und naher Ebene wird 90 Prozent des Pufferbereichs für die ersten 10Prozent des Tiefenbereichs der Szene genutzt.</span><span class="sxs-lookup"><span data-stu-id="3502a-130">Using a far-plane distance to near-plane distance ratio of 100, 90 percent of the depth buffer range is spent on the first 10 percent of the scene depth range.</span></span> <span data-ttu-id="3502a-131">Standardanwendungen im Unterhaltungsbereich oder visuelle Simulationen mit Szenen in Außenbereichen erfordern häufig ein Verhältnis zwischen entfernter und naher Ebene, das zwischen 1.000 und 10.000 liegt.</span><span class="sxs-lookup"><span data-stu-id="3502a-131">Typical applications for entertainment or visual simulations with exterior scenes often require far-plane/near-plane ratios of anywhere between 1,000 to 10,000.</span></span> <span data-ttu-id="3502a-132">Bei einem Verhältnis von 1.000 wird 98Prozent des Bereichs für die erste 2Prozent des Tiefenbereichs genutzt. Bei höheren Verhältnissen wird die Verteilung noch schlechter.</span><span class="sxs-lookup"><span data-stu-id="3502a-132">At a ratio of 1,000, 98 percent of the range is spent on the first 2 percent of the depth range, and the distribution becomes worse with higher ratios.</span></span> <span data-ttu-id="3502a-133">Dies kann zu versteckten Oberflächenartefakten bei entfernten Objekten führen – insbesondere bei der Verwendung von 16-Bit-Tiefenpuffern (die am häufigsten unterstützten Bittiefe).</span><span class="sxs-lookup"><span data-stu-id="3502a-133">This can cause hidden surface artifacts in distant objects, especially when using 16-bit depth buffers, the most commonly supported bit-depth.</span></span>

<span data-ttu-id="3502a-134">Bei einem W-basierten Tiefenpuffer ist die Verteilung zwischen den nahen und entfernten Clippingebenen hingegen häufig gleichmäßiger als bei einem Z-Puffer.</span><span class="sxs-lookup"><span data-stu-id="3502a-134">A w-based depth buffer, on the other hand, is often more evenly distributed between the near and far clip planes than a z-buffer.</span></span> <span data-ttu-id="3502a-135">Der wichtigste Vorteil ist, dass das Entfernungsverhältnis zwischen den entfernten und nahen Clippingebenen kein Problem mehr darstellt.</span><span class="sxs-lookup"><span data-stu-id="3502a-135">The key benefit is that the ratio of distances for the far and near clipping planes is no longer an issue.</span></span> <span data-ttu-id="3502a-136">Anwendungen können so mit großen Maximalbereichen arbeiten und erhalten trotzdem eine relativ präzise Tiefenpufferung für nahe Punkte.</span><span class="sxs-lookup"><span data-stu-id="3502a-136">This allows applications to support large maximum ranges, while still getting relatively accurate depth buffering close to the eye point.</span></span> <span data-ttu-id="3502a-137">Ein W-basierter Tiefenpuffer ist jedoch auch nicht perfekt. Manchmal kann es zu versteckten Oberflächenartefakten bei nahen Objekten kommen.</span><span class="sxs-lookup"><span data-stu-id="3502a-137">A w-based depth buffer isn't perfect, and can sometimes exhibit hidden surface artifacts for near objects.</span></span> <span data-ttu-id="3502a-138">Ein weiterer Nachteil des W-gepufferten Ansatzes liegt in der Hardwareunterstützung: Die W-Pufferung wird nicht so weitflächig unterstützt wie die Z-Pufferung.</span><span class="sxs-lookup"><span data-stu-id="3502a-138">Another drawback to the w-buffered approach is related to hardware support: w-buffering isn't supported as widely in hardware as z-buffering.</span></span>

<span data-ttu-id="3502a-139">Bei einem Z-Puffer ist außerdem Mehraufwand beim Rendern erforderlich.</span><span class="sxs-lookup"><span data-stu-id="3502a-139">Using a z-buffer requires overhead during rendering.</span></span> <span data-ttu-id="3502a-140">Bei Z-Puffern können verschiedene Techniken zur Optimierung des Renderings eingesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="3502a-140">Various techniques can be used to optimize rendering when using z-buffers.</span></span> <span data-ttu-id="3502a-141">Anwendungen können die Leistung bei der Verwendung von Z-Puffern und Texturen verbessern, indem Sie dafür sorgen, dass die Szenen von vorne nach hinten gerendert werden.</span><span class="sxs-lookup"><span data-stu-id="3502a-141">Applications can increase performance when using z-buffering and texturing by ensuring that scenes are rendered from front to back.</span></span> <span data-ttu-id="3502a-142">Texturierte, Z-gepuffert Primitiven werden auf Basis von Scan-Linien gegen den Z-Puffer vorgetestet.</span><span class="sxs-lookup"><span data-stu-id="3502a-142">Textured z-buffered primitives are pretested against the z-buffer on a scan line basis.</span></span> <span data-ttu-id="3502a-143">Wenn eine Scan-Linie von einem zuvor gerenderten Polygon verdeckt wird, verwirft das System diese schnell und effizient.</span><span class="sxs-lookup"><span data-stu-id="3502a-143">If a scan line is hidden by a previously rendered polygon, the system rejects it quickly and efficiently.</span></span> <span data-ttu-id="3502a-144">Z-Puffer können die Leistung verbessern. Die Technik ist dann besonders hilfreich, wenn in einer eine Szene Pixel mehrmals gezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="3502a-144">Z-buffering can improve performance, but the technique is most useful when a scene draws the same pixels more than once.</span></span> <span data-ttu-id="3502a-145">Der exakte Leistungsgewinn kann nur schwer berechnet werden. Häufig können Sie jedoch einen Näherungswert bestimmen.</span><span class="sxs-lookup"><span data-stu-id="3502a-145">This is difficult to calculate exactly, but you can often make a close approximation.</span></span> <span data-ttu-id="3502a-146">Wenn ein Pixel weniger als zweimal gezeichnet wird, erreichen Sie mit der Deaktivierung der Z Pufferung und dem Rendern der Szene von vorne nach hinten die beste Leistung.</span><span class="sxs-lookup"><span data-stu-id="3502a-146">If the same pixels are drawn less than twice, you can achieve the best performance by turning z-buffering off and rendering the scene from back to front.</span></span>

<span data-ttu-id="3502a-147">Die tatsächlichen Interpretation eines Tiefenwerts ist je nach Renderer unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="3502a-147">The actual interpretation of a depth value is specific to the renderer.</span></span>

## <a name="span-idrelated-topicsspanrelated-topics"></a><span data-ttu-id="3502a-148"><span id="related-topics"></span>Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="3502a-148"><span id="related-topics"></span>Related topics</span></span>


[<span data-ttu-id="3502a-149">Tiefen- und Schablonenpuffer</span><span class="sxs-lookup"><span data-stu-id="3502a-149">Depth and stencil buffers</span></span>](depth-and-stencil-buffers.md)

 

 




