---
author: stevewhims
description: Verwenden Sie die Hintergrundübertragungs-API zum zuverlässigen Kopieren von Dateien im Netzwerk.
title: Hintergrundübertragungen
ms.assetid: 1207B089-BC16-4BF0-BBD4-FD99950C764B
ms.author: stwhi
ms.date: 03/23/2018
ms.topic: article
keywords: Windows10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: 6bc007ee1725ea3048895ccb9e7340bc0f08e8b8
ms.sourcegitcommit: 6cc275f2151f78db40c11ace381ee2d35f0155f9
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/26/2018
ms.locfileid: "5552374"
---
# <a name="background-transfers"></a><span data-ttu-id="a697a-104">Hintergrundübertragungen</span><span class="sxs-lookup"><span data-stu-id="a697a-104">Background transfers</span></span>
<span data-ttu-id="a697a-105">Verwenden Sie die Hintergrundübertragungs-API zum zuverlässigen Kopieren von Dateien im Netzwerk.</span><span class="sxs-lookup"><span data-stu-id="a697a-105">Use the background transfer API to copy files reliably over the network.</span></span> <span data-ttu-id="a697a-106">Die Hintergrundübertragungs-API bietet erweiterte Upload- und Downloadfeatures, die bei angehaltener App im Hintergrund ausgeführt werden und auch nach Beendigung der App aktiv bleiben.</span><span class="sxs-lookup"><span data-stu-id="a697a-106">The background transfer API provides advanced upload and download features that run in the background during app suspension and persist beyond app termination.</span></span> <span data-ttu-id="a697a-107">Die API überwacht den Netzwerkstatus und kann Übertragungen automatisch anhalten und fortsetzen, wenn die Verbindung unterbrochen wird. Übertragungen sind außerdem akkuabhängig – die Downloadaktivität wird also basierend auf dem aktuellen Verbindungs- und Geräteakkustatus angepasst.</span><span class="sxs-lookup"><span data-stu-id="a697a-107">The API monitors network status and automatically suspends and resumes transfers when connectivity is lost, and transfers are also Data Sense-aware and Battery Sense-aware, meaning that download activity adjusts based on your current connectivity and device battery status.</span></span> <span data-ttu-id="a697a-108">Die API ist ideal für das Hoch- und Herunterladen von großen Dateien über HTTP(S) geeignet.</span><span class="sxs-lookup"><span data-stu-id="a697a-108">The API is ideal for uploading and downloading large files using HTTP(S).</span></span> <span data-ttu-id="a697a-109">FTP wird auch unterstützt, allerdings nur für Downloads.</span><span class="sxs-lookup"><span data-stu-id="a697a-109">FTP is also supported, but only for downloads.</span></span>

<span data-ttu-id="a697a-110">Hintergrundübertragungen werden getrennt von der aufrufenden App ausgeführt und wurden hauptsächlich für lange Übertragungen von Ressourcen wie Videos, Musik und großen Bildern entwickelt.</span><span class="sxs-lookup"><span data-stu-id="a697a-110">Background Transfer runs separately from the calling app and is primarily designed for long-term transfer operations for resources like video, music, and large images.</span></span> <span data-ttu-id="a697a-111">Für diese Szenarien ist die Verwendung der Hintergrundübertragung unverzichtbar, da Downloads im Hintergrund fortgesetzt werden– selbst dann, wenn die App angehalten wurde.</span><span class="sxs-lookup"><span data-stu-id="a697a-111">For these scenarios, using Background Transfer is essential because downloads continue to progress even when the app is suspended.</span></span>

<span data-ttu-id="a697a-112">Wenn Sie kleine Ressourcen herunterladen, deren Download in der Regel schnell abgeschlossen ist, sollten Sie anstelle der Hintergrundübertragung [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639)-APIs verwenden.</span><span class="sxs-lookup"><span data-stu-id="a697a-112">If you are downloading small resources that are likely to complete quickly, you should use [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639) APIs instead of Background Transfer.</span></span>

## <a name="using-windowsnetworkingbackgroundtransfer"></a><span data-ttu-id="a697a-113">Verwenden von Windows.Networking.BackgroundTransfer</span><span class="sxs-lookup"><span data-stu-id="a697a-113">Using Windows.Networking.BackgroundTransfer</span></span>

### <a name="how-does-the-background-transfer-feature-work"></a><span data-ttu-id="a697a-114">Wie funktioniert das Feature für die Hintergrundübertragung?</span><span class="sxs-lookup"><span data-stu-id="a697a-114">How does the Background Transfer feature work?</span></span>
<span data-ttu-id="a697a-115">Wenn eine App die Hintergrundübertragung verwendet, um eine Übertragung zu initiieren, wird die Anforderung mithilfe des Klassenobjekts [**BackgroundDownloader**](https://msdn.microsoft.com/library/windows/apps/br207126) oder [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140) konfiguriert und initialisiert.</span><span class="sxs-lookup"><span data-stu-id="a697a-115">When an app uses Background Transfer to initiate a transfer, the request is configured and initialized using [**BackgroundDownloader**](https://msdn.microsoft.com/library/windows/apps/br207126) or [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140) class objects.</span></span> <span data-ttu-id="a697a-116">Alle Übertragungsvorgänge werden vom System einzeln und getrennt von der aufrufenden App behandelt.</span><span class="sxs-lookup"><span data-stu-id="a697a-116">Each transfer operation is handled individually by the system and separate from the calling app.</span></span> <span data-ttu-id="a697a-117">Statusinformationen sind verfügbar, falls Sie den Benutzer in der Benutzeroberfläche Ihrer App über den Status informieren möchten. Zudem kann Ihre App während der Übertragung angehalten, fortgesetzt und abgebrochen werden oder sogar die Daten lesen.</span><span class="sxs-lookup"><span data-stu-id="a697a-117">Progress information is available if you want to give status to the user in your app's UI, and your app can pause, resume, cancel, or even read from the data while the transfer is occurring.</span></span> <span data-ttu-id="a697a-118">Die Behandlung von Übertragungen durch das System unterstützt den intelligenten Stromverbrauch und verhindert Probleme, die entstehen können, wenn bei einer verbundenen App Ereignisse wie das Anhalten der App, das Beenden der App oder plötzliche Änderungen des Netzwerkstatus auftreten.</span><span class="sxs-lookup"><span data-stu-id="a697a-118">The way transfers are handled by the system promotes smart power usage and prevents problems that can arise when a connected app encounters events such as app suspension, termination, or sudden network status changes.</span></span>

> [!NOTE]
> <span data-ttu-id="a697a-119">Aufgrund von Ressourcenbeschränkungen pro App sollte eine App nicht mehr als 200 Übertragungen (DownloadOperations + UploadOperations) zu einem bestimmten Zeitpunkt verfügen.</span><span class="sxs-lookup"><span data-stu-id="a697a-119">Due to per-app resource constraints, an app should not have more than 200 transfers (DownloadOperations + UploadOperations) at any given time.</span></span> <span data-ttu-id="a697a-120">Dieses Limit zu überschreiten kann die App-Übertragungswarteschlange in einen nicht wiederherstellbaren Zustand lassen.</span><span class="sxs-lookup"><span data-stu-id="a697a-120">Exceeding that limit may leave the app’s transfer queue in an unrecoverable state.</span></span>

<span data-ttu-id="a697a-121">Wenn eine Anwendung gestartet wird, muss er [**AttachAsync**](/uwp/api/windows.networking.backgroundtransfer.downloadoperation.AttachAsync) für alle vorhandenen [**DownloadOperation**](/uwp/api/windows.networking.backgroundtransfer.downloadoperation?branch=live) und [**UploadOperation**](/uwp/api/windows.networking.backgroundtransfer.uploadperation?branch=live) Objekte aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a697a-121">When an application is launched, it must call [**AttachAsync**](/uwp/api/windows.networking.backgroundtransfer.downloadoperation.AttachAsync) on all existing [**DownloadOperation**](/uwp/api/windows.networking.backgroundtransfer.downloadoperation?branch=live) and [**UploadOperation**](/uwp/api/windows.networking.backgroundtransfer.uploadperation?branch=live) objects.</span></span> <span data-ttu-id="a697a-122">Nicht auf diese Weise bewirkt, dass den Verlust von Übermittlungen bereits abgeschlossen und schließlich rendert die Verwendung des Features Hintergrundübertragung nutzlos.</span><span class="sxs-lookup"><span data-stu-id="a697a-122">Not doing this will cause the leak of already-completed transfers and will eventually render your use of the Background Transfer feature useless.</span></span>

### <a name="performing-authenticated-file-requests-with-background-transfer"></a><span data-ttu-id="a697a-123">Durchführen authentifizierter Dateianforderungen mit Hintergrundübertragung</span><span class="sxs-lookup"><span data-stu-id="a697a-123">Performing authenticated file requests with Background Transfer</span></span>
<span data-ttu-id="a697a-124">Das Feature für die Hintergrundübertragung stellt Methoden bereit, die allgemeine Server- und Proxyanmeldeinformationen, Cookies sowie die Verwendung von benutzerdefinierten HTTP-Headern (mithilfe von [**SetRequestHeader**](https://msdn.microsoft.com/library/windows/apps/br207146)) für einzelne Übertragungen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="a697a-124">Background Transfer provides methods that support basic server and proxy credentials, cookies, and the use of custom HTTP headers (via [**SetRequestHeader**](https://msdn.microsoft.com/library/windows/apps/br207146)) for each transfer operation.</span></span>

### <a name="how-does-this-feature-adapt-to-network-status-changes-or-unexpected-shutdowns"></a><span data-ttu-id="a697a-125">Wie reagiert dieses Feature bei Netzwerkstatusänderungen und unerwartetem Herunterfahren?</span><span class="sxs-lookup"><span data-stu-id="a697a-125">How does this feature adapt to network status changes or unexpected shutdowns?</span></span>
<span data-ttu-id="a697a-126">Das Feature für die Hintergrundübertragung bewahrt die Einheitlichkeit der einzelnen Übertragungen, wenn sich der Netzwerkstatus ändert. Hierzu werden die vom Feature für die [Konnektivität](https://msdn.microsoft.com/library/windows/apps/hh452990) bereitgestellten Statusinformationen zur Konnektivität und zum Status des Datentarifs des Netzbetreibers intelligent genutzt.</span><span class="sxs-lookup"><span data-stu-id="a697a-126">The Background Transfer feature maintains a consistent experience for each transfer operation when network status changes occur, by intelligently leveraging connectivity and carrier data-plan status information provided by the [Connectivity](https://msdn.microsoft.com/library/windows/apps/hh452990) feature.</span></span> <span data-ttu-id="a697a-127">Um das Verhalten für unterschiedliche Netzwerkszenarien zu definieren, legt eine App mithilfe der von [**BackgroundTransferCostPolicy**](https://msdn.microsoft.com/library/windows/apps/br207138) definierten Werte eine Kostenrichtlinie für die einzelnen Übertragungen fest.</span><span class="sxs-lookup"><span data-stu-id="a697a-127">To define behavior for different network scenarios, an app sets a cost policy for each operation using values defined by [**BackgroundTransferCostPolicy**](https://msdn.microsoft.com/library/windows/apps/br207138).</span></span>

<span data-ttu-id="a697a-128">Beispielsweise kann die für einen Vorgang definierte Kostenrichtlinie vorsehen, dass der Vorgang automatisch angehalten wird, wenn das Gerät in einem getakteten Netzwerk verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-128">For example, the cost policy defined for an operation can indicate that the operation should be paused automatically when the device is using a metered network.</span></span> <span data-ttu-id="a697a-129">Die Übertragung wird automatisch fortgesetzt (oder erneut gestartet), wenn eine Verbindung mit einem „uneingeschränkten“ Netzwerk hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-129">The transfer is then automatically resumed (or restarted) when a connection to an "unrestricted" network has been established.</span></span> <span data-ttu-id="a697a-130">Weitere Informationen zur Definition von Netzwerken durch Kosten finden Sie unter [**NetworkCostType**](https://msdn.microsoft.com/library/windows/apps/br207292).</span><span class="sxs-lookup"><span data-stu-id="a697a-130">For more information on how networks are defined by cost, see [**NetworkCostType**](https://msdn.microsoft.com/library/windows/apps/br207292).</span></span>

<span data-ttu-id="a697a-131">Obwohl das Feature für die Hintergrundübertragung über eigene Mechanismen zur Behandlung von Netzwerkstatusänderungen verfügt, müssen bei mit einem Netzwerk verbundenen Apps einige allgemeine Punkte im Zusammenhang mit der Konnektivität beachtet werden.</span><span class="sxs-lookup"><span data-stu-id="a697a-131">While the Background Transfer feature has its own mechanisms for handling network status changes, there are other general connectivity considerations for network-connected apps.</span></span> <span data-ttu-id="a697a-132">Weitere Informationen finden Sie unter [Zugreifen auf den Netzwerkverbindungsstatus und Verwalten von Netzwerkkosten (HTML)](https://msdn.microsoft.com/library/windows/apps/hh452983).</span><span class="sxs-lookup"><span data-stu-id="a697a-132">Read [Leveraging available network connection information](https://msdn.microsoft.com/library/windows/apps/hh452983) for additional info.</span></span>

> <span data-ttu-id="a697a-133">**Hinweis:** für apps, die auf mobilen Geräten ausgeführt werden, gibt es Features, die dem Benutzer ermöglichen, überwachen und Einschränken der Menge an Daten, die übertragen wird basierend auf dem Typ der Verbindung, roaming Status, und die Daten des Benutzers zu planen.</span><span class="sxs-lookup"><span data-stu-id="a697a-133">**Note**For apps running on mobile devices, there are features that allow the user to monitor and restrict the amount of data that is transferred based on the type of connection, roaming status, and the user's data plan.</span></span> <span data-ttu-id="a697a-134">Aus diesem Grund können Hintergrundübertragungen auf dem Telefon auch dann angehalten werden, wenn die Übertragung gemäß dem [**BackgroundTransferCostPolicy**](https://msdn.microsoft.com/library/windows/apps/br207138)-Wert fortgesetzt werden sollte.</span><span class="sxs-lookup"><span data-stu-id="a697a-134">Because of this, background transfers may be paused on the phone even when the [**BackgroundTransferCostPolicy**](https://msdn.microsoft.com/library/windows/apps/br207138) indicates that the transfer should proceed.</span></span>

<span data-ttu-id="a697a-135">Die folgende Tabelle zeigt für jeden [**BackgroundTransferCostPolicy**](https://msdn.microsoft.com/library/windows/apps/br207138)-Wert, wann Hintergrundübertragungen basierend auf dem aktuellen Status des Telefons zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="a697a-135">The following table indicates when background transfers are allowed on the phone for each [**BackgroundTransferCostPolicy**](https://msdn.microsoft.com/library/windows/apps/br207138) value, given the current state of the phone.</span></span> <span data-ttu-id="a697a-136">Sie können den aktuellen Status des Telefons auch mithilfe der [**ConnectionCost**](https://msdn.microsoft.com/library/windows/apps/br207244)-Klasse ermitteln.</span><span class="sxs-lookup"><span data-stu-id="a697a-136">You can use the [**ConnectionCost**](https://msdn.microsoft.com/library/windows/apps/br207244) class to determine the phone's current state.</span></span>

| <span data-ttu-id="a697a-137">Gerätestatus</span><span class="sxs-lookup"><span data-stu-id="a697a-137">Device State</span></span>                                                                                                                      | <span data-ttu-id="a697a-138">UnrestrictedOnly</span><span class="sxs-lookup"><span data-stu-id="a697a-138">UnrestrictedOnly</span></span> | <span data-ttu-id="a697a-139">Standard</span><span class="sxs-lookup"><span data-stu-id="a697a-139">Default</span></span> | <span data-ttu-id="a697a-140">Always</span><span class="sxs-lookup"><span data-stu-id="a697a-140">Always</span></span> |
|-----------------------------------------------------------------------------------------------------------------------------------|------------------|---------|--------|
| <span data-ttu-id="a697a-141">Mit WLAN verbunden</span><span class="sxs-lookup"><span data-stu-id="a697a-141">Connected to WiFi</span></span>                                                                                                                 | <span data-ttu-id="a697a-142">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-142">Allow</span></span>            | <span data-ttu-id="a697a-143">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-143">Allow</span></span>   | <span data-ttu-id="a697a-144">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-144">Allow</span></span>  |
| <span data-ttu-id="a697a-145">Getaktete Verbindung, kein Roaming, unter dem Datenlimit, Überschreitung des Limits nicht zu erwarten</span><span class="sxs-lookup"><span data-stu-id="a697a-145">Metered Connection, not roaming, under data limit, on track to stay under limit</span></span>                                                   | <span data-ttu-id="a697a-146">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-146">Deny</span></span>             | <span data-ttu-id="a697a-147">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-147">Allow</span></span>   | <span data-ttu-id="a697a-148">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-148">Allow</span></span>  |
| <span data-ttu-id="a697a-149">Getaktete Verbindung, kein Roaming, unter dem Datenlimit, Überschreitung des Limits zu erwarten</span><span class="sxs-lookup"><span data-stu-id="a697a-149">Metered Connection, not roaming, under data limit, on track to exceed limit</span></span>                                                       | <span data-ttu-id="a697a-150">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-150">Deny</span></span>             | <span data-ttu-id="a697a-151">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-151">Deny</span></span>    | <span data-ttu-id="a697a-152">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-152">Allow</span></span>  |
| <span data-ttu-id="a697a-153">Getaktete Verbindung, Roaming, unter dem Datenlimit</span><span class="sxs-lookup"><span data-stu-id="a697a-153">Metered Connection, roaming, under data limit</span></span>                                                                                     | <span data-ttu-id="a697a-154">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-154">Deny</span></span>             | <span data-ttu-id="a697a-155">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-155">Deny</span></span>    | <span data-ttu-id="a697a-156">Zulassen</span><span class="sxs-lookup"><span data-stu-id="a697a-156">Allow</span></span>  |
| <span data-ttu-id="a697a-157">Getaktete Verbindung, Roaming, über dem Datenlimit.</span><span class="sxs-lookup"><span data-stu-id="a697a-157">Metered Connection, over data limit.</span></span> <span data-ttu-id="a697a-158">Dieser Status tritt nur auf, wenn der Benutzer in der Data Sense-Benutzeroberfläche die Option „Datennutzung im Hintergrund einschränken“ aktiviert.</span><span class="sxs-lookup"><span data-stu-id="a697a-158">This state only occurs when the user enables "Restrict background data in the Data Sense UI.</span></span> | <span data-ttu-id="a697a-159">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-159">Deny</span></span>             | <span data-ttu-id="a697a-160">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-160">Deny</span></span>    | <span data-ttu-id="a697a-161">Verweigern</span><span class="sxs-lookup"><span data-stu-id="a697a-161">Deny</span></span>   |

## <a name="uploading-files"></a><span data-ttu-id="a697a-162">Hochladen von Dateien</span><span class="sxs-lookup"><span data-stu-id="a697a-162">Uploading files</span></span>
<span data-ttu-id="a697a-163">Bei der Hintergrundübertragung erfolgt der Upload als [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224). Dabei wird eine Reihe von Steuerungsmethoden zum Neustarten oder Abbrechen des Vorgangs verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="a697a-163">When using Background Transfer an upload exists as an [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) that exposes a number of control methods that are used to restart or cancel the operation.</span></span> <span data-ttu-id="a697a-164">App-Ereignisse (z.B. Anhalten oder Beenden) und Konnektivitätsänderungen werden vom System automatisch durch **UploadOperation** behandelt. Uploads werden bei Anhalten oder Unterbrechen einer App und auch nach dem Beenden der App fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="a697a-164">App events (e.g. suspension or termination) and connectivity changes are handled automatically by the system per **UploadOperation**; uploads will continue during app suspension periods or pause and persist beyond app termination.</span></span> <span data-ttu-id="a697a-165">Außerdem wird durch Festlegen der [**CostPolicy**](https://msdn.microsoft.com/library/windows/apps/hh701018)-Eigenschaft angegeben, ob die App Uploads startet, wenn für die Internetkonnektivität ein getaktetes Netzwerk verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-165">Additionally, setting the [**CostPolicy**](https://msdn.microsoft.com/library/windows/apps/hh701018) property will indicate whether or not your app will start uploads while a metered network is being used for Internet connectivity.</span></span>

<span data-ttu-id="a697a-166">In den folgenden Beispielen werden die Erstellung und Initialisierung eines einfachen Uploads sowie das Aufzählen und Fortsetzen von in einer vorherigen App-Sitzung gespeicherten Vorgängen erläutert.</span><span class="sxs-lookup"><span data-stu-id="a697a-166">The following examples will walk you through the creation and initialization of a basic upload and how to enumerate and reintroduce operations persisted from a previous app session.</span></span>

### <a name="uploading-a-single-file"></a><span data-ttu-id="a697a-167">Hochladen einer Datei</span><span class="sxs-lookup"><span data-stu-id="a697a-167">Uploading a single file</span></span>
<span data-ttu-id="a697a-168">Die Erstellung eines Uploads beginnt mit [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140).</span><span class="sxs-lookup"><span data-stu-id="a697a-168">The creation of an upload begins with [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140).</span></span> <span data-ttu-id="a697a-169">Mit dieser Klasse werden die Methoden bereitgestellt, womit die App den Upload konfigurieren kann, bevor die resultierende [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224)-Instanz erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-169">This class is used to provide the methods that enable your app to configure the upload before creating the resultant [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224).</span></span> <span data-ttu-id="a697a-170">Im folgenden Beispiel wird gezeigt, wie dies mit den erforderlichen [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) und [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171)-Objekten gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-170">The following example shows how to do this with the required [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) and [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) objects.</span></span>

**<span data-ttu-id="a697a-171">Identifizieren der Datei und des Ziels für den Upload</span><span class="sxs-lookup"><span data-stu-id="a697a-171">Identify the file and destination for the upload</span></span>**

<span data-ttu-id="a697a-172">Vor dem Erstellen einer [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) müssen wir den URI des Speicherorts für den Upload und die hochzuladende Datei bestimmen.</span><span class="sxs-lookup"><span data-stu-id="a697a-172">Before we can begin with the creation of an [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224), we first need to identify the URI of the location to upload to, and the file that will be uploaded.</span></span> <span data-ttu-id="a697a-173">Im folgenden Beispiel wird der *uriString*-Wert mit einer Zeichenfolge aus der Benutzeroberflächeneingabe und der *file*-Wert mit dem [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171)-Objekt gefüllt, das von einem [**PickSingleFileAsync**](https://msdn.microsoft.com/library/windows/apps/jj635275)-Vorgang zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-173">In the following example, the *uriString* value is populated using a string from UI input, and the *file* value using the [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object returned by a [**PickSingleFileAsync**](https://msdn.microsoft.com/library/windows/apps/jj635275) operation.</span></span>

[!code-js[uploadFile](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_B "Identify the file and destination for the upload")]

**<span data-ttu-id="a697a-174">Erstellen und Initialisieren des Uploadvorgangs</span><span class="sxs-lookup"><span data-stu-id="a697a-174">Create and initialize the upload operation</span></span>**

<span data-ttu-id="a697a-175">Im vorherigen Schritt wurden die Werte *uriString* und *file* an eine Instanz von „UploadOp“ aus dem nächsten Beispiel übergeben. Dort werden sie zum Konfigurieren und Starten des neuen Uploadvorgangs verwendet.</span><span class="sxs-lookup"><span data-stu-id="a697a-175">In the previous step the *uriString* and *file* values are passed to an instance of our next example, UploadOp, where they are used to configure and start the new upload operation.</span></span> <span data-ttu-id="a697a-176">Zunächst wird *uriString* analysiert, um das erforderliche [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998)-Objekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a697a-176">First, *uriString* is parsed to create the required [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) object.</span></span>

<span data-ttu-id="a697a-177">Dann verwendet [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140) die Eigenschaften der bereitgestellten [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171)-Klasse (*file*) zum Füllen des Anforderungsheaders und Festlegen der *SourceFile*-Eigenschaft mit dem **StorageFile**-Objekt.</span><span class="sxs-lookup"><span data-stu-id="a697a-177">Next, the properties of the provided [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) (*file*) are used by [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140) to populate the request header and set the *SourceFile* property with the **StorageFile** object.</span></span> <span data-ttu-id="a697a-178">Anschließend wird die [**SetRequestHeader**](https://msdn.microsoft.com/library/windows/apps/br207146)-Methode aufgerufen, um den als Zeichenfolge bereitgestellten Dateinamen und die [**StorageFile.Name**](https://msdn.microsoft.com/library/windows/apps/br227220)-Eigenschaft einzufügen.</span><span class="sxs-lookup"><span data-stu-id="a697a-178">The [**SetRequestHeader**](https://msdn.microsoft.com/library/windows/apps/br207146) method is then called to insert the file name, provided as a string, and the [**StorageFile.Name**](https://msdn.microsoft.com/library/windows/apps/br227220) property.</span></span>

<span data-ttu-id="a697a-179">Schließlich erstellt [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140) die [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224)-Klasse (*upload*).</span><span class="sxs-lookup"><span data-stu-id="a697a-179">Finally, [**BackgroundUploader**](https://msdn.microsoft.com/library/windows/apps/br207140) creates the [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) (*upload*).</span></span>

[!code-js[uploadFile](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_A "Create and initialize the upload operation")]

<span data-ttu-id="a697a-180">Beachten Sie die asynchronen Methodenaufrufe, die mit JavaScript-Zusagen definiert sind.</span><span class="sxs-lookup"><span data-stu-id="a697a-180">Note the asynchronous method calls defined using JavaScript promises.</span></span> <span data-ttu-id="a697a-181">Sehen Sie sich die folgende Zeile aus dem letzten Beispiel an:</span><span class="sxs-lookup"><span data-stu-id="a697a-181">Looking at a line from the last example:</span></span>

```javascript
promise = upload.startAsync().then(complete, error, progress);
```

<span data-ttu-id="a697a-182">Nach dem Async-Methodenaufruf folgt eine then-Anweisung, die von der App definierte Methoden angibt, die aufgerufen werden, wenn ein Ergebnis aus dem Async-Methodenaufruf zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-182">The async method call is followed by a then statement which indicates methods, defined by the app, that are called when a result from the async method call is returned.</span></span> <span data-ttu-id="a697a-183">Weitere Informationen zu diesem Programmierungsmuster finden Sie unter [Asynchrone Programmierung in JavaScript mit Zusagen](http://msdn.microsoft.com/library/windows/apps/hh464930.aspx).</span><span class="sxs-lookup"><span data-stu-id="a697a-183">For more information on this programming pattern, see [Asynchronous programming in JavaScript using promises](http://msdn.microsoft.com/library/windows/apps/hh464930.aspx).</span></span>

### <a name="uploading-multiple-files"></a><span data-ttu-id="a697a-184">Hochladen mehrerer Dateien</span><span class="sxs-lookup"><span data-stu-id="a697a-184">Uploading multiple files</span></span>
**<span data-ttu-id="a697a-185">Identifizieren der Dateien und des Ziels für den Upload</span><span class="sxs-lookup"><span data-stu-id="a697a-185">Identify the files and destination for the upload</span></span>**

<span data-ttu-id="a697a-186">In einem Szenario, in dem mehrere Dateien mit einer einzelnen [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) übertragen werden, beginnt der Vorgang wie üblich mit der Angabe des erforderlichen Ziel-URI und der lokalen Dateiinformationen.</span><span class="sxs-lookup"><span data-stu-id="a697a-186">In a scenario involving multiple files transferred with a single [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224), the process begins as it usually does by first providing the required destination URI and local file information.</span></span> <span data-ttu-id="a697a-187">Ähnlich wie in dem Beispiel im vorherigen Abschnitt wird der URI als Zeichenfolge vom Endbenutzer angegeben, und mit [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) kann auch das Auswählen von Dateien über die Benutzeroberfläche ermöglicht werden.</span><span class="sxs-lookup"><span data-stu-id="a697a-187">Similar to the example in the previous section, the URI is provided as a string by the end-user and [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) can be used to provide the ability to indicate files through the user interface as well.</span></span> <span data-ttu-id="a697a-188">In diesem Szenario muss die App allerdings stattdessen die [**PickMultipleFilesAsync**](https://msdn.microsoft.com/library/windows/apps/br207851)-Methode aufrufen, um die Auswahl mehrerer Dateien über die Benutzeroberfläche zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="a697a-188">However, in this scenario the app should instead call the [**PickMultipleFilesAsync**](https://msdn.microsoft.com/library/windows/apps/br207851) method to enable the selection of multiple files through the UI.</span></span>

```javascript
function uploadFiles() {
       var filePicker = new Windows.Storage.Pickers.FileOpenPicker();
       filePicker.fileTypeFilter.replaceAll(["*"]);

       filePicker.pickMultipleFilesAsync().then(function (files) {
          if (files === 0) {
             printLog("No file selected");
                return;
          }

          var upload = new UploadOperation();
          var uriString = document.getElementById("serverAddressField").value;
          upload.startMultipart(uriString, files);

          // Persist the upload operation in the global array.
          uploadOperations.push(upload);
       });
    }
```

**<span data-ttu-id="a697a-189">Erstellen von Objekten für die verfügbaren Parameter</span><span class="sxs-lookup"><span data-stu-id="a697a-189">Create objects for the provided parameters</span></span>**

<span data-ttu-id="a697a-190">In den nächsten beiden Beispielen wird Code in einer Beispielmethode namens **startMultipart** verwendet, die am Ende des letzten Schritts aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="a697a-190">The next two examples use code contained in a single example method, **startMultipart**, which was called at the end of the last step.</span></span> <span data-ttu-id="a697a-191">Für diese Anleitung wurde der Code in der Methode, der ein Array mit [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029)-Objekten erstellt, von dem Code getrennt, der die resultierende [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) erstellt.</span><span class="sxs-lookup"><span data-stu-id="a697a-191">For the purpose of instruction the code in the method that creates an array of [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029) objects has been split from the code that creates the resultant [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224).</span></span>

<span data-ttu-id="a697a-192">Zuerst wird die vom Benutzer angegebene URI-Zeichenfolge als [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) initialisiert.</span><span class="sxs-lookup"><span data-stu-id="a697a-192">First, the URI string provided by the user is initialized as a [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998).</span></span> <span data-ttu-id="a697a-193">Danach wird das Array mit [**IStorageFile**](https://msdn.microsoft.com/library/windows/apps/br227102)-Objekten (**files**) durchlaufen, die an diese Methode übergeben wurden, und auf der Grundlage der einzelnen Objekte wird jeweils ein neues [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029)-Objekt erstellt und anschließend im **contentParts**-Array platziert.</span><span class="sxs-lookup"><span data-stu-id="a697a-193">Next, the array of [**IStorageFile**](https://msdn.microsoft.com/library/windows/apps/br227102) objects (**files**) passed to this method is iterated through, each object is used to create a new [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029) object which is then placed in the **contentParts** array.</span></span>

```javascript
    upload.startMultipart = function (uriString, files) {
        try {
            var uri = new Windows.Foundation.Uri(uriString);
            var uploader = new Windows.Networking.BackgroundTransfer.BackgroundUploader();

            var contentParts = [];
            files.forEach(function (file, index) {
                var part = new Windows.Networking.BackgroundTransfer.BackgroundTransferContentPart("File" + index, file.name);
                part.setFile(file);
                contentParts.push(part);
            });
```

**<span data-ttu-id="a697a-194">Erstellen und Initialisieren des mehrteiligen Uploadvorgangs</span><span class="sxs-lookup"><span data-stu-id="a697a-194">Create and initialize the multi-part upload operation</span></span>**

<span data-ttu-id="a697a-195">Nachdem das contentParts-Array mit allen [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029)-Objekten aufgefüllt wurde, die jeweils eine [**IStorageFile**](https://msdn.microsoft.com/library/windows/apps/br227102) zum Hochladen darstellen, kann [**CreateUploadAsync**](https://msdn.microsoft.com/library/windows/apps/hh923973) mit dem [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) aufgerufen werden, um das Ziel für die Anforderung anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a697a-195">With our contentParts array populated with all of the [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029) objects representing each [**IStorageFile**](https://msdn.microsoft.com/library/windows/apps/br227102) for upload, we are ready to call [**CreateUploadAsync**](https://msdn.microsoft.com/library/windows/apps/hh923973) using the [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) to indicate where the request will be sent.</span></span>

```javascript
        // Create a new upload operation.
            uploader.createUploadAsync(uri, contentParts).then(function (uploadOperation) {

               // Start the upload and persist the promise to be able to cancel the upload.
               upload = uploadOperation;
               promise = uploadOperation.startAsync().then(complete, error, progress);
            });

         } catch (err) {
             displayError(err);
         }
     };
```

### <a name="restarting-interrupted-upload-operations"></a><span data-ttu-id="a697a-196">Neustarten von unterbrochenen Uploadvorgängen</span><span class="sxs-lookup"><span data-stu-id="a697a-196">Restarting interrupted upload operations</span></span>
<span data-ttu-id="a697a-197">Bei Abschluss oder Abbruch von [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) werden alle zugeordneten Systemressourcen freigegeben.</span><span class="sxs-lookup"><span data-stu-id="a697a-197">On completion or cancellation of an [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224), any associated system resources are released.</span></span> <span data-ttu-id="a697a-198">Wenn die App allerdings vor Auftreten eines dieser Ereignisse beendet wird, werden aktive Vorgänge angehalten, und die ihnen zugeordneten Ressourcen bleiben belegt.</span><span class="sxs-lookup"><span data-stu-id="a697a-198">However, if your app is terminated before either of these things can occur, any active operations are paused and the resources associated with each remain occupied.</span></span> <span data-ttu-id="a697a-199">Wenn diese Vorgänge nicht in der nächsten App-Sitzung aufgezählt und fortgesetzt werden, werden sie nicht abgeschlossen und belegen weiterhin Geräteressourcen.</span><span class="sxs-lookup"><span data-stu-id="a697a-199">If these operations are not enumerated and re-introduced to the next app session, they will not be completed and will continue to occupy device resources.</span></span>

1.  <span data-ttu-id="a697a-200">Bevor Sie die Funktion zum Aufzählen beibehaltener Vorgänge definieren, müssen wir ein Array erstellen, das die zurückzugebenden [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224)-Objekte enthält:</span><span class="sxs-lookup"><span data-stu-id="a697a-200">Before defining the function that enumerates persisted operations, we need to create an array that will contain the [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) objects that it will return:</span></span>

    [!code-js[uploadFile](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_C "Restart interrupted upload operation")]

1.  <span data-ttu-id="a697a-201">Im nächsten Schritt definieren Sie die Funktion, die alle beibehaltenen Vorgänge aufzählt und im Array speichert.</span><span class="sxs-lookup"><span data-stu-id="a697a-201">Next we define the function that enumerates persisted operations and stores them in our array.</span></span> <span data-ttu-id="a697a-202">Die **load**-Methode, die zum Neuzuweisen der Rückrufe von [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224) aufgerufen wird, wenn der Download nach Beendigung der App fortgesetzt wird, befindet sich in der UploadOp-Klasse, die Sie weiter unten in diesem Abschnitt definieren.</span><span class="sxs-lookup"><span data-stu-id="a697a-202">Note that the **load** method called to re-assign callbacks to the [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224), should it persist through app termination, is in the UploadOp class we define later in this section.</span></span>

    [!code-js[uploadFile](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_D "Enumerate persisted operations")]

## <a name="downloading-files"></a><span data-ttu-id="a697a-203">Herunterladen von Dateien</span><span class="sxs-lookup"><span data-stu-id="a697a-203">Downloading files</span></span>
<span data-ttu-id="a697a-204">Bei der Hintergrundübertragung erfolgt jeder Download als [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154). Dabei werden eine Reihe von Steuerungsmethoden zum Anhalten, Fortsetzen, Neustarten und Abbrechen des Vorgangs verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="a697a-204">When using Background Transfer, each download exists as a [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) that exposes a number of control methods used to pause, resume, restart, and cancel the operation.</span></span> <span data-ttu-id="a697a-205">App-Ereignisse (z.B. Anhalten oder Beenden) und Konnektivitätsänderungen werden vom System automatisch durch **DownloadOperation** behandelt. Downloads werden bei Anhalten oder Unterbrechen einer App und auch nach dem Beenden der App fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="a697a-205">App events (e.g. suspension or termination) and connectivity changes are handled automatically by the system per **DownloadOperation**; downloads will continue during app suspension periods or pause and persist beyond app termination.</span></span> <span data-ttu-id="a697a-206">In Szenarien für mobile Netzwerke wird außerdem durch Festlegen der [**CostPolicy**](https://msdn.microsoft.com/library/windows/apps/hh701018)-Eigenschaft angegeben, ob die App Downloads startet oder fortsetzt, wenn für die Internetkonnektivität ein getaktetes Netzwerk verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-206">For mobile network scenarios, setting the [**CostPolicy**](https://msdn.microsoft.com/library/windows/apps/hh701018) property will indicate whether or not your app will begin or continue downloads while a metered network is being used for Internet connectivity.</span></span>

<span data-ttu-id="a697a-207">Wenn Sie kleine Ressourcen herunterladen, deren Download in der Regel schnell abgeschlossen ist, sollten Sie anstelle der Hintergrundübertragung [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639)-APIs verwenden.</span><span class="sxs-lookup"><span data-stu-id="a697a-207">If you are downloading small resources that are likely to complete quickly, you should use [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639) APIs instead of Background Transfer.</span></span>

<span data-ttu-id="a697a-208">In den folgenden Beispielen werden die Erstellung und Initialisierung eines einfachen Downloads sowie das Aufzählen und Fortsetzen von in einer vorherigen App-Sitzung gespeicherten Vorgängen erläutert.</span><span class="sxs-lookup"><span data-stu-id="a697a-208">The following examples will walk you through the creation and initialization of a basic download, and how to enumerate and reintroduce operations persisted from a previous app session.</span></span>

### <a name="configure-and-start-a-background-transfer-file-download"></a><span data-ttu-id="a697a-209">Konfigurieren und Starten eines Dateidownloads mit Hintergrundübertragung</span><span class="sxs-lookup"><span data-stu-id="a697a-209">Configure and start a Background Transfer file download</span></span>
<span data-ttu-id="a697a-210">Das folgende Beispiel veranschaulicht, wie mit Zeichenfolgen, die einen URI und einen Dateinamen darstellen, ein [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998)-Objekt und die [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) erstellt werden können, die die angeforderte Datei enthalten.</span><span class="sxs-lookup"><span data-stu-id="a697a-210">The following example demonstrates how strings representing a URI and a file name can be used to create a [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) object and the [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) that will contain the requested file.</span></span> <span data-ttu-id="a697a-211">Im Beispiel wird die neue Datei automatisch an einem vordefinierten Speicherort abgelegt.</span><span class="sxs-lookup"><span data-stu-id="a697a-211">In this example, the new file is automatically placed in a pre-defined location.</span></span> <span data-ttu-id="a697a-212">Alternativ kann Benutzern mithilfe von [**FileSavePicker**](https://msdn.microsoft.com/library/windows/apps/br207871) ermöglicht werden, den Speicherort der Datei auf dem Gerät anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a697a-212">Alternatively, [**FileSavePicker**](https://msdn.microsoft.com/library/windows/apps/br207871) can be used allow users to indicate where to save the file on the device.</span></span> <span data-ttu-id="a697a-213">Die **load**-Methode, die zum Neuzuweisen der Rückrufe von [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) aufgerufen wird, wenn der Download nach Beendigung der App fortgesetzt wird, befindet sich in der „DownloadOp“-Klasse, die Sie weiter unten in diesem Abschnitt definieren.</span><span class="sxs-lookup"><span data-stu-id="a697a-213">Note that the **load** method called to re-assign callbacks to the [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154), should it persist through app termination, is in the DownloadOp class defined later in this section.</span></span>

[!code-js[uploadFile](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_A)]

<span data-ttu-id="a697a-214">Beachten Sie die asynchronen Methodenaufrufe, die mit JavaScript-Zusagen definiert sind.</span><span class="sxs-lookup"><span data-stu-id="a697a-214">Note the asynchronous method calls defined using JavaScript promises.</span></span> <span data-ttu-id="a697a-215">Aus Zeile17 des vorherigen Codebeispiels geht Folgendes hervor:</span><span class="sxs-lookup"><span data-stu-id="a697a-215">Looking at line 17 from the previous code example:</span></span>

```javascript
promise = download.startAsync().then(complete, error, progress);
```

<span data-ttu-id="a697a-216">Nach dem Async-Methodenaufruf folgt eine then-Anweisung, die von der App definierte Methoden angibt, die aufgerufen werden, wenn ein Ergebnis aus dem Async-Methodenaufruf zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-216">The async method call is followed by a then statement which indicates methods, defined by the app, that are called when a result from the async method call is returned.</span></span> <span data-ttu-id="a697a-217">Weitere Informationen zu diesem Programmierungsmuster finden Sie unter [Asynchrone Programmierung in JavaScript mit Zusagen](http://msdn.microsoft.com/library/windows/apps/hh464930.aspx).</span><span class="sxs-lookup"><span data-stu-id="a697a-217">For more information on this programming pattern, see [Asynchronous programming in JavaScript using promises](http://msdn.microsoft.com/library/windows/apps/hh464930.aspx).</span></span>

### <a name="adding-additional-operation-control-methods"></a><span data-ttu-id="a697a-218">Hinzufügen weiterer Methoden zur Vorgangssteuerung</span><span class="sxs-lookup"><span data-stu-id="a697a-218">Adding additional operation control methods</span></span>
<span data-ttu-id="a697a-219">Der Grad der Steuerung lässt sich durch Implementieren zusätzlicher [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154)-Methoden erhöhen.</span><span class="sxs-lookup"><span data-stu-id="a697a-219">The level of control can be increased by implementing additional [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) methods.</span></span> <span data-ttu-id="a697a-220">Wenn Sie beispielsweise dem obigen Beispiel den folgenden Code hinzufügen, wird das Abbrechen des Downloads ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="a697a-220">For example, adding the following code to the example above will introduce the ability to cancel the download.</span></span>

[!code-js[uploadFile](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_B)]

### <a name="enumerating-persisted-operations-at-start-up"></a><span data-ttu-id="a697a-221">Aufzählen beibehaltener Vorgänge beim Start</span><span class="sxs-lookup"><span data-stu-id="a697a-221">Enumerating persisted operations at start-up</span></span>
<span data-ttu-id="a697a-222">Bei Abschluss oder Abbruch von [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) werden alle zugeordneten Systemressourcen freigegeben.</span><span class="sxs-lookup"><span data-stu-id="a697a-222">On completion or cancellation of a [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154), any associated system resources are released.</span></span> <span data-ttu-id="a697a-223">Wenn die App allerdings vor Auftreten eines dieser Ereignisse beendet wird, werden die Downloads angehalten und im Hintergrund beibehalten.</span><span class="sxs-lookup"><span data-stu-id="a697a-223">However, if your app is terminated before either of these events occur, downloads will pause and persist in the background.</span></span> <span data-ttu-id="a697a-224">In den folgenden Beispielen wird gezeigt, wie Sie beibehaltene Downloads in einer neuen App-Sitzung fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="a697a-224">The following examples demonstrate how to re-introduce persisted downloads into a new app session.</span></span>

1.  <span data-ttu-id="a697a-225">Bevor Sie die Funktion zum Aufzählen beibehaltener Vorgänge definieren, müssen wir ein Array erstellen, das die zurückzugebenden [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154)-Objekte enthält:</span><span class="sxs-lookup"><span data-stu-id="a697a-225">Before defining the function that enumerates persisted operations, we need to create an array that will contain the [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) objects that it will return:</span></span>

    [!code-js[uploadFile](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_D)]

1.  <span data-ttu-id="a697a-226">Im nächsten Schritt definieren Sie die Funktion, die alle beibehaltenen Vorgänge aufzählt und im Array speichert.</span><span class="sxs-lookup"><span data-stu-id="a697a-226">Next we define the function that enumerates persisted operations and stores them in our array.</span></span> <span data-ttu-id="a697a-227">Die **load**-Methode, die zum Neuzuweisen von Rückrufen für eine beibehaltene [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) aufgerufen wird, befindet sich im Beispiel für die DownloadOp-Klasse, die weiter unten in diesem Abschnitt definiert wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-227">Note that the **load** method called to re-assign callbacks for a persisted [**DownloadOperation**](https://msdn.microsoft.com/library/windows/apps/br207154) is in the DownloadOp example we define later in this section.</span></span>

    [!code-js[uploadFile](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_E)]

1.  <span data-ttu-id="a697a-228">Die mit Daten aufgefüllte Liste kann nun zum Neustarten ausstehender Vorgänge verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a697a-228">You can now use the populated list to restart pending operations.</span></span>

## <a name="post-processing"></a><span data-ttu-id="a697a-229">Nachverarbeitung</span><span class="sxs-lookup"><span data-stu-id="a697a-229">Post-processing</span></span>
<span data-ttu-id="a697a-230">Ein neues Feature in Windows 10 ist die Möglichkeit, auf den Abschluss einer hintergrundübertragung Anwendungscode auszuführen, auch wenn die app nicht ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-230">A new feature in Windows10 is the ability to run application code at the completion of a background transfer even when the app is not running.</span></span> <span data-ttu-id="a697a-231">Ihre App möchte z.B. eine Liste der verfügbaren Filme aktualisieren, nachdem ein Film heruntergeladen wurde, statt bei jedem Start nach neuen Filmen zu suchen.</span><span class="sxs-lookup"><span data-stu-id="a697a-231">For example, your app might want to update a list of available movies after a movie has finished downloading, rather than have your app scan for new movies every time it starts.</span></span> <span data-ttu-id="a697a-232">Ihre App möchte ggf. eine fehlerhafte Dateiübertragung behandeln, indem diese unter Verwendung eines anderes Servers oder Ports wiederholt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-232">Or your app might want to handle a failed file transfer by trying again using a different server or port.</span></span> <span data-ttu-id="a697a-233">Nachbearbeitung wird für erfolgreiche und nicht erfolgreiche Übertragungen aufgerufen, damit Sie sie zum Implementieren benutzerdefinierter Fehlerbehandlung und Wiederholungslogik verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a697a-233">Post-processing is invoked for both successful and failed transfers, so you can use it to implement custom error-handling and retry logic.</span></span>

<span data-ttu-id="a697a-234">Nachbearbeitung verwendet die vorhandene Hintergrundaufgaben-Infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="a697a-234">Postprocessing uses the existing background task infrastructure.</span></span> <span data-ttu-id="a697a-235">Erstellen Sie eine Hintergrundaufgabe, und ordnen Sie sie Ihren Übertragungen zu, bevor Sie die Übertragung starten.</span><span class="sxs-lookup"><span data-stu-id="a697a-235">You create a background task and associate it with your transfers before you start the transfers.</span></span> <span data-ttu-id="a697a-236">Die Übertragungen werden dann im Hintergrund ausgeführt, und wenn sie abgeschlossen sind, wird die Hintergrundaufgabe aufgerufen, um die Nachbearbeitung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="a697a-236">The transfers are then executed in the background, and when they are complete, your background task is called to perform post-processing.</span></span>

<span data-ttu-id="a697a-237">Für die Nachbearbeitung wird als neue Klasse [**BackgroundTransferCompletionGroup**](https://msdn.microsoft.com/library/windows/apps/dn804209) verwendet.</span><span class="sxs-lookup"><span data-stu-id="a697a-237">Post-processing uses a new class, [**BackgroundTransferCompletionGroup**](https://msdn.microsoft.com/library/windows/apps/dn804209).</span></span> <span data-ttu-id="a697a-238">Diese Klasse ist mit der vorhandenen [**BackgroundTransferGroup**](https://msdn.microsoft.com/library/windows/apps/dn279030)-Klasse vergleichbar, mit der Sie Hintergrundübertragungen gruppieren können. Die **BackgroundTransferCompletionGroup**-Klasse ermöglicht es jedoch zudem, eine Hintergrundaufgabe anzugeben, die nach Abschluss der Übertragung ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="a697a-238">This class is similar to the existing [**BackgroundTransferGroup**](https://msdn.microsoft.com/library/windows/apps/dn279030) in that it allows you to group background transfers together, but **BackgroundTransferCompletionGroup** adds the ability to designate a background task to be run when the transfer is complete.</span></span>

<span data-ttu-id="a697a-239">Initiieren Sie wie folgt eine Hintergrundübertragung mit Nachbearbeitung.</span><span class="sxs-lookup"><span data-stu-id="a697a-239">You initiate a background transfer with post-processing as follows.</span></span>

1.  <span data-ttu-id="a697a-240">Erstellen Sie ein [**BackgroundTransferCompletionGroup**](https://msdn.microsoft.com/library/windows/apps/dn804209)-Objekt.</span><span class="sxs-lookup"><span data-stu-id="a697a-240">Create a [**BackgroundTransferCompletionGroup**](https://msdn.microsoft.com/library/windows/apps/dn804209) object.</span></span> <span data-ttu-id="a697a-241">Erstellen Sie dann ein [**BackgroundTaskBuilder**](https://msdn.microsoft.com/library/windows/apps/br224768)-Objekt.</span><span class="sxs-lookup"><span data-stu-id="a697a-241">Then, create a [**BackgroundTaskBuilder**](https://msdn.microsoft.com/library/windows/apps/br224768) object.</span></span> <span data-ttu-id="a697a-242">Legen Sie die **Trigger**-Eigenschaft des Generator-Objekts auf das Abschlussgruppenobjekt und die **TaskEntryPoint**-Eigenschaft des Generators auf den Einstiegspunkt der Hintergrundaufgabe fest, die nach Abschluss der Übertragung ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="a697a-242">Set the **Trigger** property of the builder object to the completion group object, and the **TaskEntryPoint** property of the builder to the entry point of the background task that should execute on transfer completion.</span></span> <span data-ttu-id="a697a-243">Rufen Sie schließlich die [**BackgroundTaskBuilder.Register**](https://msdn.microsoft.com/library/windows/apps/br224772)-Methode auf, um die Hintergrundaufgabe zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="a697a-243">Finally, call the [**BackgroundTaskBuilder.Register**](https://msdn.microsoft.com/library/windows/apps/br224772) method to register your background task.</span></span> <span data-ttu-id="a697a-244">Beachten Sie, dass viele Abschlussgruppen einen Einstiegspunkt für die Hintergrundaufgabe gemeinsam verwenden können, Sie jedoch nur über eine Abschlussgruppe pro Registrierung einer Hintergrundaufgabe verfügen dürfen.</span><span class="sxs-lookup"><span data-stu-id="a697a-244">Note that many completion groups can share one background task entry point, but you can have only one completion group per background task registration.</span></span>

```csharp
var completionGroup = new BackgroundTransferCompletionGroup();
BackgroundTaskBuilder builder = new BackgroundTaskBuilder();

builder.Name = "MyDownloadProcessingTask";
builder.SetTrigger(completionGroup.Trigger);
builder.TaskEntryPoint = "Tasks.BackgroundDownloadProcessingTask";

BackgroundTaskRegistration downloadProcessingTask = builder.Register();
```

2.  <span data-ttu-id="a697a-245">Ordnen Sie als Nächstes die Hintergrundübertragungen mit der Abschlussgruppe zu.</span><span class="sxs-lookup"><span data-stu-id="a697a-245">Next you associate background transfers with the completion group.</span></span> <span data-ttu-id="a697a-246">Aktivieren Sie nach Erstellen aller Übertragungen die Abschlussgruppe.</span><span class="sxs-lookup"><span data-stu-id="a697a-246">Once all transfers are created, enable the completion group.</span></span>

```csharp
BackgroundDownloader downloader = new BackgroundDownloader(completionGroup);
DownloadOperation download = downloader.CreateDownload(uri, file);
Task<DownloadOperation> startTask = download.StartAsync().AsTask();

// App still sees the normal completion path
startTask.ContinueWith(ForegroundCompletionHandler);

// Do not enable the CompletionGroup until after all downloads are created.
downloader.CompletinGroup.Enable();
```

3.  <span data-ttu-id="a697a-247">Der Code in der Hintergrundaufgabe extrahiert die Liste der Vorgänge anhand der Triggerdetails und kann dann die Details für jeden Vorgang überprüfen und die entsprechende Nachbearbeitung für jeden Vorgang ausführen.</span><span class="sxs-lookup"><span data-stu-id="a697a-247">The code in the background task extracts the list of operations from the trigger details, and your code can then inspect the details for each operation and perform appropriate post-processing for each operation.</span></span>

```csharp
public class BackgroundDownloadProcessingTask : IBackgroundTask
{
    public async void Run(IBackgroundTaskInstance taskInstance)
    {
    var details = (BackgroundTransferCompletionGroupTriggerDetails)taskInstance.TriggerDetails;
    IReadOnlyList<DownloadOperation> downloads = details.Downloads;

    // Do post-processing on each finished operation in the list of downloads
    }
}
```

<span data-ttu-id="a697a-248">Die Nachbearbeitungsaufgabe stellt eine reguläre Hintergrundaufgabe dar.</span><span class="sxs-lookup"><span data-stu-id="a697a-248">The post-processing task is a regular background task.</span></span> <span data-ttu-id="a697a-249">Sie ist Teil des Pools aller Hintergrundaufgaben und unterliegt auch derselben Ressourcenverwaltungsrichtlinie wie alle anderen Hintergrundaufgaben.</span><span class="sxs-lookup"><span data-stu-id="a697a-249">It is part of the pool of all background tasks, and it is subject to the same resource management policy as all background tasks.</span></span>

<span data-ttu-id="a697a-250">Beachten Sie, dass die Nachbearbeitung nicht die Vordergrund-Abschlusshandler ersetzt.</span><span class="sxs-lookup"><span data-stu-id="a697a-250">Also, note that post-processing does not replace foreground completion handlers.</span></span> <span data-ttu-id="a697a-251">Wenn Ihre App einen Vordergrund-Abschlusshandler definiert und nach Abschluss der Dateiübertragung App ausgeführt wird, werden der Vordergrund- und Hintergrund-Abschlusshandler aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="a697a-251">If your app defines a foreground completion handler, and your app is running when the file transfer completes, then both your foreground completion handler and your background completion handler will be called.</span></span> <span data-ttu-id="a697a-252">Die Reihenfolge, in der die Vordergrund- und Hintergrundaufgaben aufgerufen werden, kann nicht garantiert werden.</span><span class="sxs-lookup"><span data-stu-id="a697a-252">The order in which foreground and background tasks are called is not guaranteed.</span></span> <span data-ttu-id="a697a-253">Wenn Sie beide Handler definieren, sollten Sie sicherstellen, dass die zwei Aufgaben ordnungsgemäß ausgeführt werden und keine Konflikte aufweisen, wenn sie gleichzeitig ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a697a-253">If you define both, you should ensure that the two tasks will work properly and not interfere with each other if they are running concurrently.</span></span>

## <a name="request-timeouts"></a><span data-ttu-id="a697a-254">Zeitüberschreitungen bei Anforderungen</span><span class="sxs-lookup"><span data-stu-id="a697a-254">Request timeouts</span></span>
<span data-ttu-id="a697a-255">Es müssen zwei primäre Szenarien zu Verbindungszeitüberschreitungen berücksichtigt werden:</span><span class="sxs-lookup"><span data-stu-id="a697a-255">There are two primary connection timeout scenarios to take into consideration:</span></span>

-   <span data-ttu-id="a697a-256">Beim Herstellen einer neuen Verbindung für die Übertragung wird die Verbindungsanforderung abgebrochen, wenn die Verbindung nicht innerhalb von fünf Minuten hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-256">When establishing a new connection for a transfer, the connection request is aborted if it is not established within five minutes.</span></span>

-   <span data-ttu-id="a697a-257">Nach dem Herstellen einer Verbindung wird eine HTTP-Anforderungsnachricht abgebrochen, auf die nicht innerhalb von zwei Minuten reagiert wurde.</span><span class="sxs-lookup"><span data-stu-id="a697a-257">After a connection has been established, an HTTP request message that has not received a response within two minutes is aborted.</span></span>

> <span data-ttu-id="a697a-258">**Hinweis:** In beiden Szenarien, vorausgesetzt, es besteht eine Internetverbindung Hintergrundübertragung wiederholt eine Anforderung bis zu drei Mal automatisch.</span><span class="sxs-lookup"><span data-stu-id="a697a-258">**Note**In either scenario, assuming there is Internet connectivity, Background Transfer will retry a request up to three times automatically.</span></span> <span data-ttu-id="a697a-259">Wenn keine Internetkonnektivität erkannt wird, warten zusätzliche Anforderungen, bis Konnektivität vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="a697a-259">In the event Internet connectivity is not detected, additional requests will wait until it is.</span></span>

## <a name="debugging-guidance"></a><span data-ttu-id="a697a-260">Debugging-Leitfaden</span><span class="sxs-lookup"><span data-stu-id="a697a-260">Debugging guidance</span></span>
<span data-ttu-id="a697a-261">Das Beenden einer Debugsitzung in Microsoft Visual Studio ist mit dem Schließen der App vergleichbar; PUT-Uploads werden angehalten und POST-Uploads werden beendet.</span><span class="sxs-lookup"><span data-stu-id="a697a-261">Stopping a debugging session in Microsoft Visual Studio is comparable to closing your app; PUT uploads are paused and POST uploads are terminated.</span></span> <span data-ttu-id="a697a-262">Auch beim Debuggen sollte die App alle beibehaltenen Uploads auflisten und dann neu starten oder abbrechen.</span><span class="sxs-lookup"><span data-stu-id="a697a-262">Even while debugging, your app should enumerate and then restart or cancel any persisted uploads.</span></span> <span data-ttu-id="a697a-263">Sie können beispielsweise aufgelistete beibehaltene Uploadvorgänge beim App-Start durch die App abbrechen lassen, wenn kein Interesse an vorherigen Operationen für diese Debugsitzung besteht.</span><span class="sxs-lookup"><span data-stu-id="a697a-263">For example, you can have your app cancel enumerated persisted upload operations at app startup if there is no interest in previous operations for that debug session.</span></span>

<span data-ttu-id="a697a-264">Während Downloads/Uploads beim App-Start in einer Debugsitzung aufgelistet werden, können Sie diese durch Ihre App abbrechen lassen, wenn kein Interesse an vorherigen Operationen für diese Debugsitzung besteht.</span><span class="sxs-lookup"><span data-stu-id="a697a-264">While enumerating downloads/uploads on app startup during a debug session, you can have your app cancel them if there is no interest in previous operations for that debug session.</span></span> <span data-ttu-id="a697a-265">Beachten Sie, dass [**GetCurrentUploadsAsync**](https://msdn.microsoft.com/library/windows/apps/hh701149) Vorgänge nicht auflisten kann, die mithilfe der vorherigen App-Bereitstellung erstellt werden, wenn Visual Studio-Projektupdates, beispielsweise Änderungen am App-Manifest, vorhanden sind und die App deinstalliert und erneut bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-265">Note that if there are Visual Studio project updates, like changes to the app manifest, and the app is uninstalled and re-deployed, [**GetCurrentUploadsAsync**](https://msdn.microsoft.com/library/windows/apps/hh701149) cannot enumerate operations created using the previous app deployment.</span></span>

<span data-ttu-id="a697a-266">Bei der Verwendung von Hintergrundübertragungen während der Entwicklung kann es vorkommen, dass die internen Caches aktiver und abgeschlossener Übertragungsvorgänge nicht mehr synchron sind. Dies kann zur Folge haben, dass keine neuen Übertragungsvorgänge gestartet werden können, oder dass keine Interaktion mit vorhandenen Vorgängen und [**BackgroundTransferGroup**](https://msdn.microsoft.com/library/windows/apps/dn279030)-Objekten mehr möglich ist.</span><span class="sxs-lookup"><span data-stu-id="a697a-266">When using Background Transfer during development, you may get into a situation where the internal caches of active and completed transfer operations can get out of sync. This may result in the inability to start new transfer operations or interact with existing operations and [**BackgroundTransferGroup**](https://msdn.microsoft.com/library/windows/apps/dn279030) objects.</span></span> <span data-ttu-id="a697a-267">In einigen Fällen wird durch den Versuch einer Interaktion mit vorhandenen Vorgängen ein Absturz ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="a697a-267">In some cases, attempting to interact with existing operations may trigger a crash.</span></span> <span data-ttu-id="a697a-268">Dies kann vorkommen, wenn die [**TransferBehavior**](https://msdn.microsoft.com/library/windows/apps/dn279033)-Eigenschaft auf **Parallel** festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="a697a-268">This result can occur if the [**TransferBehavior**](https://msdn.microsoft.com/library/windows/apps/dn279033) property is set to **Parallel**.</span></span> <span data-ttu-id="a697a-269">Dieses Problem tritt nur bei bestimmten Szenarien während der Entwicklung auf und betrifft nicht die Endbenutzer Ihrer App.</span><span class="sxs-lookup"><span data-stu-id="a697a-269">This issue occurs only in certain scenarios during development and is not applicable to end users of your app.</span></span>

<span data-ttu-id="a697a-270">Vier Szenarien mit VisualStudio können dieses Problem auslösen.</span><span class="sxs-lookup"><span data-stu-id="a697a-270">Four scenarios using Visual Studio can cause this issue.</span></span>

-   <span data-ttu-id="a697a-271">Sie erstellen ein neues Projekt mit demselben App-Namen wie ein vorhandenes Projekt, jedoch einer anderen Sprache (z.B. C# statt C++).</span><span class="sxs-lookup"><span data-stu-id="a697a-271">You create a new project with the same app name as an existing project, but a different language (from C++ to C#, for example).</span></span>
-   <span data-ttu-id="a697a-272">Sie ändern die Zielarchitektur (z.B. von x86 zu x64) in einem vorhandenen Projekt.</span><span class="sxs-lookup"><span data-stu-id="a697a-272">You change the target architecture (from x86 to x64, for example) in an existing project.</span></span>
-   <span data-ttu-id="a697a-273">Sie ändern die Kultur (z.B. von neutral zu en-US) in einem vorhandenen Projekt.</span><span class="sxs-lookup"><span data-stu-id="a697a-273">You change the culture (from neutral to en-US, for example) in an existing project.</span></span>
-   <span data-ttu-id="a697a-274">Sie fügen in einem vorhandenen Projekt eine Funktion im Paketmanifest (z.B. **Unternehmensauthentifizierung**) hinzu oder entfernen eine.</span><span class="sxs-lookup"><span data-stu-id="a697a-274">You add or remove a capability in the package manifest (adding **Enterprise Authentication**, for example) in an existing project.</span></span>

<span data-ttu-id="a697a-275">Normale App-Wartungen wie z.B. Manifestaktualisierungen, bei denen Funktionen hinzugefügt oder entfernt werden, lösen dieses Problem in den Bereitstellungen Ihrer App für Endbenutzer nicht aus.</span><span class="sxs-lookup"><span data-stu-id="a697a-275">Regular app servicing, including manifest updates which add or remove capabilities, do not trigger this issue on end user deployments of your app.</span></span>
<span data-ttu-id="a697a-276">Umgehen Sie dieses Problem, indem Sie alle Versionen der App vollständig deinstallieren und sie mit der neuen Sprache, Architektur, Kultur oder Funktion erneut bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="a697a-276">To work around this issue, completely uninstall all versions of the app and re-deploy with the new language, architecture, culture, or capability.</span></span> <span data-ttu-id="a697a-277">Dies ist auf der **Startseite** oder mithilfe von PowerShell und dem **Remove-AppxPackage**-Cmdlet möglich.</span><span class="sxs-lookup"><span data-stu-id="a697a-277">This can be done via the **Start** screen or using PowerShell and the **Remove-AppxPackage** cmdlet.</span></span>

## <a name="exceptions-in-windowsnetworkingbackgroundtransfer"></a><span data-ttu-id="a697a-278">Ausnahmen in Windows.Networking.BackgroundTransfer</span><span class="sxs-lookup"><span data-stu-id="a697a-278">Exceptions in Windows.Networking.BackgroundTransfer</span></span>
<span data-ttu-id="a697a-279">Eine Ausnahme wird ausgelöst, wenn eine ungültige Zeichenfolge für einen Uniform Resource Identifier (URI) an den Konstruktor für das [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998)-Objekt übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-279">An exception is thrown when an invalid string for a the Uniform Resource Identifier (URI) is passed to the constructor for the [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) object.</span></span>

<span data-ttu-id="a697a-280">**NET:** Der [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998)-Typ wird in C# und VB als [**System.Uri**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.aspx) angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a697a-280">**.NET:** The [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) type appears as [**System.Uri**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.aspx) in C# and VB.</span></span>

<span data-ttu-id="a697a-281">In C# und Visual Basic kann dieser Fehler vermieden werden, indem die [**System.Uri**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.aspx)-Klasse in .NET 4.5 und eine der [**System.Uri.TryCreate**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.trycreate.aspx)-Methoden zum Testen der vom App-Benutzer erhaltenen Zeichenfolge verwendet wird, bevor der URI erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="a697a-281">In C# and Visual Basic, this error can be avoided by using the [**System.Uri**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.aspx) class in the .NET 4.5 and one of the [**System.Uri.TryCreate**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.trycreate.aspx) methods to test the string received from the app user before the URI is constructed.</span></span>

<span data-ttu-id="a697a-282">In C++ gibt es keine Methode zum Analysieren einer Zeichenfolge für einen URI.</span><span class="sxs-lookup"><span data-stu-id="a697a-282">In C++, there is no method to try and parse a string to a URI.</span></span> <span data-ttu-id="a697a-283">Wenn eine App vom Benutzer eine Eingabe für das [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998)-Element erhält, sollte sich der Konstruktor innerhalb eines try/catch-Blocks befinden.</span><span class="sxs-lookup"><span data-stu-id="a697a-283">If an app gets input from the user for the [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998), the constructor should be in a try/catch block.</span></span> <span data-ttu-id="a697a-284">Wenn eine Ausnahme ausgelöst wird, kann die App den Benutzer benachrichtigen und einen neuen Hostnamen anfordern.</span><span class="sxs-lookup"><span data-stu-id="a697a-284">If an exception is thrown, the app can notify the user and request a new hostname.</span></span>

<span data-ttu-id="a697a-285">Der [**Windows.Networking.backgroundTransfer**](https://msdn.microsoft.com/library/windows/apps/br207242)-Namespace enthält praktische Hilfsmethoden und verwendet im [**Windows.Networking.Sockets**](https://msdn.microsoft.com/library/windows/apps/br226960)-Namespace Enumerationen zum Behandeln von Fehlern.</span><span class="sxs-lookup"><span data-stu-id="a697a-285">The [**Windows.Networking.backgroundTransfer**](https://msdn.microsoft.com/library/windows/apps/br207242) namespace has convenient helper methods and uses enumerations in the [**Windows.Networking.Sockets**](https://msdn.microsoft.com/library/windows/apps/br226960) namespace for handling errors.</span></span> <span data-ttu-id="a697a-286">Mit ihnen lassen sich spezifische Netzwerkausnahmen in der App unterschiedlich behandeln.</span><span class="sxs-lookup"><span data-stu-id="a697a-286">This can be useful for handling specific network exceptions differently in your app.</span></span>

<span data-ttu-id="a697a-287">Ein Fehler in einer asynchronen Methode im [**Windows.Networking.backgroundTransfer**](https://msdn.microsoft.com/library/windows/apps/br207242)-Namespace wird als ein **HRESULT**-Wert zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="a697a-287">An error encountered on an asynchronous method in the [**Windows.Networking.backgroundTransfer**](https://msdn.microsoft.com/library/windows/apps/br207242) namespace is returned as an **HRESULT** value.</span></span> <span data-ttu-id="a697a-288">Mit der [**BackgroundTransferError.GetStatus**](https://msdn.microsoft.com/library/windows/apps/hh701093)-Methode wird ein Netzwerkfehler aus einem Hintergrundübertragungsvorgang in einen [**WebErrorStatus**](https://msdn.microsoft.com/library/windows/apps/hh747818)-Enumerationswert konvertiert.</span><span class="sxs-lookup"><span data-stu-id="a697a-288">The [**BackgroundTransferError.GetStatus**](https://msdn.microsoft.com/library/windows/apps/hh701093) method is used to convert a network error from a background transfer operation to a [**WebErrorStatus**](https://msdn.microsoft.com/library/windows/apps/hh747818) enumeration value.</span></span> <span data-ttu-id="a697a-289">Die meisten **WebErrorStatus**-Enumerationswerte entsprechen einem vom systemeigenen HTTP- oder FTP-Clientvorgang zurückgegebenen Fehler.</span><span class="sxs-lookup"><span data-stu-id="a697a-289">Most of the **WebErrorStatus** enumeration values correspond to an error returned by the native HTTP or FTP client operation.</span></span> <span data-ttu-id="a697a-290">Eine App kann nach bestimmten **WebErrorStatus**-Enumerationswerten filtern, um das App-Verhalten je nach Ausnahmeursache zu ändern.</span><span class="sxs-lookup"><span data-stu-id="a697a-290">An app can filter on specific **WebErrorStatus** enumeration values to modify app behavior depending on the cause of the exception.</span></span>

<span data-ttu-id="a697a-291">Bei Parameterprüfungsfehlern kann eine App den **HRESULT**-Wert aus der Ausnahme auch verwenden, um ausführlichere Informationen zum zugehörigen Fehler zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a697a-291">For parameter validation errors, an app can also use the **HRESULT** from the exception to learn more detailed information on the error that caused the exception.</span></span> <span data-ttu-id="a697a-292">Mögliche **HRESULT**-Werte sind in der Headerdatei *Winerror.h* aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="a697a-292">Possible **HRESULT** values are listed in the *Winerror.h* header file.</span></span> <span data-ttu-id="a697a-293">Für die meisten Parameterüberprüfungsfehler wird der **HRESULT**-Wert **E\_INVALIDARG** zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="a697a-293">For most parameter validation errors, the **HRESULT** returned is **E\_INVALIDARG**.</span></span>

## <a name="important-apis"></a><span data-ttu-id="a697a-294">Wichtige APIs</span><span class="sxs-lookup"><span data-stu-id="a697a-294">Important APIs</span></span>
* [**<span data-ttu-id="a697a-295">Windows.Networking.BackgroundTransfer</span><span class="sxs-lookup"><span data-stu-id="a697a-295">Windows.Networking.BackgroundTransfer</span></span>**](/uwp/api/windows.networking.backgroundtransfer)
* [**<span data-ttu-id="a697a-296">Windows.Foundation.Uri</span><span class="sxs-lookup"><span data-stu-id="a697a-296">Windows.Foundation.Uri</span></span>**](/uwp/api/Windows.Foundation.Uri)
* [**<span data-ttu-id="a697a-297">Windows.Networking.Sockets</span><span class="sxs-lookup"><span data-stu-id="a697a-297">Windows.Networking.Sockets</span></span>**](/uwp/api/Windows.Networking.Sockets)
