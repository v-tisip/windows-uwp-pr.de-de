---
title: Übergeben von Arrays an eine Komponente für Windows-Runtime
description: Parameter in der UWP (Universal Windows-Plattform) sind entweder für die Eingabe oder für die Ausgabe, nie für beide, vorgesehen. Das bedeutet, dass der Inhalt eines Arrays, der an eine Methode übergeben wird, wie auch das Array selbst, für die Eingabe oder für die Ausgabe vorgesehen sind.
ms.assetid: 8DE695AC-CEF2-438C-8F94-FB783EE18EB9
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: 60c2e2221cd174ffd75a45d6fe8e2f66744d67a0
ms.sourcegitcommit: 49d58bc66c1c9f2a4f81473bcb25af79e2b1088d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/11/2018
ms.locfileid: "8936203"
---
# <a name="passing-arrays-to-a-windows-runtime-component"></a><span data-ttu-id="d48d1-105">Übergeben von Arrays an eine Komponente für Windows-Runtime</span><span class="sxs-lookup"><span data-stu-id="d48d1-105">Passing arrays to a Windows Runtime Component</span></span>




<span data-ttu-id="d48d1-106">Parameter in der UWP (Universal Windows-Plattform) sind entweder für die Eingabe oder für die Ausgabe, nie für beide, vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="d48d1-106">In the Windows Universal Platform (UWP), parameters are either for input or for output, never both.</span></span> <span data-ttu-id="d48d1-107">Das bedeutet, dass der Inhalt eines Arrays, der an eine Methode übergeben wird, wie auch das Array selbst, für die Eingabe oder für die Ausgabe vorgesehen sind.</span><span class="sxs-lookup"><span data-stu-id="d48d1-107">This means that the contents of an array that is passed to a method, as well as the array itself, are either for input or for output.</span></span> <span data-ttu-id="d48d1-108">Wenn der Inhalt des Arrays für die Eingabe vorgesehen ist, liest die Methode aus dem Array, aber schreibt nicht in das Array.</span><span class="sxs-lookup"><span data-stu-id="d48d1-108">If the contents of the array are for input, the method reads from the array but doesn't write to it.</span></span> <span data-ttu-id="d48d1-109">Wenn der Inhalt des Arrays für die Ausgabe vorgesehen ist, schreibt die Methode in das Array, aber liest nicht in daraus.</span><span class="sxs-lookup"><span data-stu-id="d48d1-109">If the contents of the array are for output, the method writes to the array but doesn't read from it.</span></span> <span data-ttu-id="d48d1-110">Dies stellt ein Problem für Arrayparameter dar, da Arrays im .NET Framework Verweistypen sind, und der Inhalt eines Arrays änderbar ist, auch wenn der Array-Verweis per Wert übergeben wird (**ByVal** in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="d48d1-110">This presents a problem for array parameters, because arrays in the .NET Framework are reference types, and the contents of an array are mutable even when the array reference is passed by value (**ByVal** in Visual Basic).</span></span> <span data-ttu-id="d48d1-111">Für das [Windows-Runtime-Metadatenexport-Tool (Winmdexp.exe)](https://msdn.microsoft.com/library/hh925576.aspx) müssen Sie die beabsichtigte Verwendung des Arrays angeben, falls dies nicht eindeutig aus dem Kontext ersichtlich ist. Fügen Sie dem Parameter zu diesem Zweck das Attribut „ReadOnlyArrayAttribute” oder „WriteOnlyArrayAttribute” hinzu.</span><span class="sxs-lookup"><span data-stu-id="d48d1-111">The [Windows Runtime Metadata Export Tool (Winmdexp.exe)](https://msdn.microsoft.com/library/hh925576.aspx) requires you to specify the intended usage of the array if it is not clear from context, by applying the ReadOnlyArrayAttribute attribute or the WriteOnlyArrayAttribute attribute to the parameter.</span></span> <span data-ttu-id="d48d1-112">Die Array-Nutzung wird wie folgt bestimmt:</span><span class="sxs-lookup"><span data-stu-id="d48d1-112">Array usage is determined as follows:</span></span>

-   <span data-ttu-id="d48d1-113">Für den Rückgabewert oder einen Ausgabeparameter (einen **ByRef**-Parameter mit dem [OutAttribute](https://msdn.microsoft.com/library/system.runtime.interopservices.outattribute.aspx)-Attribut in Visual Basic) ist das Array immer nur für die Ausgabe vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="d48d1-113">For the return value or for an out parameter (a **ByRef** parameter with the [OutAttribute](https://msdn.microsoft.com/library/system.runtime.interopservices.outattribute.aspx) attribute in Visual Basic) the array is always for output only.</span></span> <span data-ttu-id="d48d1-114">Geben Sie das Attribut „ReadOnlyArrayAttribute” nicht an.</span><span class="sxs-lookup"><span data-stu-id="d48d1-114">Do not apply the ReadOnlyArrayAttribute attribute.</span></span> <span data-ttu-id="d48d1-115">Das „WriteOnlyArrayAttribute”-Attribut ist für Ausgabeparameter zulässig, aber redundant.</span><span class="sxs-lookup"><span data-stu-id="d48d1-115">The WriteOnlyArrayAttribute attribute is allowed on output parameters, but it's redundant.</span></span>

    > <span data-ttu-id="d48d1-116">**Achtung**der Visual Basic-Compiler erzwingt keine Regeln nur für Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="d48d1-116">**Caution**The Visual Basic compiler does not enforce output-only rules.</span></span> <span data-ttu-id="d48d1-117">Sie sollten nie aus Ausgabeparametern lesen, sie könnten **Nothing** enthalten.</span><span class="sxs-lookup"><span data-stu-id="d48d1-117">You should never read from an output parameter; it may contain **Nothing**.</span></span> <span data-ttu-id="d48d1-118">Weisen Sie immer ein neues Array zu.</span><span class="sxs-lookup"><span data-stu-id="d48d1-118">Always assign a new array.</span></span>
 
-   <span data-ttu-id="d48d1-119">Parameter mit dem Modifizierer **ref** (**ByRef** in Visual Basic) sind nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="d48d1-119">Parameters that have the **ref** modifier (**ByRef** in Visual Basic) are not allowed.</span></span> <span data-ttu-id="d48d1-120">Winmdexp.exe erzeugt einen Fehler.</span><span class="sxs-lookup"><span data-stu-id="d48d1-120">Winmdexp.exe generates an error.</span></span>
-   <span data-ttu-id="d48d1-121">Für einen Parameter, der als Wert übergeben wird, müssen Sie angeben, ob der Arrayinhalt für die Eingabe oder die Ausgabe vorgesehen ist, indem Sie entweder das Attribut [ReadOnlyArrayAttribute](https://msdn.microsoft.com/library/system.runtime.interopservices.windowsruntime.readonlyarrayattribute.aspx) oder das Attribut [WriteOnlyArrayAttribute](https://msdn.microsoft.com/library/system.runtime.interopservices.windowsruntime.writeonlyarrayattribute.aspx) angeben.</span><span class="sxs-lookup"><span data-stu-id="d48d1-121">For a parameter that is passed by value, you must specify whether the array contents are for input or output by applying either the [ReadOnlyArrayAttribute](https://msdn.microsoft.com/library/system.runtime.interopservices.windowsruntime.readonlyarrayattribute.aspx) attribute or the [WriteOnlyArrayAttribute](https://msdn.microsoft.com/library/system.runtime.interopservices.windowsruntime.writeonlyarrayattribute.aspx) attribute.</span></span> <span data-ttu-id="d48d1-122">Die Angabe von beiden Attributen ist ein Fehler.</span><span class="sxs-lookup"><span data-stu-id="d48d1-122">Specifying both attributes is an error.</span></span>

<span data-ttu-id="d48d1-123">Wenn eine Methode ein Array für die Eingabe akzeptieren soll, ändern Sie den Arrayinhalt, und geben Sie das Array an den Aufrufer zurück; verwenden Sie einen schreibgeschützten Parameter für die Eingabe und einen lesegeschützten Parameter (oder den Rückgabewert) für die Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="d48d1-123">If a method must accept an array for input, modify the array contents, and return the array to the caller, use a read-only parameter for the input and a write-only parameter (or the return value) for the output.</span></span> <span data-ttu-id="d48d1-124">Der folgende Code zeigt eine Möglichkeit, dieses Muster zu implementieren:</span><span class="sxs-lookup"><span data-stu-id="d48d1-124">The following code shows one way to implement this pattern:</span></span>

> [!div class="tabbedCodeSnippets"]
> ```csharp
> public int[] ChangeArray([ReadOnlyArray()] int[] input)
> {
>     int[] output = input.Clone();
>     // Manipulate the copy.
>     //   ...
>     return output;
> }
> ```
> ```vb
> Public Function ChangeArray(<ReadOnlyArray> input() As Integer) As Integer()
>     Dim output() As Integer = input.Clone()
>     ' Manipulate the copy.
>     '   ...
>     Return output
> End Function
> ```

<span data-ttu-id="d48d1-125">Wir empfehlen, dass Sie sofort eine Kopie des Eingabearrays anlegen und die Kopie bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="d48d1-125">We recommend that you make a copy of the input array immediately, and manipulate the copy.</span></span> <span data-ttu-id="d48d1-126">Dadurch wird sichergestellt, dass die Methode sich identisch verhält, unabhängig davon, ob die Komponente von .NET Framework-Code aufgerufen wird oder nicht.</span><span class="sxs-lookup"><span data-stu-id="d48d1-126">This helps ensure that the method behaves the same whether or not your component is called by .NET Framework code.</span></span>

## <a name="using-components-from-managed-and-unmanaged-code"></a><span data-ttu-id="d48d1-127">Verwenden von Komponenten aus verwaltetem und nicht verwaltetem Code</span><span class="sxs-lookup"><span data-stu-id="d48d1-127">Using components from managed and unmanaged code</span></span>


<span data-ttu-id="d48d1-128">Parameter mit dem Attribut „ReadOnlyArrayAttribute” oder „WriteOnlyArrayAttribute” verhalten sich anders, je nachdem, ob der Aufrufer in systemeigenem oder verwaltetem Code geschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="d48d1-128">Parameters that have the ReadOnlyArrayAttribute attribute or the WriteOnlyArrayAttribute attribute behave differently depending on whether the caller is written in native code or managed code.</span></span> <span data-ttu-id="d48d1-129">Wenn der Aufrufer systemeigener Code (JavaScript oder Visual C++-Komponentenerweiterungen) ist, wird der Arrayinhalt wie folgt behandelt:</span><span class="sxs-lookup"><span data-stu-id="d48d1-129">If the caller is native code (JavaScript or Visual C++ component extensions), the array contents are treated as follows:</span></span>

-   <span data-ttu-id="d48d1-130">ReadOnlyArrayAttribute: Das Array wird kopiert, wenn der Aufruf die Grenze der binären Anwendungsschnittstelle (ABI) überschreitet.</span><span class="sxs-lookup"><span data-stu-id="d48d1-130">ReadOnlyArrayAttribute: The array is copied when the call crosses the application binary interface (ABI) boundary.</span></span> <span data-ttu-id="d48d1-131">Elemente werden bei Bedarf konvertiert.</span><span class="sxs-lookup"><span data-stu-id="d48d1-131">Elements are converted if necessary.</span></span> <span data-ttu-id="d48d1-132">Daher sind versehentliche Änderungen, die die Methode an einem nur für die Eingabe bestimmten Array vornimmt, nicht für den Aufrufer sichtbar.</span><span class="sxs-lookup"><span data-stu-id="d48d1-132">Therefore, any accidental changes the method makes to an input-only array are not visible to the caller.</span></span>
-   <span data-ttu-id="d48d1-133">WriteOnlyArrayAttribute: Die aufgerufene Methode kann keine Annahmen über den Inhalt des ursprünglichen Arrays treffen.</span><span class="sxs-lookup"><span data-stu-id="d48d1-133">WriteOnlyArrayAttribute: The called method can't make any assumptions about the contents of the original array.</span></span> <span data-ttu-id="d48d1-134">Zum Beispiel könnte das Array, das die Methode erhält, möglicherweise nicht initialisiert werden oder Standardwerte enthalten.</span><span class="sxs-lookup"><span data-stu-id="d48d1-134">For example, the array the method receives might not be initialized, or might contain default values.</span></span> <span data-ttu-id="d48d1-135">Von der Methode wird erwartet, die Werte aller Elemente im Array festzulegen.</span><span class="sxs-lookup"><span data-stu-id="d48d1-135">The method is expected to set the values of all the elements in the array.</span></span>

<span data-ttu-id="d48d1-136">Ist der Aufrufer in verwaltetem Code geschrieben, ist das ursprüngliche Array für die aufgerufene Methode genauso wie in einem Methodenaufruf in .NET Framework verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d48d1-136">If the caller is managed code, the original array is available to the called method, as it would be in any method call in the .NET Framework.</span></span> <span data-ttu-id="d48d1-137">Arrayinhalt ist in .NET Framework-Code änderbar, sodass alle Änderungen, die die Methode an dem Array vornimmt, für den Aufrufer sichtbar sind.</span><span class="sxs-lookup"><span data-stu-id="d48d1-137">Array contents are mutable in .NET Framework code, so any changes the method makes to the array are visible to the caller.</span></span> <span data-ttu-id="d48d1-138">Dies ist wichtig, da es Komponententests für eine Komponente für Windows-Runtime betrifft.</span><span class="sxs-lookup"><span data-stu-id="d48d1-138">This is important to remember because it affects unit tests written for a Windows Runtime Component.</span></span> <span data-ttu-id="d48d1-139">Wenn die Tests in verwaltetem Code geschrieben sind, erscheint der Inhalt eines Arrays während der Testphase als änderbar.</span><span class="sxs-lookup"><span data-stu-id="d48d1-139">If the tests are written in managed code, the contents of an array will appear to be mutable during testing.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d48d1-140">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="d48d1-140">Related topics</span></span>

* [<span data-ttu-id="d48d1-141">ReadOnlyArrayAttribute</span><span class="sxs-lookup"><span data-stu-id="d48d1-141">ReadOnlyArrayAttribute</span></span>](https://msdn.microsoft.com/library/system.runtime.interopservices.windowsruntime.readonlyarrayattribute.aspx)
* [<span data-ttu-id="d48d1-142">WriteOnlyArrayAttribute</span><span class="sxs-lookup"><span data-stu-id="d48d1-142">WriteOnlyArrayAttribute</span></span>](https://msdn.microsoft.com/library/system.runtime.interopservices.windowsruntime.writeonlyarrayattribute.aspx)
* [<span data-ttu-id="d48d1-143">Erstellen von Komponenten für Windows-Runtime in C# und Visual Basic</span><span class="sxs-lookup"><span data-stu-id="d48d1-143">Creating Windows Runtime Components in C# and Visual Basic</span></span>](creating-windows-runtime-components-in-csharp-and-visual-basic.md)
